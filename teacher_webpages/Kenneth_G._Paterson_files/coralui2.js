(function($,console){function createDefault(provider){return function(el,key,params){if(provider.message.hasOwnProperty(key)){var string=provider.message[key];(params||[]).forEach(function(p,i){string=string.replace(new RegExp("\\{"+i+"\\}","g"),p)});return string}return undefined}}var registry=function(){var providers=[];return{register:function(provider){providers.push(provider)},message:function(el,key,params){for(var i=providers.length-1;i>=0;i--){var provider=providers[i];if(!el.is(provider.selector))continue;
var message=($.isFunction(provider.message)?provider.message:createDefault(provider)).call(el,el,key,params);if(message)return message}if(console)console.warn("Message not found:",key,el[0]);return undefined}}}();$.fn.message=function(key,params){return registry.message(this.first(),key,params)};$.message=function(){return{register:function(provider){$.each(arguments,function(){registry.register(this)})}}}()})(jQuery,window.console);
(function(document,$){if(document.documentElement.classList.contains("skipCoral2Validation")||document.head.querySelector(".skipCoral2Validation"))return;var registry=function(){var submittableSelectors=["input","select","textarea","button","object","keygen","[role\x3dcheckbox]","[role\x3dradio]","[role\x3dcombobox]","[role\x3dlistbox]","[role\x3dradiogroup]","[role\x3dtree]","[role\x3dslider]","[role\x3dspinbutton]","[role\x3dtextbox]"];var submittableSelector=submittableSelectors.reverse().join(",");
var candidateSelectors=["input:not([readonly]):not([disabled]):not([type\x3dhidden]):not([type\x3dreset]):not([type\x3dbutton])","select","textarea:not([readonly])","button[type\x3dsubmit]","[role\x3dcheckbox]:not([aria-disabled\x3dtrue])","[role\x3dradio]:not([aria-disabled\x3dtrue])","[role\x3dcombobox]:not([aria-disabled\x3dtrue])","[role\x3dlistbox]:not([aria-disabled\x3dtrue])","[role\x3dradiogroup]:not([aria-disabled\x3dtrue])","[role\x3dtree]:not([aria-disabled\x3dtrue])","[role\x3dslider]:not([aria-disabled\x3dtrue])",
"[role\x3dspinbutton]:not([aria-disabled\x3dtrue])","[role\x3dtextbox]:not([aria-disabled\x3dtrue]):not([aria-readonly\x3dtrue])"];var candidateSelector=candidateSelectors.reverse().join(",");var validators=[];return{isSummittable:function(el){return el.is(submittableSelector)},submittables:function(form){return form.find(submittableSelector)},isCandidate:function(el){return el.is(candidateSelector)},api:function(el){if(this.isSummittable(el))return this.apiNoCheck(el)},apiNoCheck:function(el){return el.data("validator")||
function(el,registry){var api=createValidationAPI(el,registry);el.data("validator",api);return api}(el,this)},register:function(validator){validators.push(validator)},validators:function(){return validators}}}();function createValidationAPI(el,registry){return new HTMLValidation(el,registry)}function HTMLValidation(el,registry){this.el=el;this.registry=registry;this.message=null;this.customMessage=null;this.isValidated=false;this.state=function(outer){return{getCustomError:function(){return!!outer.customMessage},
isValid:function(){return!outer.customMessage&&!outer.message},isValidated:function(){return outer.isValidated}}}(this)}function everyReverse(array,callback,thisArg){for(var i=array.length-1;i>=0;i--)if(!callback.call(thisArg,array[i],i,array))return false;return true}function createInvalidEvent(){return $.Event("invalid",{isJqueryValidator:true})}HTMLValidation.prototype={willValidate:function(){return this.registry.isCandidate(this.el)},setCustomValidity:function(message){this.customMessage=message},
getValidity:function(){return this.state},checkValidity:function(options){options=options||{};if(!this.willValidate())return true;this.isValidated=true;if(this.customMessage){if(!options.suppressEvent)this.el.trigger(createInvalidEvent());return false}this.message=null;everyReverse(this.registry.validators(),function(v){if(!v.validate||!this.el.is(v.selector))return true;var m=v.validate(this.el);if(m){this.message=m;return false}else return true},this);if(this.message){if(!options.suppressEvent)this.el.trigger(createInvalidEvent());
return false}if(!options.suppressEvent)this.el.trigger("valid");return true},getValidationMessage:function(){if(!this.willValidate())return"";return this.customMessage||this.message||""},updateUI:function(){var f;if(this.getValidity().isValid())f=function(v){return!v.clear||!this.el.is(v.selector)||v.clear(this.el)===$.validator.CONTINUE};else f=function(v){return!v.show||!this.el.is(v.selector)||v.show(this.el,this.getValidationMessage())===$.validator.CONTINUE};everyReverse(this.registry.validators(),
f,this)}};$.extend($.expr[":"],{submittable:function(element){return registry.isSummittable($(element))}});$.fn.willValidate=function(){var api=registry.api(this.first());if(api)return api.willValidate();else return false};$.fn.validationMessage=function(){var api=registry.api(this.first());if(api)return api.getValidationMessage();else return""};$.fn.checkValidity=function(){var api=registry.api(this.first());if(api)return api.checkValidity();else return true};$.fn.setCustomValidity=function(message){return this.each(function(){var api=
registry.api($(this));if(api)api.setCustomValidity(message)})};$.fn.updateErrorUI=function(){return this.each(function(){var api=registry.api($(this));if(api)api.updateUI()})};$.validator=function(){return{CONTINUE:1,STOP:2,register:function(){$.each(arguments,function(){registry.register(this)})},isValid:function(root,suppressEvent){var allValid=true;var fields=registry.submittables(root);fields.each(function(){var el=$(this);var api=registry.apiNoCheck(el);var state=api.getValidity();var isValid;
if(state.isValidated())isValid=state.isValid();else isValid=api.checkValidity({suppressEvent:suppressEvent});if(!isValid){allValid=false;return false}});return allValid}}}();function staticallyValidate(form,registry){return registry.submittables(form).map(function(){var el=$(this);var api=registry.apiNoCheck(el);if(api.checkValidity({suppressEvent:true}))return;return this}).map(function(){var e=createInvalidEvent();$(this).trigger(e);if(!e.isDefaultPrevented())return this})}function interactivelyValidate(form,
registry){var unhandleds=staticallyValidate(form,registry);if(unhandleds.length>0){unhandleds.each(function(){var api=registry.apiNoCheck($(this));api.updateUI()});return false}return true}document.addEventListener("submit",function(e){var form=$(e.target);if(!form.is("form")||form.prop("noValidate")===true||form.prop("noValidate")===undefined&&form.attr("novalidate")!==undefined)return;if(!interactivelyValidate(form,registry)){e.stopPropagation();e.preventDefault()}},true)})(document,jQuery);
(function($){var CLASS_ACTIVE="is-active";CUI.Accordion=new Class({toString:"Accordion",extend:CUI.Widget,construct:function(options){this._parseAttributes();this._setAccordion();this._setListeners();this._makeAccessible();this._updateDOMForDisabled()},defaults:{active:false,disabled:false,iconClassCollapsed:"coral-Icon--chevronRight",iconClassExpanded:"coral-Icon--chevronDown"},isAccordion:false,_parseAttributes:function(){var iconClassCollapsed=this.$element.attr("data-icon-class-collapsed");if(iconClassCollapsed)this.options.iconClassCollapsed=
iconClassCollapsed;var iconClassExpanded=this.$element.attr("data-icon-class-expanded");if(iconClassExpanded)this.options.iconClassExpanded=iconClassExpanded},_setAccordion:function(){var $element=this.$element;this.isAccordion=!$element.hasClass("coral-Collapsible")&&$element.data("init")!=="collapsible";if(this.isAccordion){$element.addClass("coral-Accordion");var activeIndex=$element.children("."+CLASS_ACTIVE).index();if(this.options.active!==false)activeIndex=this.options.active;else this.options.active=
activeIndex;$element.children().each(function(index,element){this._initElement(element,index!=activeIndex)}.bind(this))}else{this.options.active=$element.hasClass(CLASS_ACTIVE);this._initElement($element,!this.options.active)}},_setListeners:function(){var selector=this.isAccordion?"\x3e .coral-Accordion-item \x3e .coral-Accordion-header":"\x3e .coral-Collapsible-header";this.$element.on("click",selector,this._toggle.bind(this));this.$element.on("change:active",this._changeActive.bind(this));var selectstartSelector=
this.isAccordion?".coral-Accordion-header":".coral-Collapsible-header";this.$element.on("selectstart",selectstartSelector,function(event){event.preventDefault()});this.on("change:disabled",function(event){this._updateDOMForDisabled()}.bind(this))},_updateDOMForDisabled:function(){if(this.options.disabled)this.$element.addClass("is-disabled").attr("aria-disabled",true).find("[role\x3dtab], \x3e [role\x3dbutton]").removeAttr("tabindex").attr("aria-disabled",true);else this.$element.removeClass("is-disabled").attr("aria-disabled",
false).find("[role\x3dtab], \x3e [role\x3dbutton]").each(function(index,element){var elem=$(element);elem.removeAttr("aria-disabled").attr("tabindex",elem.is("[aria-selected\x3dtrue][aria-controls], [aria-expanded][aria-controls]")?0:-1)})},_toggle:function(event){if(this.options.disabled)return;var el=$(event.target).closest(this._getCollapsibleSelector()),isCurrentlyActive=el.hasClass(CLASS_ACTIVE),active=isCurrentlyActive?false:this.isAccordion?el.index():true;this.setActive(active)},_changeActive:function(){if(this.isAccordion){this._collapse(this.$element.children("."+
CLASS_ACTIVE));if(this.options.active!==false){var activeElement=this.$element.children().eq(this.options.active);this._expand(activeElement)}}else if(this.options.active)this._expand(this.$element);else this._collapse(this.$element)},setActive:function(active){if(active!==this.options.active){this.options.active=active;this._changeActive()}},_initElement:function(element,collapse){element=$(element);if(this._getHeaderElement(element).length===0)this._prependHeaderElement(element);if(this._getHeaderIconElement(element).length===
0)this._prependHeaderIconElement(element);if(this._getContentElement(element).length===0)this._prependContentElement(element);element.addClass(this.isAccordion?"coral-Accordion-item":"coral-Collapsible");var header=this._getHeaderElement(element),content=this._getContentElement(element),icon=this._getHeaderIconElement(element);header.prependTo(element);if(collapse){element.removeClass(CLASS_ACTIVE);if(!icon.hasClass("coral-Icon"))icon.addClass("coral-Icon coral-Icon--sizeXS");icon.removeClass(this.options.iconClassExpanded).addClass(this.options.iconClassCollapsed);
content.hide()}else{element.addClass(CLASS_ACTIVE);if(!icon.hasClass("coral-Icon"))icon.addClass("coral-Icon coral-Icon--sizeXS");icon.removeClass(this.options.iconClassCollapsed).addClass(this.options.iconClassExpanded);content.show()}},_collapse:function(el){var header=this._getHeaderElement(el),content=this._getContentElement(el),icon=this._getHeaderIconElement(el);icon.removeClass(this.options.iconClassExpanded).addClass(this.options.iconClassCollapsed);content.slideUp({duration:"fast",complete:function(){el.removeClass(CLASS_ACTIVE);
el.trigger("deactivate")},progress:function(animation,progress,remainingMs){el.trigger("collapse",{animation:animation,progress:progress,remainingMs:remainingMs})}});if(this.isAccordion)header.attr({"tabindex":header.is(document.activeElement)?0:-1,"aria-selected":false});else header.attr({"aria-expanded":false});content.attr({"aria-hidden":true,"aria-expanded":false})},_expand:function(el){var header=this._getHeaderElement(el),content=this._getContentElement(el),icon=this._getHeaderIconElement(el);
el.addClass(CLASS_ACTIVE);icon.removeClass(this.options.iconClassCollapsed).addClass(this.options.iconClassExpanded);content.slideDown({duration:"fast",complete:function(){el.trigger("activate")},progress:function(animation,progress,remainingMs){el.trigger("expand",{animation:animation,progress:progress,remainingMs:remainingMs})}});if(this.isAccordion)header.attr({"tabindex":0,"aria-selected":true});else header.attr({"aria-expanded":true});content.attr({"aria-hidden":false,"aria-expanded":true}).show()},
_getCollapsibleSelector:function(){return this.isAccordion?".coral-Accordion-item":".coral-Collapsible"},_getHeaderElement:function(el){var selector=this.isAccordion?"\x3e .coral-Accordion-header":"\x3e .coral-Collapsible-header";return el.find(selector)},_getHeaderFirstElement:function(el){var selector=this.isAccordion?"\x3e .coral-Accordion-header:first":"\x3e .coral-Collapsible-header:first";return el.find(selector)},_prependHeaderElement:function(el){var className=this.isAccordion?"coral-Accordion-header":
"coral-Collapsible-header";el.prepend('\x3ch3 class\x3d"'+className+'"\x3e\x26nbsp;\x3c/h3\x3e')},_getHeaderIconElement:function(el){var selector=this.isAccordion?"\x3e .coral-Accordion-header \x3e i":"\x3e .coral-Collapsible-header \x3e i";return el.find(selector)},_prependHeaderIconElement:function(el){this._getHeaderElement(el).prepend("\x3ci\x3e\x3c/i\x3e")},_getContentElement:function(el){var selector=this.isAccordion?"\x3e .coral-Accordion-content":"\x3e .coral-Collapsible-content";return el.find(selector)},
_prependContentElement:function(el){var className=this.isAccordion?"coral-Accordion-content":"coral-Collapsible-content";el.prepend('\x3cdiv class\x3d"'+className+'"\x3e\x3c/div\x3e')},_makeAccessible:function(){var idPrefix="accordion-"+(new Date).getTime()+"-",section,header,content,isActive,panelId;if(this.isAccordion){this.$element.attr({"role":"tablist"});this.$element.children(".coral-Accordion-item").each(function(i,e){var section=$(e),header=section.find("\x3e .coral-Accordion-header:first"),
isActive=section.hasClass(CLASS_ACTIVE),panelId=idPrefix+"panel-"+i,content=header.next("div");section.attr({"role":"presentation"});header.attr({"role":"tab","id":header.attr("id")||idPrefix+"tab-"+i,"aria-controls":panelId,"aria-selected":isActive,"tabindex":isActive?0:-1});content.attr({"role":"tabpanel","id":panelId,"aria-labelledby":header.attr("id"),"aria-expanded":isActive,"aria-hidden":!isActive})})}else{idPrefix="collapsible-"+(new Date).getTime()+"-";section=this.$element;header=this._getHeaderFirstElement(section);
isActive=section.hasClass(CLASS_ACTIVE);panelId=idPrefix+"panel";content=header.next("div");header.attr({"role":"button","id":header.attr("id")||idPrefix+"heading","aria-controls":panelId,"aria-expanded":isActive,"tabindex":0});content.attr({"id":panelId,"aria-labelledby":header.attr("id"),"aria-expanded":isActive,"aria-hidden":!isActive})}this.$element.on("keydown",":focusable",this._onKeyDown.bind(this));this.$element.on("focusin.accordion",":focusable",this._onFocusIn.bind(this));this.$element.on("focusout.accordion",
".coral-Accordion-header:focusable",this._onFocusOut.bind(this));this.$element.on("touchstart.accordion, mousedown.accordion",".coral-Accordion-header:focusable",this._onMouseDown.bind(this))},_onKeyDown:function(event){var el=$(event.currentTarget).closest(this._getCollapsibleSelector()),header=this._getHeaderFirstElement(el),isHead=$(event.currentTarget).is(header),keymatch=true;switch(event.which){case 13:case 32:if(isHead)header.trigger("click");else keymatch=false;break;case 33:case 37:case 38:if(isHead&&
this.isAccordion||event.which===33&&(event.metaKey||event.ctrlKey)){if(this._getHeaderFirstElement(el.prev()).focus().length===0)this.$element.find("\x3e .coral-Accordion-item:last \x3e .coral-Accordion-header:first").focus()}else if(!isHead&&(event.metaKey||event.ctrlKey))header.focus();else keymatch=false;break;case 34:case 39:case 40:if(isHead&&this.isAccordion){if(this._getHeaderFirstElement(el.next()).focus().length===0)this.$element.find("\x3e .coral-Accordion-item:first \x3e .coral-Accordion-header:first").focus()}else if(!isHead&&
event.which===34&&(event.metaKey||event.ctrlKey))header.focus();else keymatch=false;break;case 36:if(isHead&&this.isAccordion)this.$element.find("\x3e .coral-Accordion-item:first \x3e .coral-Accordion-header:first").focus();else keymatch=false;break;case 35:if(isHead&&this.isAccordion)this.$element.find("\x3e .coral-Accordion-item:last \x3e .coral-Accordion-header:first").focus();else keymatch=false;break;default:keymatch=false;break}if(keymatch===true)event.preventDefault()},_onFocusIn:function(event){var el=
$(event.currentTarget).closest(this._getCollapsibleSelector()),header=this._getHeaderFirstElement(el),isHead=$(event.currentTarget).is(header);if(this.options.disabled)return;if(isHead){if(this.isAccordion)this.$element.find("\x3e .coral-Accordion-item \x3e .coral-Accordion-header[role\x3dtab]").attr("tabindex",-1);if(!header.data("collapsible-mousedown"))el.focus();else header.removeData("collapsible-mousedown")}header.attr("tabindex",0)},_onFocusOut:function(event){var el=$(event.currentTarget).closest(this._getCollapsibleSelector()),
header=this._getHeaderFirstElement(el),isHead=$(event.currentTarget).is(header);if(isHead)el.blur().removeData("collapsible-mousedown")},_onMouseDown:function(event){var el=$(event.currentTarget).closest(this._getCollapsibleSelector()),header=this._getHeaderFirstElement(el),isHead=$(event.currentTarget).is(header);if(isHead)header.data("collapsible-mousedown",true)}});CUI.Widget.registry.register("accordion",CUI.Accordion);$(document).on("cui-contentloaded.data-api",function(e){CUI.Accordion.init($("[data-init~\x3daccordion],[data-init~\x3dcollapsible]",
e.target))})})(window.jQuery);
(function($){CUI.Alert=new Class({toString:"Alert",extend:CUI.Widget,construct:function(options){this.$element.delegate('[data-dismiss\x3d"alert"]',"click.dismiss.alert",this.hide);this.$element.addClass("coral-Alert");this.$element.on("change:heading",this._setHeading.bind(this));this.$element.on("change:content",this._setContent.bind(this));this.$element.on("change:type",this._setType.bind(this));this.$element.on("change:closeable",this._setCloseable.bind(this));this.$element.on("change:size",this._setSize.bind(this));
for(var typeKey in this._types)if(this.$element.hasClass(this._types[typeKey]["class"])){this.options.type=typeKey;return false}for(var sizeKey in this._sizes)if(this.$element.hasClass(this._sizes[sizeKey])){this.options.size=sizeKey;return false}this._setCloseable();this._setType();this._setSize();this._setHeading();this._setContent()},defaults:{type:"error",size:"small",heading:undefined,visible:true,closeable:true},_types:{"error":{"class":"coral-Alert--error","iconClass":"coral-Icon--alert"},
"notice":{"class":"coral-Alert--notice","iconClass":"coral-Icon--alert"},"success":{"class":"coral-Alert--success","iconClass":"coral-Icon--checkCircle"},"help":{"class":"coral-Alert--help","iconClass":"coral-Icon--helpCircle"},"info":{"class":"coral-Alert--info","iconClass":"coral-Icon--infoCircle"}},_sizes:{"small":"","large":"coral-Alert--large"},_setContent:function(){if(typeof this.options.content==="string")this.$element.find("div").html(this.options.content)},_setHeading:function(){if(typeof this.options.heading===
"string")this.$element.find("strong").html(this.options.heading)},_setType:function(){if(this._isValidType(this.options.type)){var icon=this.$element.find("\x3e .coral-Icon");for(var key in this._types){this.$element.removeClass(this._types[key]["class"]);icon.removeClass(this._types[key]["iconClass"])}this.$element.addClass(this._types[this.options.type]["class"]);var iconClass=this._types[this.options.type]["iconClass"];icon.addClass(iconClass)}},_setSize:function(){if(this._isValidSize(this.options.size))if(this.options.size===
"small")this.$element.removeClass(this._sizes["large"]);else this.$element.addClass(this._sizes["large"])},_setCloseable:function(){var el=this.$element.find(".coral-Alert-closeButton");if(!el.length&&this.options.closeable)this.$element.prepend('\x3cbutton class\x3d"coral-MinimalButton coral-Alert-closeButton" title\x3d"Close" data-dismiss\x3d"alert"\x3e\x3ci class\x3d"coral-Icon coral-Icon--sizeXS coral-Icon--close coral-MinimalButton-icon"\x3e\x3c/i\x3e\x3c/button\x3e');else el[this.options.closeable?
"show":"hide"]()},_isValidType:function(value){return typeof value=="string"&&this._types.hasOwnProperty(value)},_isValidSize:function(value){return typeof value=="string"&&this._sizes.hasOwnProperty(value)},_fixType:function(value){return this._isValidType(value)?value:this.defaults.type},_fixHeading:function(value){return value===undefined?this._fixType(this.options.type).toUpperCase():value}});CUI.Widget.registry.register("alert",CUI.Alert);if(CUI.options.dataAPI)$(document).on("click.alert.data-api",
'[data-dismiss\x3d"alert"]',function(evt){$(evt.currentTarget).parent().hide();evt.preventDefault()})})(window.jQuery);
(function($){CUI.CharacterCount=new Class({toString:"CharacterCount",extend:CUI.Widget,construct:function(options){this.$input=$(this.options.related);if(this.$input.attr("maxlength"))this.options.maxlength=this.$input.attr("maxlength");this.$input.removeAttr("maxlength");this.$input.on("input",this._render.bind(this));this.$element.on("change:maxlength",this._render.bind(this));this.$element.attr("aria-live","polite");this._render()},defaults:{maxlength:null},_getLength:function(){return this.$input.is("input,textarea")?
this.$input.val().length:this.$input.text().length},_render:function(){var len=this._getLength(),exceeded=this.options.maxlength?len>this.options.maxlength:false;this.$input.toggleClass("is-invalid",exceeded);this.$element.toggleClass("is-invalid",exceeded);this.$element.text(this.options.maxlength?this.options.maxlength-len:len)}});CUI.Widget.registry.register("character-count",CUI.CharacterCount);$(document).on("cui-contentloaded.data-api",function(e){CUI.CharacterCount.init($("[data-init~\x3dcharacter-count]",
e.target))})})(window.jQuery);
(function($){function getNext($collection,current){var currentIndex=current?$collection.index(current):-1;if(currentIndex===-1||currentIndex===$collection.length-1)return $collection.eq(0);else return $collection.eq(currentIndex+1)}CUI.CycleButton=new Class({toString:"CycleButton",extend:CUI.Widget,construct:function(){this.$element.on("click",".coral-CycleButton-button",function(e){if(e._cycleButton)return;e.stopImmediatePropagation();e.preventDefault();var buttons=$(e.delegateTarget).find(".coral-CycleButton-button");
var next=getNext(buttons,this);buttons.removeClass("is-active");next.addClass("is-active").focus();var click=$.Event("click",{_cycleButton:true});next.trigger(click)})}});CUI.Widget.registry.register("cyclebutton",CUI.CycleButton);$(document).on("cui-contentloaded.data-api",function(e){CUI.CycleButton.init($("[data-init~\x3d'cyclebutton']",e.target))})})(window.jQuery);
CUI.util.HTTP={isOkStatus:function(status){try{return String(status).indexOf("2")===0}catch(e){return false}},html5UploadSupported:function(){var xhr=new XMLHttpRequest;return!!(xhr&&"upload"in xhr&&"onprogress"in xhr.upload)}};
(function($){CUI.FileUpload=new Class({toString:"FileUpload",extend:CUI.Widget,construct:function(options){this._render();this.inputElement.on("change",function(event){if(this.options.disabled)return;this._onFileSelectionChange(event)}.bind(this));this._makeAccessible()},defaults:{name:"file",placeholder:null,uploadUrl:null,uploadUrlBuilder:null,disabled:false,multiple:false,sizeLimit:null,mimeTypes:[],autoStart:false,fileNameParameter:null,useHTML5:true,dropZone:null,events:{}},inputElement:null,
$inputContainer:null,fileNameElement:null,uploadQueue:[],_render:function(){var self=this;this.$inputContainer=this.$element.find(".coral-FileUpload-trigger");this.inputElement=this.$inputContainer.find(".coral-FileUpload-input");this._readDataFromMarkup();if(!CUI.util.HTTP.html5UploadSupported())this.options.useHTML5=false;this._createMissingElements();if(this.options.events)if(typeof this.options.events==="object")for(var name in this.options.events)this._registerEventHandler(name,this.options.events[name]);
if(this.options.useHTML5)this._registerDropZone();else this.options.dropZone=null;if(!this.options.placeholder)this.options.placeholder=this.inputElement.attr("placeholder");if(this.options.autoStart)this._registerEventHandler("fileselected",function(event){event.fileUpload.uploadFile(event.item)});if(this.options.uploadUrlBuilder)this.options.uploadUrl=this.options.uploadUrlBuilder(this);if(!this.options.uploadUrl||/\$\{.+\}/.test(this.options.uploadUrl))this.options.disabled=true;this._update()},
_makeAccessible:function(){if(this.$inputContainer.is("button")){var $span=$("\x3cspan\x3e"),attributes=this.$inputContainer.prop("attributes");$.each(attributes,function(){$span.attr(this.name,this.value)});$span.insertBefore(this.$inputContainer);$span.append(this.$inputContainer.children());this.$inputContainer.remove();this.$inputContainer=$span}if(this.inputElement.attr("id")&&$('label[for\x3d"'+this.inputElement.attr("id")+'"]').length===0||this.inputElement.closest("label").text().trim().length===
0)if(this.inputElement.is("[title]:not([aria-label]):not([aria-labelledby])")){if(!this.inputElement.attr("id"))this.inputElement.attr("id",CUI.util.getNextId());var $label=$("\x3clabel\x3e"),$target=this.$element.find(".coral-FileUpload-trigger .coral-Icon");if(!$target.length)$target=this.$element.find(".coral-FileUpload-trigger input");$label.attr("for",this.inputElement.attr("id")).text(this.inputElement.attr("title"));if(this.inputElement.closest(".coral-Icon").length)$label.addClass("u-coral-screenReaderOnly");
$target.after($label)}this.inputElement.on("focusin.cui-fileupload focusout.cui-fileupload",this._toggleIsFocused.bind(this))},_toggleIsFocused:function(event){this.$inputContainer.toggleClass("is-focused",event.type==="focusin")},_registerDropZone:function(){var self=this;if(!self.options.dropZone){self.$element.addClass("coral-FileUpload--dropSupport");self.options.dropZone=self.$element}try{self.options.dropZone=$(self.options.dropZone)}catch(e){delete self.options.dropZone}if(self.options.dropZone)self.options.dropZone.on("dragenter",
function(e){if(self._isActive()){if(e.stopPropagation)e.stopPropagation();if(e.preventDefault)e.preventDefault();self.$element.trigger({type:"dropzonedragenter",originalEvent:e,fileUpload:self})}return false}).on("dragover",function(e){if(self._isActive()){self.isDragOver=true;if(e.stopPropagation)e.stopPropagation();if(e.preventDefault)e.preventDefault();self.$element.trigger({type:"dropzonedragover",originalEvent:e,fileUpload:self})}return false}).on("dragleave",function(e){if(self._isActive()){if(e.stopPropagation)e.stopPropagation();
if(e.preventDefault)e.preventDefault();self.isDragOver=false;window.setTimeout(function(){if(!self.isDragOver)self.$element.trigger({type:"dropzonedragleave",originalEvent:e,fileUpload:self})},1)}return false}).on("drop",function(e){if(self._isActive()){if(e.stopPropagation)e.stopPropagation();if(e.preventDefault)e.preventDefault();var files=e.originalEvent.dataTransfer.files;self.$element.trigger({type:"dropzonedrop",originalEvent:e,files:files,fileUpload:self});self._onFileSelectionChange(e,files)}return false})},
_registerEventHandler:function(name,handler){this.$element.on(name,handler)},_createMissingElements:function(){var self=this;var multiple=self.options.useHTML5&&self.options.multiple;if(self.inputElement.length===0){self.inputElement=$("\x3cinput/\x3e",{type:"file","class":"coral-FileUpload-input",name:self.options.name,multiple:multiple});self.$inputContainer.prepend(self.inputElement)}else self.inputElement.attr("multiple",multiple)},_readDataFromMarkup:function(){var self=this;if(this.inputElement.attr("name"))this.options.name=
this.inputElement.attr("name");if(this.inputElement.attr("placeholder"))this.options.placeholder=this.inputElement.attr("placeholder");if(this.inputElement.data("placeholder"))this.options.placeholder=this.inputElement.data("placeholder");if(this.inputElement.attr("disabled")||this.inputElement.data("disabled"))this.options.disabled=true;if(this.inputElement.attr("multiple")||this.inputElement.data("multiple"))this.options.multiple=true;if(this.inputElement.data("uploadUrl"))this.options.uploadUrl=
this.inputElement.data("uploadUrl");if(this.inputElement.data("uploadUrlBuilder"))this.options.uploadUrlBuilder=CUI.util.buildFunction(this.inputElement.data("uploadUrlBuilder"),["fileUpload"]);if(this.inputElement.data("mimeTypes"))this.options.mimeTypes=this.inputElement.data("mimeTypes");if(this.inputElement.data("sizeLimit"))this.options.sizeLimit=this.inputElement.data("sizeLimit");if(this.inputElement.data("autoStart"))this.options.autoStart=true;if(this.inputElement.data("usehtml5"))this.options.useHTML5=
this.inputElement.data("usehtml5")===true;if(this.inputElement.data("dropzone"))this.options.dropZone=this.inputElement.data("dropzone");if(this.inputElement.data("fileNameParameter"))this.options.fileNameParameter=this.inputElement.data("fileNameParameter");var inputElementHTML=this.inputElement.length?this.inputElement.get(0):undefined;if(inputElementHTML)$.each(inputElementHTML.attributes,function(i,attribute){var match=/^data-event-(.*)$/.exec(attribute.name);if(match&&match.length>1){var eventHandler=
CUI.util.buildFunction(attribute.value,["event"]);if(eventHandler)self.options.events[match[1]]=eventHandler.bind(self)}})},_update:function(){if(this.options.placeholder)this.inputElement.attr("placeholder",this.options.placeholder);if(this.options.disabled){this.$element.addClass("is-disabled");this.$inputContainer.addClass("is-disabled");this.inputElement.attr("disabled","disabled")}else{this.$element.removeClass("is-disabled");this.$inputContainer.removeClass("is-disabled");this.inputElement.removeAttr("disabled")}},
_onFileSelectionChange:function(event,files){var addedCount=0,rejectedCount=0;if(this.options.useHTML5){files=files||event.target.files;for(var i=0;i<files.length;i++)if(this._addFile(files[i]))addedCount++;else rejectedCount++}else if(this._addFile(event.target))addedCount++;else rejectedCount++;this.$element.trigger({type:"filelistprocessed",addedCount:addedCount,rejectedCount:rejectedCount,fileUpload:this})},_addFile:function(file){var self=this;var fileName,fileMimeType;if(this.options.useHTML5){fileName=
file.name;fileMimeType=file.type}else fileName=$(file).attr("value")||file.value;fileMimeType=fileMimeType||CUI.FileUpload.MimeTypes.getMimeTypeFromFileName(fileName);if(fileName.lastIndexOf("\\")!==-1)fileName=fileName.substring(fileName.lastIndexOf("\\")+1);if(self.options.fileNameParameter&&!this.options.autoStart){if(!self.fileNameElement){self.fileNameElement=$('input[name\x3d"'+self.options.fileNameParameter+'"]');if(self.fileNameElement.length===0){self.fileNameElement=$("\x3cinput/\x3e",{type:"hidden",
name:self.options.fileNameParameter});self.fileNameElement.appendTo(self.$element)}}self.fileNameElement.val(fileName)}if(!self._getQueueItemByFileName(fileName)){var item={fileName:fileName};if(this.options.useHTML5){item.file=file;item.fileSize=file.size;if(self.options.sizeLimit&&file.size>self.options.sizeLimit){self.$element.trigger({type:"filerejected",item:item,message:"File is too big",fileUpload:self});return false}}if(!self._checkMimeTypes(fileMimeType)){self.$element.trigger({type:"filerejected",
item:item,message:"File mime type is not allowed",fileUpload:self});return false}self.uploadQueue.push(item);self.$element.trigger({type:"queuechanged",item:item,operation:"ADD",queueLength:self.uploadQueue.length,fileUpload:self});self.$element.trigger({type:"fileselected",item:item,fileUpload:self});return true}return false},_checkMimeTypes:function(fileMimeType){function isMimeTypeAllowed(fileMimeType,allowedMimeType){var mimeTypeRegEx=/(.+)\/(.+)$/,fileExtensionRegEx=/\.(.+)$/,shortcutRegEx=/.*/,
isAllowed=false;if(allowedMimeType==="*"||allowedMimeType===".*"||allowedMimeType==="*/*")isAllowed=true;else if(!fileMimeType||!fileMimeType.match(mimeTypeRegEx))isAllowed=false;else if(allowedMimeType.match(mimeTypeRegEx))isAllowed=fileMimeType===allowedMimeType;else if(allowedMimeType.match(fileExtensionRegEx))isAllowed=fileMimeType===CUI.FileUpload.MimeTypes[allowedMimeType];else if(allowedMimeType.match(shortcutRegEx))isAllowed=fileMimeType.split("/")[0]===allowedMimeType;return isAllowed}var length=
this.options.mimeTypes.length,i;if(length===0)return true;else{for(i=0;i<length;i+=1)if(isMimeTypeAllowed(fileMimeType,this.options.mimeTypes[i]))return true;return false}},_getQueueIndex:function(fileName){var index=-1;$.each(this.uploadQueue,function(i,item){if(item.fileName===fileName){index=i;return false}});return index},_getQueueItem:function(index){return index>-1?this.uploadQueue[index]:null},_getQueueItemByFileName:function(fileName){return this._getQueueItem(this._getQueueIndex(fileName))},
uploadFile:function(item){var self=this;if(self.options.useHTML5){item.xhr=new XMLHttpRequest;item.xhr.addEventListener("loadstart",function(e){self._onUploadStart(e,item)},false);item.xhr.addEventListener("load",function(e){self._onUploadLoad(e,item)},false);item.xhr.addEventListener("error",function(e){self._onUploadError(e,item)},false);item.xhr.addEventListener("abort",function(e){self._onUploadCanceled(e,item)},false);var upload=item.xhr.upload;upload.addEventListener("progress",function(e){self._onUploadProgress(e,
item)},false);var file=item.file;var fileName=item.fileName;if(window.FormData){var f=new FormData;if(self.options.fileNameParameter){f.append(self.inputElement.attr("name"),file);f.append(self.options.fileNameParameter||"fileName",fileName)}else f.append(fileName,file);f.append("_charset_","utf-8");if(item["parameters"]!==null&&item["parameters"]!==undefined)item.parameters.forEach(function(additionalParam){f.append(additionalParam.name,additionalParam.value)});item.xhr.open("POST",self.options.uploadUrl+
"?:ck\x3d"+(new Date).getTime(),true);item.xhr.send(f)}else{item.xhr.open("PUT",self.options.uploadUrl+"/"+fileName,true);item.xhr.send(file)}}else{var $body=$(document.body);var iframeName="upload-"+(new Date).getTime();var $iframe=$("\x3ciframe/\x3e",{name:iframeName,"class":"coral-FileUpload-iframe"}).appendTo($body);var $form=$("\x3cform/\x3e",{method:"post",enctype:"multipart/form-data",action:self.options.uploadUrl,target:iframeName,"class":"coral-FileUpload-form"}).appendTo($body);var $charset=
$("\x3cinput/\x3e",{type:"hidden",name:"_charset_",value:"utf-8"});$form.prepend($charset);if(item["parameters"]!==null&&item["parameters"]!==undefined)item.parameters.forEach(function(additionalParam){var $param=$("\x3cinput/\x3e",{type:"hidden",name:additionalParam.name,value:additionalParam.value});$form.prepend($param)});if(this.options.fileNameParameter){this.fileNameElement=$("\x3cinput/\x3e",{type:"hidden",name:this.options.fileNameParameter,value:item.fileName});$form.prepend(this.fileNameElement)}$iframe.one("load",
function(){var content=this.contentWindow.document.body.innerHTML;self.inputElement.appendTo(self.$inputContainer);$form.remove();$iframe.remove();self.$element.trigger({type:"fileuploadload",item:item,content:content,fileUpload:self})});self.inputElement.prependTo($form);$form.submit()}},cancelUpload:function(item){item.xhr.abort()},_onUploadStart:function(e,item){this.$element.trigger({type:"fileuploadstart",item:item,originalEvent:e,fileUpload:this})},_onUploadProgress:function(e,item){this.$element.trigger({type:"fileuploadprogress",
item:item,originalEvent:e,fileUpload:this})},_onUploadLoad:function(e,item){var request=e.target;if(request.readyState===4)this._internalOnUploadLoad(e,item,request.status,request.responseText)},_internalOnUploadLoad:function(e,item,requestStatus,responseText){if(CUI.util.HTTP.isOkStatus(requestStatus))this.$element.trigger({type:"fileuploadsuccess",item:item,originalEvent:e,fileUpload:this});else this.$element.trigger({type:"fileuploaderror",item:item,originalEvent:e,message:responseText,fileUpload:this});
if(this.fileNameElement)this.fileNameElement.remove();this.uploadQueue.splice(this._getQueueIndex(item.fileName),1);this.$element.trigger({type:"queuechanged",item:item,operation:"REMOVE",queueLength:this.uploadQueue.length,fileUpload:this})},_onUploadError:function(e,item){this.$element.trigger({type:"fileuploaderror",item:item,originalEvent:e,fileUpload:this})},_onUploadCanceled:function(e,item){this.$element.trigger({type:"fileuploadcanceled",item:item,originalEvent:e,fileUpload:this})},_isActive:function(){return!this.inputElement.is(":disabled")}});
CUI.Widget.registry.register("fileupload",CUI.FileUpload);if(CUI.options.dataAPI)$(document).on("cui-contentloaded.data-api",function(e){CUI.FileUpload.init($("[data-init~\x3d'fileupload']",e.target))})})(window.jQuery);
(function($){CUI.FileUpload.MimeTypes={".123":"application/vnd.lotus-1-2-3",".3dml":"text/vnd.in3d.3dml",".3g2":"video/3gpp2",".3gp":"video/3gpp",".a":"application/octet-stream",".aab":"application/x-authorware-bin",".aac":"audio/x-aac",".aam":"application/x-authorware-map",".aas":"application/x-authorware-seg",".abw":"application/x-abiword",".acc":"application/vnd.americandynamics.acc",".ace":"application/x-ace-compressed",".acu":"application/vnd.acucobol",".acutc":"application/vnd.acucorp",".adp":"audio/adpcm",
".aep":"application/vnd.audiograph",".afm":"application/x-font-type1",".afp":"application/vnd.ibm.modcap",".ai":"application/postscript",".aif":"audio/x-aiff",".aifc":"audio/x-aiff",".aiff":"audio/x-aiff",".air":"application/vnd.adobe.air-application-installer-package+zip",".ami":"application/vnd.amiga.ami",".apk":"application/vnd.android.package-archive",".application":"application/x-ms-application",".apr":"application/vnd.lotus-approach",".asc":"application/pgp-signature",".asf":"video/x-ms-asf",
".asm":"text/x-asm",".aso":"application/vnd.accpac.simply.aso",".asx":"video/x-ms-asf",".atc":"application/vnd.acucorp",".atom":"application/atom+xml",".atomcat":"application/atomcat+xml",".atomsvc":"application/atomsvc+xml",".atx":"application/vnd.antix.game-component",".au":"audio/basic",".avi":"video/x-msvideo",".aw":"application/applixware",".azf":"application/vnd.airzip.filesecure.azf",".azs":"application/vnd.airzip.filesecure.azs",".azw":"application/vnd.amazon.ebook",".bat":"application/x-msdownload",
".bcpio":"application/x-bcpio",".bdf":"application/x-font-bdf",".bdm":"application/vnd.syncml.dm+wbxml",".bh2":"application/vnd.fujitsu.oasysprs",".bin":"application/octet-stream",".bmi":"application/vnd.bmi",".bmp":"image/bmp",".book":"application/vnd.framemaker",".box":"application/vnd.previewsystems.box",".boz":"application/x-bzip2",".bpk":"application/octet-stream",".btif":"image/prs.btif",".bz":"application/x-bzip",".bz2":"application/x-bzip2",".c":"text/x-c",".c4d":"application/vnd.clonk.c4group",
".c4f":"application/vnd.clonk.c4group",".c4g":"application/vnd.clonk.c4group",".c4p":"application/vnd.clonk.c4group",".c4u":"application/vnd.clonk.c4group",".cab":"application/vnd.ms-cab-compressed",".car":"application/vnd.curl.car",".cat":"application/vnd.ms-pki.seccat",".cc":"text/x-c",".cct":"application/x-director",".ccxml":"application/ccxml+xml",".cdbcmsg":"application/vnd.contact.cmsg",".cdf":"application/x-netcdf",".cdkey":"application/vnd.mediastation.cdkey",".cdx":"chemical/x-cdx",".cdxml":"application/vnd.chemdraw+xml",
".cdy":"application/vnd.cinderella",".cer":"application/pkix-cert",".cgm":"image/cgm",".chat":"application/x-chat",".chm":"application/vnd.ms-htmlhelp",".chrt":"application/vnd.kde.kchart",".cif":"chemical/x-cif",".cii":"application/vnd.anser-web-certificate-issue-initiation",".cil":"application/vnd.ms-artgalry",".cla":"application/vnd.claymore",".class":"application/java-vm",".clkk":"application/vnd.crick.clicker.keyboard",".clkp":"application/vnd.crick.clicker.palette",".clkt":"application/vnd.crick.clicker.template",
".clkw":"application/vnd.crick.clicker.wordbank",".clkx":"application/vnd.crick.clicker",".clp":"application/x-msclip",".cmc":"application/vnd.cosmocaller",".cmdf":"chemical/x-cmdf",".cml":"chemical/x-cml",".cmp":"application/vnd.yellowriver-custom-menu",".cmx":"image/x-cmx",".cod":"application/vnd.rim.cod",".com":"application/x-msdownload",".conf":"text/plain",".cpio":"application/x-cpio",".cpp":"text/x-c",".cpt":"application/mac-compactpro",".crd":"application/x-mscardfile",".crl":"application/pkix-crl",
".crt":"application/x-x509-ca-cert",".csh":"application/x-csh",".csml":"chemical/x-csml",".csp":"application/vnd.commonspace",".css":"text/css",".cst":"application/x-director",".csv":"text/csv",".cu":"application/cu-seeme",".curl":"text/vnd.curl",".cww":"application/prs.cww",".cxt":"application/x-director",".cxx":"text/x-c",".daf":"application/vnd.mobius.daf",".dataless":"application/vnd.fdsn.seed",".davmount":"application/davmount+xml",".dcr":"application/x-director",".dcurl":"text/vnd.curl.dcurl",
".dd2":"application/vnd.oma.dd2+xml",".ddd":"application/vnd.fujixerox.ddd",".deb":"application/x-debian-package",".def":"text/plain",".deploy":"application/octet-stream",".der":"application/x-x509-ca-cert",".dfac":"application/vnd.dreamfactory",".dic":"text/x-c",".diff":"text/plain",".dir":"application/x-director",".dis":"application/vnd.mobius.dis",".dist":"application/octet-stream",".distz":"application/octet-stream",".djv":"image/vnd.djvu",".djvu":"image/vnd.djvu",".dll":"application/x-msdownload",
".dmg":"application/octet-stream",".dms":"application/octet-stream",".dna":"application/vnd.dna",".doc":"application/msword",".docm":"application/vnd.ms-word.document.macroenabled.12",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".dot":"application/msword",".dotm":"application/vnd.ms-word.template.macroenabled.12",".dotx":"application/vnd.openxmlformats-officedocument.wordprocessingml.template",".dp":"application/vnd.osgi.dp",".dpg":"application/vnd.dpgraph",".dsc":"text/prs.lines.tag",
".dtb":"application/x-dtbook+xml",".dtd":"application/xml-dtd",".dts":"audio/vnd.dts",".dtshd":"audio/vnd.dts.hd",".dump":"application/octet-stream",".dvi":"application/x-dvi",".dwf":"model/vnd.dwf",".dwg":"image/vnd.dwg",".dxf":"image/vnd.dxf",".dxp":"application/vnd.spotfire.dxp",".dxr":"application/x-director",".ecelp4800":"audio/vnd.nuera.ecelp4800",".ecelp7470":"audio/vnd.nuera.ecelp7470",".ecelp9600":"audio/vnd.nuera.ecelp9600",".ecma":"application/ecmascript",".edm":"application/vnd.novadigm.edm",
".edx":"application/vnd.novadigm.edx",".efif":"application/vnd.picsel",".ei6":"application/vnd.pg.osasli",".elc":"application/octet-stream",".eml":"message/rfc822",".emma":"application/emma+xml",".eol":"audio/vnd.digital-winds",".eot":"application/vnd.ms-fontobject",".eps":"application/postscript",".epub":"application/epub+zip",".es3":"application/vnd.eszigno3+xml",".esf":"application/vnd.epson.esf",".et3":"application/vnd.eszigno3+xml",".etx":"text/x-setext",".exe":"application/x-msdownload",".ext":"application/vnd.novadigm.ext",
".ez":"application/andrew-inset",".ez2":"application/vnd.ezpix-album",".ez3":"application/vnd.ezpix-package",".f":"text/x-fortran",".f4v":"video/x-f4v",".f77":"text/x-fortran",".f90":"text/x-fortran",".fbs":"image/vnd.fastbidsheet",".fdf":"application/vnd.fdf",".fe_launch":"application/vnd.denovo.fcselayout-link",".fg5":"application/vnd.fujitsu.oasysgp",".fgd":"application/x-director",".fh":"image/x-freehand",".fh4":"image/x-freehand",".fh5":"image/x-freehand",".fh7":"image/x-freehand",".fhc":"image/x-freehand",
".fig":"application/x-xfig",".fli":"video/x-fli",".flo":"application/vnd.micrografx.flo",".flv":"video/x-flv",".flw":"application/vnd.kde.kivio",".flx":"text/vnd.fmi.flexstor",".fly":"text/vnd.fly",".fm":"application/vnd.framemaker",".fnc":"application/vnd.frogans.fnc",".for":"text/x-fortran",".fpx":"image/vnd.fpx",".frame":"application/vnd.framemaker",".fsc":"application/vnd.fsc.weblaunch",".fst":"image/vnd.fst",".ftc":"application/vnd.fluxtime.clip",".fti":"application/vnd.anser-web-funds-transfer-initiation",
".fvt":"video/vnd.fvt",".fzs":"application/vnd.fuzzysheet",".g3":"image/g3fax",".gac":"application/vnd.groove-account",".gdl":"model/vnd.gdl",".geo":"application/vnd.dynageo",".gex":"application/vnd.geometry-explorer",".ggb":"application/vnd.geogebra.file",".ggt":"application/vnd.geogebra.tool",".ghf":"application/vnd.groove-help",".gif":"image/gif",".gim":"application/vnd.groove-identity-message",".gmx":"application/vnd.gmx",".gnumeric":"application/x-gnumeric",".gph":"application/vnd.flographit",
".gqf":"application/vnd.grafeq",".gqs":"application/vnd.grafeq",".gram":"application/srgs",".gre":"application/vnd.geometry-explorer",".grv":"application/vnd.groove-injector",".grxml":"application/srgs+xml",".gsf":"application/x-font-ghostscript",".gtar":"application/x-gtar",".gtm":"application/vnd.groove-tool-message",".gtw":"model/vnd.gtw",".gv":"text/vnd.graphviz",".gz":"application/x-gzip",".h":"text/x-c",".h261":"video/h261",".h263":"video/h263",".h264":"video/h264",".hbci":"application/vnd.hbci",
".hdf":"application/x-hdf",".hh":"text/x-c",".hlp":"application/winhlp",".hpgl":"application/vnd.hp-hpgl",".hpid":"application/vnd.hp-hpid",".hps":"application/vnd.hp-hps",".hqx":"application/mac-binhex40",".htke":"application/vnd.kenameaapp",".htm":"text/html",".html":"text/html",".hvd":"application/vnd.yamaha.hv-dic",".hvp":"application/vnd.yamaha.hv-voice",".hvs":"application/vnd.yamaha.hv-script",".icc":"application/vnd.iccprofile",".ice":"x-conference/x-cooltalk",".icm":"application/vnd.iccprofile",
".ico":"image/x-icon",".ics":"text/calendar",".ief":"image/ief",".ifb":"text/calendar",".ifm":"application/vnd.shana.informed.formdata",".iges":"model/iges",".igl":"application/vnd.igloader",".igs":"model/iges",".igx":"application/vnd.micrografx.igx",".iif":"application/vnd.shana.informed.interchange",".imp":"application/vnd.accpac.simply.imp",".ims":"application/vnd.ms-ims",".in":"text/plain",".ipk":"application/vnd.shana.informed.package",".irm":"application/vnd.ibm.rights-management",".irp":"application/vnd.irepository.package+xml",
".iso":"application/octet-stream",".itp":"application/vnd.shana.informed.formtemplate",".ivp":"application/vnd.immervision-ivp",".ivu":"application/vnd.immervision-ivu",".jad":"text/vnd.sun.j2me.app-descriptor",".jam":"application/vnd.jam",".jar":"application/java-archive",".java":"text/x-java-source",".jisp":"application/vnd.jisp",".jlt":"application/vnd.hp-jlyt",".jnlp":"application/x-java-jnlp-file",".joda":"application/vnd.joost.joda-archive",".jpe":"image/jpeg",".jpeg":"image/jpeg",".jpg":"image/jpeg",
".jpgm":"video/jpm",".jpgv":"video/jpeg",".jpm":"video/jpm",".js":"application/javascript",".json":"application/json",".kar":"audio/midi",".karbon":"application/vnd.kde.karbon",".kfo":"application/vnd.kde.kformula",".kia":"application/vnd.kidspiration",".kil":"application/x-killustrator",".kml":"application/vnd.google-earth.kml+xml",".kmz":"application/vnd.google-earth.kmz",".kne":"application/vnd.kinar",".knp":"application/vnd.kinar",".kon":"application/vnd.kde.kontour",".kpr":"application/vnd.kde.kpresenter",
".kpt":"application/vnd.kde.kpresenter",".ksh":"text/plain",".ksp":"application/vnd.kde.kspread",".ktr":"application/vnd.kahootz",".ktz":"application/vnd.kahootz",".kwd":"application/vnd.kde.kword",".kwt":"application/vnd.kde.kword",".latex":"application/x-latex",".lbd":"application/vnd.llamagraphics.life-balance.desktop",".lbe":"application/vnd.llamagraphics.life-balance.exchange+xml",".les":"application/vnd.hhe.lesson-player",".lha":"application/octet-stream",".link66":"application/vnd.route66.link66+xml",
".list":"text/plain",".list3820":"application/vnd.ibm.modcap",".listafp":"application/vnd.ibm.modcap",".log":"text/plain",".lostxml":"application/lost+xml",".lrf":"application/octet-stream",".lrm":"application/vnd.ms-lrm",".ltf":"application/vnd.frogans.ltf",".lvp":"audio/vnd.lucent.voice",".lwp":"application/vnd.lotus-wordpro",".lzh":"application/octet-stream",".m13":"application/x-msmediaview",".m14":"application/x-msmediaview",".m1v":"video/mpeg",".m2a":"audio/mpeg",".m2v":"video/mpeg",".m3a":"audio/mpeg",
".m3u":"audio/x-mpegurl",".m4u":"video/vnd.mpegurl",".m4v":"video/x-m4v",".ma":"application/mathematica",".mag":"application/vnd.ecowin.chart",".maker":"application/vnd.framemaker",".man":"text/troff",".mathml":"application/mathml+xml",".mb":"application/mathematica",".mbk":"application/vnd.mobius.mbk",".mbox":"application/mbox",".mc1":"application/vnd.medcalcdata",".mcd":"application/vnd.mcd",".mcurl":"text/vnd.curl.mcurl",".mdb":"application/x-msaccess",".mdi":"image/vnd.ms-modi",".me":"text/troff",
".mesh":"model/mesh",".mfm":"application/vnd.mfmp",".mgz":"application/vnd.proteus.magazine",".mht":"message/rfc822",".mhtml":"message/rfc822",".mid":"audio/midi",".midi":"audio/midi",".mif":"application/vnd.mif",".mime":"message/rfc822",".mj2":"video/mj2",".mjp2":"video/mj2",".mlp":"application/vnd.dolby.mlp",".mmd":"application/vnd.chipnuts.karaoke-mmd",".mmf":"application/vnd.smaf",".mmr":"image/vnd.fujixerox.edmics-mmr",".mny":"application/x-msmoney",".mobi":"application/x-mobipocket-ebook",".mov":"video/quicktime",
".movie":"video/x-sgi-movie",".mp2":"audio/mpeg",".mp2a":"audio/mpeg",".mp3":"audio/mpeg",".mp4":"video/mp4",".mp4a":"audio/mp4",".mp4s":"application/mp4",".mp4v":"video/mp4",".mpa":"video/mpeg",".mpc":"application/vnd.mophun.certificate",".mpe":"video/mpeg",".mpeg":"video/mpeg",".mpg":"video/mpeg",".mpg4":"video/mp4",".mpga":"audio/mpeg",".mpkg":"application/vnd.apple.installer+xml",".mpm":"application/vnd.blueice.multipass",".mpn":"application/vnd.mophun.application",".mpp":"application/vnd.ms-project",
".mpt":"application/vnd.ms-project",".mpy":"application/vnd.ibm.minipay",".mqy":"application/vnd.mobius.mqy",".mrc":"application/marc",".ms":"text/troff",".mscml":"application/mediaservercontrol+xml",".mseed":"application/vnd.fdsn.mseed",".mseq":"application/vnd.mseq",".msf":"application/vnd.epson.msf",".msh":"model/mesh",".msi":"application/x-msdownload",".msl":"application/vnd.mobius.msl",".msty":"application/vnd.muvee.style",".mts":"model/vnd.mts",".mus":"application/vnd.musician",".musicxml":"application/vnd.recordare.musicxml+xml",
".mvb":"application/x-msmediaview",".mwf":"application/vnd.mfer",".mxf":"application/mxf",".mxl":"application/vnd.recordare.musicxml",".mxml":"application/xv+xml",".mxs":"application/vnd.triscape.mxs",".mxu":"video/vnd.mpegurl",".n-gage":"application/vnd.nokia.n-gage.symbian.install",".nb":"application/mathematica",".nc":"application/x-netcdf",".ncx":"application/x-dtbncx+xml",".ngdat":"application/vnd.nokia.n-gage.data",".nlu":"application/vnd.neurolanguage.nlu",".nml":"application/vnd.enliven",
".nnd":"application/vnd.noblenet-directory",".nns":"application/vnd.noblenet-sealer",".nnw":"application/vnd.noblenet-web",".npx":"image/vnd.net-fpx",".nsf":"application/vnd.lotus-notes",".nws":"message/rfc822",".o":"application/octet-stream",".oa2":"application/vnd.fujitsu.oasys2",".oa3":"application/vnd.fujitsu.oasys3",".oas":"application/vnd.fujitsu.oasys",".obd":"application/x-msbinder",".obj":"application/octet-stream",".oda":"application/oda",".odb":"application/vnd.oasis.opendocument.database",
".odc":"application/vnd.oasis.opendocument.chart",".odf":"application/vnd.oasis.opendocument.formula",".odft":"application/vnd.oasis.opendocument.formula-template",".odg":"application/vnd.oasis.opendocument.graphics",".odi":"application/vnd.oasis.opendocument.image",".odp":"application/vnd.oasis.opendocument.presentation",".ods":"application/vnd.oasis.opendocument.spreadsheet",".odt":"application/vnd.oasis.opendocument.text",".oga":"audio/ogg",".ogg":"audio/ogg",".ogv":"video/ogg",".ogx":"application/ogg",
".onepkg":"application/onenote",".onetmp":"application/onenote",".onetoc":"application/onenote",".onetoc2":"application/onenote",".opf":"application/oebps-package+xml",".oprc":"application/vnd.palm",".org":"application/vnd.lotus-organizer",".osf":"application/vnd.yamaha.openscoreformat",".osfpvg":"application/vnd.yamaha.openscoreformat.osfpvg+xml",".otc":"application/vnd.oasis.opendocument.chart-template",".otf":"application/x-font-otf",".otg":"application/vnd.oasis.opendocument.graphics-template",
".oth":"application/vnd.oasis.opendocument.text-web",".oti":"application/vnd.oasis.opendocument.image-template",".otm":"application/vnd.oasis.opendocument.text-master",".otp":"application/vnd.oasis.opendocument.presentation-template",".ots":"application/vnd.oasis.opendocument.spreadsheet-template",".ott":"application/vnd.oasis.opendocument.text-template",".oxt":"application/vnd.openofficeorg.extension",".p":"text/x-pascal",".p10":"application/pkcs10",".p12":"application/x-pkcs12",".p7b":"application/x-pkcs7-certificates",
".p7c":"application/pkcs7-mime",".p7m":"application/pkcs7-mime",".p7r":"application/x-pkcs7-certreqresp",".p7s":"application/pkcs7-signature",".pas":"text/x-pascal",".pbd":"application/vnd.powerbuilder6",".pbm":"image/x-portable-bitmap",".pcf":"application/x-font-pcf",".pcl":"application/vnd.hp-pcl",".pclxl":"application/vnd.hp-pclxl",".pct":"image/x-pict",".pcurl":"application/vnd.curl.pcurl",".pcx":"image/x-pcx",".pdb":"application/vnd.palm",".pdf":"application/pdf",".pfa":"application/x-font-type1",
".pfb":"application/x-font-type1",".pfm":"application/x-font-type1",".pfr":"application/font-tdpfr",".pfx":"application/x-pkcs12",".pgm":"image/x-portable-graymap",".pgn":"application/x-chess-pgn",".pgp":"application/pgp-encrypted",".pic":"image/x-pict",".pkg":"application/octet-stream",".pki":"application/pkixcmp",".pkipath":"application/pkix-pkipath",".pl":"text/plain",".plb":"application/vnd.3gpp.pic-bw-large",".plc":"application/vnd.mobius.plc",".plf":"application/vnd.pocketlearn",".pls":"application/pls+xml",
".pml":"application/vnd.ctc-posml",".png":"image/png",".pnm":"image/x-portable-anymap",".portpkg":"application/vnd.macports.portpkg",".pot":"application/vnd.ms-powerpoint",".potm":"application/vnd.ms-powerpoint.template.macroenabled.12",".potx":"application/vnd.openxmlformats-officedocument.presentationml.template",".ppa":"application/vnd.ms-powerpoint",".ppam":"application/vnd.ms-powerpoint.addin.macroenabled.12",".ppd":"application/vnd.cups-ppd",".ppm":"image/x-portable-pixmap",".pps":"application/vnd.ms-powerpoint",
".ppsm":"application/vnd.ms-powerpoint.slideshow.macroenabled.12",".ppsx":"application/vnd.openxmlformats-officedocument.presentationml.slideshow",".ppt":"application/vnd.ms-powerpoint",".pptm":"application/vnd.ms-powerpoint.presentation.macroenabled.12",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".pqa":"application/vnd.palm",".prc":"application/x-mobipocket-ebook",".pre":"application/vnd.lotus-freelance",".prf":"application/pics-rules",".ps":"application/postscript",
".psb":"application/vnd.3gpp.pic-bw-small",".psd":"image/vnd.adobe.photoshop",".psf":"application/x-font-linux-psf",".ptid":"application/vnd.pvi.ptid1",".pub":"application/x-mspublisher",".pvb":"application/vnd.3gpp.pic-bw-var",".pwn":"application/vnd.3m.post-it-notes",".pwz":"application/vnd.ms-powerpoint",".py":"text/x-python",".pya":"audio/vnd.ms-playready.media.pya",".pyc":"application/x-python-code",".pyo":"application/x-python-code",".pyv":"video/vnd.ms-playready.media.pyv",".qam":"application/vnd.epson.quickanime",
".qbo":"application/vnd.intu.qbo",".qfx":"application/vnd.intu.qfx",".qps":"application/vnd.publishare-delta-tree",".qt":"video/quicktime",".qwd":"application/vnd.quark.quarkxpress",".qwt":"application/vnd.quark.quarkxpress",".qxb":"application/vnd.quark.quarkxpress",".qxd":"application/vnd.quark.quarkxpress",".qxl":"application/vnd.quark.quarkxpress",".qxt":"application/vnd.quark.quarkxpress",".ra":"audio/x-pn-realaudio",".ram":"audio/x-pn-realaudio",".rar":"application/x-rar-compressed",".ras":"image/x-cmu-raster",
".rcprofile":"application/vnd.ipunplugged.rcprofile",".rdf":"application/rdf+xml",".rdz":"application/vnd.data-vision.rdz",".rep":"application/vnd.businessobjects",".res":"application/x-dtbresource+xml",".rgb":"image/x-rgb",".rif":"application/reginfo+xml",".rl":"application/resource-lists+xml",".rlc":"image/vnd.fujixerox.edmics-rlc",".rld":"application/resource-lists-diff+xml",".rm":"application/vnd.rn-realmedia",".rmi":"audio/midi",".rmp":"audio/x-pn-realaudio-plugin",".rms":"application/vnd.jcp.javame.midlet-rms",
".rnc":"application/relax-ng-compact-syntax",".roff":"text/troff",".rpm":"application/x-rpm",".rpss":"application/vnd.nokia.radio-presets",".rpst":"application/vnd.nokia.radio-preset",".rq":"application/sparql-query",".rs":"application/rls-services+xml",".rsd":"application/rsd+xml",".rss":"application/rss+xml",".rtf":"application/rtf",".rtx":"text/richtext",".s":"text/x-asm",".saf":"application/vnd.yamaha.smaf-audio",".sbml":"application/sbml+xml",".sc":"application/vnd.ibm.secure-container",".scd":"application/x-msschedule",
".scm":"application/vnd.lotus-screencam",".scq":"application/scvp-cv-request",".scs":"application/scvp-cv-response",".scurl":"text/vnd.curl.scurl",".sda":"application/vnd.stardivision.draw",".sdc":"application/vnd.stardivision.calc",".sdd":"application/vnd.stardivision.impress",".sdkd":"application/vnd.solent.sdkm+xml",".sdkm":"application/vnd.solent.sdkm+xml",".sdp":"application/sdp",".sdw":"application/vnd.stardivision.writer",".see":"application/vnd.seemail",".seed":"application/vnd.fdsn.seed",
".sema":"application/vnd.sema",".semd":"application/vnd.semd",".semf":"application/vnd.semf",".ser":"application/java-serialized-object",".setpay":"application/set-payment-initiation",".setreg":"application/set-registration-initiation",".sfd-hdstx":"application/vnd.hydrostatix.sof-data",".sfs":"application/vnd.spotfire.sfs",".sgl":"application/vnd.stardivision.writer-global",".sgm":"text/sgml",".sgml":"text/sgml",".sh":"application/x-sh",".shar":"application/x-shar",".shf":"application/shf+xml",".si":"text/vnd.wap.si",
".sic":"application/vnd.wap.sic",".sig":"application/pgp-signature",".silo":"model/mesh",".sis":"application/vnd.symbian.install",".sisx":"application/vnd.symbian.install",".sit":"application/x-stuffit",".sitx":"application/x-stuffitx",".skd":"application/vnd.koan",".skm":"application/vnd.koan",".skp":"application/vnd.koan",".skt":"application/vnd.koan",".sl":"text/vnd.wap.sl",".slc":"application/vnd.wap.slc",".sldm":"application/vnd.ms-powerpoint.slide.macroenabled.12",".sldx":"application/vnd.openxmlformats-officedocument.presentationml.slide",
".slt":"application/vnd.epson.salt",".smf":"application/vnd.stardivision.math",".smi":"application/smil+xml",".smil":"application/smil+xml",".snd":"audio/basic",".snf":"application/x-font-snf",".so":"application/octet-stream",".spc":"application/x-pkcs7-certificates",".spf":"application/vnd.yamaha.smaf-phrase",".spl":"application/x-futuresplash",".spot":"text/vnd.in3d.spot",".spp":"application/scvp-vp-response",".spq":"application/scvp-vp-request",".spx":"audio/ogg",".src":"application/x-wais-source",
".srx":"application/sparql-results+xml",".sse":"application/vnd.kodak-descriptor",".ssf":"application/vnd.epson.ssf",".ssml":"application/ssml+xml",".stc":"application/vnd.sun.xml.calc.template",".std":"application/vnd.sun.xml.draw.template",".stf":"application/vnd.wt.stf",".sti":"application/vnd.sun.xml.impress.template",".stk":"application/hyperstudio",".stl":"application/vnd.ms-pki.stl",".str":"application/vnd.pg.format",".stw":"application/vnd.sun.xml.writer.template",".sus":"application/vnd.sus-calendar",
".susp":"application/vnd.sus-calendar",".sv4cpio":"application/x-sv4cpio",".sv4crc":"application/x-sv4crc",".svd":"application/vnd.svd",".svg":"image/svg+xml",".svgz":"image/svg+xml",".swa":"application/x-director",".swf":"application/x-shockwave-flash",".swi":"application/vnd.arastra.swi",".sxc":"application/vnd.sun.xml.calc",".sxd":"application/vnd.sun.xml.draw",".sxg":"application/vnd.sun.xml.writer.global",".sxi":"application/vnd.sun.xml.impress",".sxm":"application/vnd.sun.xml.math",".sxw":"application/vnd.sun.xml.writer",
".t":"text/troff",".tao":"application/vnd.tao.intent-module-archive",".tar":"application/x-tar",".tcap":"application/vnd.3gpp2.tcap",".tcl":"application/x-tcl",".teacher":"application/vnd.smart.teacher",".tex":"application/x-tex",".texi":"application/x-texinfo",".texinfo":"application/x-texinfo",".text":"text/plain",".tfm":"application/x-tex-tfm",".tgz":"application/x-gzip",".tif":"image/tiff",".tiff":"image/tiff",".tmo":"application/vnd.tmobile-livetv",".torrent":"application/x-bittorrent",".tpl":"application/vnd.groove-tool-template",
".tpt":"application/vnd.trid.tpt",".tr":"text/troff",".tra":"application/vnd.trueapp",".trm":"application/x-msterminal",".tsv":"text/tab-separated-values",".ttc":"application/x-font-ttf",".ttf":"application/x-font-ttf",".twd":"application/vnd.simtech-mindmapper",".twds":"application/vnd.simtech-mindmapper",".txd":"application/vnd.genomatix.tuxedo",".txf":"application/vnd.mobius.txf",".txt":"text/plain",".u32":"application/x-authorware-bin",".udeb":"application/x-debian-package",".ufd":"application/vnd.ufdl",
".ufdl":"application/vnd.ufdl",".umj":"application/vnd.umajin",".unityweb":"application/vnd.unity",".uoml":"application/vnd.uoml+xml",".uri":"text/uri-list",".uris":"text/uri-list",".urls":"text/uri-list",".ustar":"application/x-ustar",".utz":"application/vnd.uiq.theme",".uu":"text/x-uuencode",".vcd":"application/x-cdlink",".vcf":"text/x-vcard",".vcg":"application/vnd.groove-vcard",".vcs":"text/x-vcalendar",".vcx":"application/vnd.vcx",".vis":"application/vnd.visionary",".viv":"video/vnd.vivo",".vor":"application/vnd.stardivision.writer",
".vox":"application/x-authorware-bin",".vrml":"model/vrml",".vsd":"application/vnd.visio",".vsf":"application/vnd.vsf",".vss":"application/vnd.visio",".vst":"application/vnd.visio",".vsw":"application/vnd.visio",".vtu":"model/vnd.vtu",".vxml":"application/voicexml+xml",".w3d":"application/x-director",".wad":"application/x-doom",".wav":"audio/x-wav",".wax":"audio/x-ms-wax",".wbmp":"image/vnd.wap.wbmp",".wbs":"application/vnd.criticaltools.wbs+xml",".wbxml":"application/vnd.wap.wbxml",".wcm":"application/vnd.ms-works",
".wdb":"application/vnd.ms-works",".wiz":"application/msword",".wks":"application/vnd.ms-works",".wm":"video/x-ms-wm",".wma":"audio/x-ms-wma",".wmd":"application/x-ms-wmd",".wmf":"application/x-msmetafile",".wml":"text/vnd.wap.wml",".wmlc":"application/vnd.wap.wmlc",".wmls":"text/vnd.wap.wmlscript",".wmlsc":"application/vnd.wap.wmlscriptc",".wmv":"video/x-ms-wmv",".wmx":"video/x-ms-wmx",".wmz":"application/x-ms-wmz",".wpd":"application/vnd.wordperfect",".wpl":"application/vnd.ms-wpl",".wps":"application/vnd.ms-works",
".wqd":"application/vnd.wqd",".wri":"application/x-mswrite",".wrl":"model/vrml",".wsdl":"application/wsdl+xml",".wspolicy":"application/wspolicy+xml",".wtb":"application/vnd.webturbo",".wvx":"video/x-ms-wvx",".x32":"application/x-authorware-bin",".x3d":"application/vnd.hzn-3d-crossword",".xap":"application/x-silverlight-app",".xar":"application/vnd.xara",".xbap":"application/x-ms-xbap",".xbd":"application/vnd.fujixerox.docuworks.binder",".xbm":"image/x-xbitmap",".xdm":"application/vnd.syncml.dm+xml",
".xdp":"application/vnd.adobe.xdp+xml",".xdw":"application/vnd.fujixerox.docuworks",".xenc":"application/xenc+xml",".xer":"application/patch-ops-error+xml",".xfdf":"application/vnd.adobe.xfdf",".xfdl":"application/vnd.xfdl",".xht":"application/xhtml+xml",".xhtml":"application/xhtml+xml",".xhvml":"application/xv+xml",".xif":"image/vnd.xiff",".xla":"application/vnd.ms-excel",".xlam":"application/vnd.ms-excel.addin.macroenabled.12",".xlb":"application/vnd.ms-excel",".xlc":"application/vnd.ms-excel",
".xlm":"application/vnd.ms-excel",".xls":"application/vnd.ms-excel",".xlsb":"application/vnd.ms-excel.sheet.binary.macroenabled.12",".xlsm":"application/vnd.ms-excel.sheet.macroenabled.12",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".xlt":"application/vnd.ms-excel",".xltm":"application/vnd.ms-excel.template.macroenabled.12",".xltx":"application/vnd.openxmlformats-officedocument.spreadsheetml.template",".xlw":"application/vnd.ms-excel",".xml":"application/xml",".xo":"application/vnd.olpc-sugar",
".xop":"application/xop+xml",".xpdl":"application/xml",".xpi":"application/x-xpinstall",".xpm":"image/x-xpixmap",".xpr":"application/vnd.is-xpr",".xps":"application/vnd.ms-xpsdocument",".xpw":"application/vnd.intercon.formnet",".xpx":"application/vnd.intercon.formnet",".xsl":"application/xml",".xslt":"application/xslt+xml",".xsm":"application/vnd.syncml+xml",".xspf":"application/xspf+xml",".xul":"application/vnd.mozilla.xul+xml",".xvm":"application/xv+xml",".xvml":"application/xv+xml",".xwd":"image/x-xwindowdump",
".xyz":"chemical/x-xyz",".zaz":"application/vnd.zzazz.deck+xml",".zip":"application/zip",".zir":"application/vnd.zul",".zirz":"application/vnd.zul",".zmm":"application/vnd.handheld-entertainment+xml"};CUI.FileUpload.MimeTypes.getMimeTypeFromFileName=function(fileName){var fileExtensionMatch=fileName.match(/.+(\..+)/);return fileExtensionMatch?CUI.FileUpload.MimeTypes[fileExtensionMatch[1]]:undefined}})(window.jQuery);
(function($){var REG_EXP=new RegExp("[^\\d.-]","g");CUI.NumberInput=new Class({toString:"NumberInput",extend:CUI.Widget,construct:function(options){this._initMarkup();this._setListeners();this._setAttributes();this._makeAccessible()},defaults:{defaultValue:0,max:null,min:null,step:1,hasError:false,disabled:false},increment:function(){if(this._isNumber()){var value=this.getValue(),precision=this._getPrecision();value+=this.getStep();value=value>this.getMax()?this.getMax():value;if(precision>0)value=
parseFloat(value.toFixed(precision));this.setValue(value)}},decrement:function(){if(this._isNumber()){var value=this.getValue(),precision=this._getPrecision();value-=this.getStep();value=value<this.getMin()?this.getMin():value;if(precision>0)value=parseFloat(value.toFixed(precision));this.setValue(value)}},setValue:function(value){this.$input.val(value);this.$input.trigger("change")},setMin:function(value){this.set("min",value);if(this.$input.attr("aria-valuemin"))this.$input.attr("aria-valuemin",
this.options.min);this.$input.attr("min",this.options.min)},setMax:function(value){this.set("max",value);if(this.$input.attr("aria-valuemax"))this.$input.attr("aria-valuemax",this.options.max);this.$input.attr("max",this.options.max)},setStep:function(value){this.set("step",value);if(this.options.step!==1&&this.$input.attr("step")!==this.options.step)this.$input.attr("step",this.options.step)},getValue:function(){var result=this.$input.val();if(typeof result=="undefined"||result==null||result.length<
1)result="";else result=parseFloat(result);return isNaN(result)?"":result},getMin:function(){return parseFloat(this.options.min)},getMax:function(){return parseFloat(this.options.max)},getStep:function(){return parseFloat(this.options.step)},_initMarkup:function(){this.$element.addClass("coral-NumberInput");this.$input=this.$element.find(".js-coral-NumberInput-input");this._switchInputType(this.$input);this.$decrementElement=this.$element.find(".js-coral-NumberInput-decrementButton");this.$incrementElement=
this.$element.find(".js-coral-NumberInput-incrementButton");this.$liveRegion=$("\x3cspan/\x3e").addClass("u-coral-screenReaderOnly").attr({"aria-live":"assertive"}).insertAfter(this.$input)},_liveRegionTimeout:null,_clearLiveRegionTimeout:null,_updateLiveRegion:function(value){var self=this,val=value;clearTimeout(this._liveRegionTimeout);clearTimeout(this._clearLiveRegionTimeout);if(val===undefined||val.length===0)this.$liveRegion.text("");else this._liveRegionTimeout=setTimeout(function(){self.$liveRegion.text(val);
self._clearLiveRegionTimeout=setTimeout(function(){self.$liveRegion.text("")},2E3)},200)},_setListeners:function(){this.$input.on("change.cui-numberinput",this._changeHandler.bind(this));this.on("beforeChange:step",this._optionBeforeChangeHandler.bind(this));this.on("beforeChange:min",this._optionBeforeChangeHandler.bind(this));this.on("beforeChange:max",this._optionBeforeChangeHandler.bind(this));this.on("change:disabled",this._toggleDisabled.bind(this));this.on("change:hasError",this._toggleError.bind(this));
this.on("click.cui-numberinput","button",this._clickIncrementOrDecrement.bind(this));this.on("keydown.cui-numberinput","input, button",this._keyDown.bind(this)).on("keypress.cui-numberinput, paste.cui-numberinput","input",this._keyPress.bind(this)).on("focusin.cui-numberinput","input, button",this._focusIn.bind(this)).on("focusout.cui-numberinput","input, button",this._focusOut.bind(this))},_setAttributes:function(){if(this.$input.attr("max"))this.setMax(this.$input.attr("max"));else if($.isNumeric(this.options.max))this.setMax(this.options.max);
if(this.$input.attr("min"))this.setMin(this.$input.attr("min"));else if($.isNumeric(this.options.min))this.setMin(this.options.min);if(this.$element.attr("error"))this.options.hasError=true;this.setStep(this.$input.attr("step")||this.options.step);this.setValue(this.$input.val()!==""?this.$input.val():this.options.defaultValue);if(this.$element.attr("disabled")||this.$element.attr("data-disabled"))this._toggleDisabled();if(this.$element.hasClass("is-invalid")||this.$element.attr("data-error"))this.set("hasError",
true)},_makeAccessible:function(){var valueNow=this.getValue(),input=this.$input.get(0),useAriaSpinbuttonRole=input.type==="text";if(!useAriaSpinbuttonRole)if(typeof input.stepUp==="function")try{input.stepUp();input.value=valueNow}catch(err){useAriaSpinbuttonRole=true}else useAriaSpinbuttonRole=true;if(useAriaSpinbuttonRole)this.$input.attr({"role":"spinbutton","aria-valuenow":valueNow,"aria-valuetext":valueNow,"aria-valuemax":this.options.max,"aria-valuemin":this.options.min});this.$incrementElement.add(this.$decrementElement).attr("tabindex",
-1).filter("[title]:not([aria-label])").each(function(i,button){var $button=$(button);if($.trim($button.text()).length===0)$button.append('\x3cspan class\x3d"u-coral-screenReaderOnly"\x3e'+$button.attr("title")+"\x3c/span\x3e")})},_changeHandler:function(event){var isSpinbutton=this.$input.is('[role\x3d"spinbutton"]');this._checkMinMaxViolation();this._adjustValueLimitedToRange();this._checkValidity();var valueNow=this.getValue();this.$input.attr({"aria-valuenow":isSpinbutton?valueNow:null,"aria-valuetext":valueNow});
if(isSpinbutton&&this.$input.is(":focus"))this._updateLiveRegion("");else this._updateLiveRegion(valueNow)},_keyDown:function(event){var incrementOrDecrement,focusInput=false,captureEvent=false;switch(event.which){case 33:case 38:incrementOrDecrement=this.increment;focusInput=true;captureEvent=true;break;case 34:case 40:incrementOrDecrement=this.decrement;focusInput=true;captureEvent=true;break;case 35:if(this.options.max!==null)this.setValue(this.options.max);focusInput=true;captureEvent=true;break;
case 36:if(this.options.min!==null)this.setValue(this.options.min);focusInput=true;captureEvent=true;break}if(captureEvent){event.preventDefault();event.stopImmediatePropagation()}if(incrementOrDecrement)incrementOrDecrement.call(this);if(focusInput&&!this.$input.is(document.activeElement))this.$input.trigger("focus")},_keyPress:function(event){var newValue=this.$input.val()+String.fromCharCode(event.which||event.keyCode);if(newValue!==newValue.replace(REG_EXP,""))event.preventDefault()},_focusIn:function(event){this.$element.addClass("is-focused")},
_focusOut:function(event){this.$element.removeClass("is-focused");this._updateLiveRegion("")},_clickIncrementOrDecrement:function(event){var incrementOrDecrement,$currentTarget=$(event.currentTarget);if($currentTarget.is(this.$incrementElement))incrementOrDecrement=this.increment;else if($currentTarget.is(this.$decrementElement))incrementOrDecrement=this.decrement;if(incrementOrDecrement){if(!$currentTarget.is(document.activeElement))$currentTarget.trigger("focus");incrementOrDecrement.call(this)}},
_adjustValueLimitedToRange:function(){var value=this.getValue(),precision=this._getPrecision();if(!isNaN(value)){if(value>this.getMax())value=this.getMax();else if(value<this.getMin())value=this.getMin();if(precision>0)value=parseFloat(value.toFixed(precision))}this.$input.val(value)},_checkMinMaxViolation:function(){var hasFocus=false;if(this._isNumber()){this.$incrementElement.removeAttr("disabled");this.$decrementElement.removeAttr("disabled");if(this.options.max!==null&&this.getValue()>=this.getMax()){hasFocus=
this.$incrementElement.is(document.activeElement);this.$incrementElement.attr("disabled","disabled")}else if(this.options.min!==null&&this.getValue()<=this.getMin()){hasFocus=this.$decrementElement.is(document.activeElement);this.$decrementElement.attr("disabled","disabled")}if(hasFocus)this.$input.trigger("focus")}},_checkValidity:function(){if(this.$input.val()===""&&this.options.defaultValue!==null)this.set("hasError",false);else this.set("hasError",this.getValue()!==this._getSnappedValue())},
_getSnappedValue:function(value){var rawValue=value===undefined?this.getValue():value,snappedValue=rawValue,min=this.getMin(),max=this.getMax(),step=this.getStep(),remainder,precision=this._getPrecision();remainder=(rawValue-(isNaN(min)?0:min))%step;if(Math.abs(remainder)*2>=step)snappedValue=rawValue-remainder+step;else snappedValue=rawValue-remainder;if(!isNaN(min)&&!isNaN(max))if(snappedValue<min)snappedValue=min;else if(snappedValue>max)snappedValue=min+Math.floor((max-min)/step)*step;if(precision>
0)snappedValue=parseFloat(snappedValue.toFixed(precision));return snappedValue},_getPrecision:function(){var value=this.getValue(),step=this.getStep(),regex=/^(?:-?\d+)(?:\.(\d+))?$/g,valuePrecision=value.toString().replace(regex,"$1").length,stepPrecision=step.toString().replace(regex,"$1").length;return valuePrecision>stepPrecision?valuePrecision:stepPrecision},_switchInputType:function($input){var correctType="number";var isIE=window.navigator.userAgent.indexOf("MSIE 10.0")!==-1||!!window.navigator.userAgent.match(/Trident\/7\./);
if(isIE){$input.get(0).type="text";return}if($input.get(0).type===correctType)return;$input.detach().attr("type",correctType).insertBefore(this.$element.children(":last"))},_isNumber:function(){return!isNaN(this.$input.val())},_optionBeforeChangeHandler:function(event){if(isNaN(parseFloat(event.value)))event.preventDefault();else this.$input.attr(event.option,event.value)},_toggleDisabled:function(){if(this.options.disabled){this.$incrementElement.attr("disabled","disabled");this.$decrementElement.attr("disabled",
"disabled");this.$input.attr("disabled","disabled")}else{this.$incrementElement.removeAttr("disabled");this.$decrementElement.removeAttr("disabled");this.$input.removeAttr("disabled")}},_toggleError:function(){if(this.options.hasError){this.$element.addClass("is-invalid");this.$input.addClass("is-invalid").attr("aria-invalid",true)}else{this.$element.removeClass("is-invalid");this.$input.removeClass("is-invalid").removeAttr("aria-invalid")}}});CUI.Widget.registry.register("numberinput",CUI.NumberInput);
$(document).on("cui-contentloaded.data-api",function(e){CUI.NumberInput.init($("[data-init~\x3dnumberinput]",e.target))})})(window.jQuery);
(function($){var datepicker_guid=0;CUI.Datepicker=new Class({toString:"Datepicker",extend:CUI.Widget,defaults:{monthNames:null,dayNames:null,format:null,type:"date",selectedDateTime:null,startDay:0,disabled:false,displayedFormat:null,storedFormat:null,headFormat:"MMMM YYYY",forceHTMLMode:false,required:false,hasError:false,minDate:null,maxDate:null},displayDateTime:null,pickerShown:false,construct:function(){this.guid=datepicker_guid+=1;this._readOptionsFromMarkup();this._parseOptions();this._setupMomentJS();
this._adjustMarkup();this._findElements();this._constructPopover();this._initialize()},_readOptionsFromMarkup:function(){var options=this.options;var element=this.$element;var $input=$(element.find("input").filter("[type^\x3ddate],[type\x3dtime]"));if($input.length!==0)options.type=$input.attr("type");[["disabled","disabled",asBoolean],["required","required",asBoolean],["displayed-format","displayedFormat",ifDefined],["stored-format","storedFormat",ifDefined],["force-html-mode","forceHTMLMode",ifDefined],
["day-names","dayNames",ifTruthy],["month-names","monthNames",ifTruthy],["head-format","headFormat",ifTruthy],["start-day","startDay",asNumber],["min-date","minDate",ifDefined],["max-date","maxDate",ifDefined]].map(function(attr){var name=attr[0],field=attr[1],processor=attr[2];processor(element.data(name),field,options)})},_parseOptions:function(){var options=this.options;options.monthNames=options.monthNames||CUI.Datepicker.monthNames;options.dayNames=options.dayNames||CUI.Datepicker.dayNames;options.isDateEnabled=
options.type==="date"||options.type==="datetime"||options.type==="datetime-local";options.isTimeEnabled=options.type==="time"||options.type==="datetime"||options.type==="datetime-local";var i=document.createElement("input");i.setAttribute("type",options.type);options.supportsInputType=i.type!=="text";if(options.minDate!==null)if(options.minDate==="today")options.minDate=moment().startOf("day");else if(moment(options.minDate,OFFICIAL_DATE_FORMAT).isValid())options.minDate=moment(options.minDate,OFFICIAL_DATE_FORMAT);
else options.minDate=null;if(options.maxDate!==null)if(options.maxDate==="today")options.maxDate=moment().startOf("day");else if(moment(options.maxDate,OFFICIAL_DATE_FORMAT).isValid())options.maxDate=moment(options.maxDate,OFFICIAL_DATE_FORMAT);else options.maxDate=null;options.storedFormat=options.storedFormat||(options.type==="time"?OFFICIAL_TIME_FORMAT:OFFICIAL_DATETIME_FORMAT);options.displayedFormat=options.displayedFormat||(options.type==="time"?OFFICIAL_TIME_FORMAT:DISPLAY_FORMAT);options.useNativeControls=
options.forceHTMLMode;if(!options.forceHTMLMode&&IS_MOBILE_DEVICE&&options.supportsInputType)options.useNativeControls=true;if(options.useNativeControls)if(options.type==="date")options.displayedFormat=OFFICIAL_DATE_FORMAT;else if(options.type==="time")options.displayedFormat=OFFICIAL_TIME_FORMAT;else options.displayedFormat=OFFICIAL_DATETIME_FORMAT},_setupMomentJS:function(){this.options.language=LANGUAGE_NAME_PREFIX+(new Date).getTime();moment.locale(this.options.language,{months:this.options.monthNames,
weekdaysMin:this.options.dayNames})},_adjustMarkup:function(){var $element=this.$element;if(!this.options.useNativeControls){var id="popguid"+this.guid;var idQuery="#"+id+".coral-Popover";this.$popover=$("body").find(idQuery);if(this.$popover.length===0){$("body").append(HTML_POPOVER.replace("%ID%",id));this.$popover=$("body").find(idQuery);if(this.options.isDateEnabled)this.$popover.find(".coral-Popover-content").append(HTML_CALENDAR)}}else this.$popover=[];var $hiddenInput=$element.find("input[type\x3dhidden]");
if($hiddenInput.length===0)$element.prepend('\x3cinput type\x3d"hidden"\x3e');else $element.prepend($hiddenInput);if(!$element.find("input[type\x3dhidden]").attr("name")){var name=$element.find("input").not("[type\x3dhidden]").attr("name");$element.find("input[type\x3dhidden]").attr("name",name);$element.find("input").not("[type\x3dhidden]").removeAttr("name")}},_findElements:function(){this.$input=this.$element.find("input").not("[type\x3dhidden]");this.$hiddenInput=this.$element.find("input[type\x3dhidden]");
this.$openButton=this.$element.find("button")},_constructPopover:function(){if(this.$popover.length)this.popover=new Popover({$element:this.$popover,$trigger:this.$openButton,options:this.options,setDateTimeCallback:this._popoverSetDateTimeCallback.bind(this),hideCallback:this._popoverHideCallback.bind(this)})},_initialize:function(){this.on("change:disabled",this._toggleDisabled.bind(this));if(this.options.useNativeControls){this.displayDateTime=this.options.selectedDateTime=moment(this.$input.val(),
this.options.displayedFormat);this.$openButton.hide()}else this._switchInputTypeToText(this.$input);this.$openButton.on("click",this._clickHandler.bind(this));this.$input.on("change"+(IS_MOBILE_DEVICE?" blur":""),this._inputChangedHandler.bind(this));if(!this.options.selectedDateTime)this._readInputVal([this.options.storedFormat,this.options.displayedFormat]);this._setDateTime(this.options.selectedDateTime,true)},_readInputVal:function(format){var value=this.$input.eq(0).val();if(value!==""){var date=
moment(value,format||this.options.displayedFormat);if(!date||!date.isValid())date=moment(new Date(value));this.displayDateTime=this.options.selectedDateTime=date;if(date!==null&&date.isValid())this.displayDateTime=this.options.selectedDateTime=date}else this.displayDateTime=null},_updateState:function(){this._toggleDisabled();if(this.options.hasError||!this.options.selectedDateTime&&this.options.required||this.options.selectedDateTime&&!this.options.selectedDateTime.isValid()){this.$element.addClass("is-invalid");
this.$element.find("input").addClass("is-invalid")}else{this.$element.removeClass("is-invalid");this.$element.find("input").removeClass("is-invalid")}},_toggleDisabled:function(){if(this.options.disabled){this.$element.find("input,button").attr("disabled","disabled");this._hidePicker()}else this.$element.find("input,button").removeAttr("disabled")},_popoverSetDateTimeCallback:function(){this._setDateTime.apply(this,arguments);if(this.options.isTimeEnabled===false)this._hidePicker()},_popoverHideCallback:function(){this.pickerShown=
false;this.$element.find("input").removeClass("is-highlighted")},_switchInputTypeToText:function($input){var $parent=$input.parent();$input.detach().attr("type","text").prependTo($parent)},_openNativeInput:function(){this.$input.trigger("click")},_clickHandler:function(event){if(this.options.disabled)return;if(this.pickerShown)this._hidePicker();else{var self=this;setTimeout(function(){self._openPicker()},100)}},_inputChangedHandler:function(){if(this.options.disabled)return;var newDate;if(this.$input.val()!==
""){newDate=moment(this.$input.val(),this.options.displayedFormat);this.options.hasError=newDate!==null&&!isDateInRange(newDate,this.options.minDate,this.options.maxDate)}else this.options.hasError=false;this._setDateTime(newDate,true)},_keyPress:function(){if(this.pickerShown);},_openPicker:function(){if(this.options.useNativeControls)this._openNativeInput();else{this._readInputVal();this._showPicker()}},_showPicker:function(){if(!this.pickerShown){this.$element.find("input").addClass("is-highlighted");
this.popover.show(this.displayDateTime);this.pickerShown=true}},_hidePicker:function(){if(this.pickerShown){this.$element.find("input").removeClass("is-highlighted");this.popover.hide();this.pickerShown=false}},_setDateTime:function(date,silent){this.options.selectedDateTime=this.displayDateTime=date;if(!date)this.$input.val("");else if(date.isValid())this.$input.val(date.locale(this.options.language).format(this.options.displayedFormat));var storage=date&&date.isValid()?date.locale("en").format(this.options.storedFormat):
"";this.$hiddenInput.val(storage);this._updateState();if(!silent)this.$input.trigger("change");this.$hiddenInput.trigger("change")}});CUI.Datepicker.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];CUI.Datepicker.dayNames=["Su","Mo","Tu","We","Th","Fr","Sa"];CUI.Widget.registry.register("datepicker",CUI.Datepicker);if(CUI.options.dataAPI)$(document).on("cui-contentloaded.data-api",function(e){CUI.Datepicker.init($("[data-init~\x3ddatepicker]",
e.target))});var Popover=new Class({toString:"Popover",extend:Object,construct:function(options){this.$element=options.$element;this.options=options.options;this.setDateTimeCallback=options.setDateTimeCallback;this.hideCallback=options.hideCallback;this.$element.popover();this.popover=this.$element.data("popover");this.popover.set({pointAt:options.$trigger,pointFrom:"bottom"});this._setupListeners()},show:function(displayDateTime){this.displayDateTime=displayDateTime;this._renderCalendar();if(this.options.isTimeEnabled)this._renderTime();
this.popover.show()},hide:function(){this.popover.hide()},_setupListeners:function(){this.popover.on("hide",this._popupHideHandler.bind(this));this.$element.find(".coral-DatePicker-calendar").on("swipe",this._swipeHandler.bind(this));this.$element.on("mousedown",".coral-DatePicker-nextMonth",this._mouseDownNextHandler.bind(this));this.$element.on("mousedown",".coral-DatePicker-prevMonth",this._mouseDownPrevHandler.bind(this));if(this.options.isTimeEnabled){this.$element.on("selected",".coral-DatePicker-hour, .coral-DatePicker-minute",
this._dropdownChangedHandler.bind(this));this.$element.on("change",".coral-DatePicker-hour, .coral-DatePicker-minute",this._dropdownChangedHandler.bind(this))}},_popupHideHandler:function(event){this.hideCallback()},_swipeHandler:function(event){var d=event.direction,year=this.displayDateTime.year(),month=this.displayDateTime.month();var displayDateTime=moment([year,month,1]);if(d==="left"){displayDateTime.add(1,"months");this.displayDateTime=normalizeDate(displayDateTime);this._renderCalendar("left")}else if(d===
"right"){displayDateTime.subtract(1,"months");this.displayDateTime=normalizeDate(displayDateTime);this._renderCalendar("right")}},_mouseDownNextHandler:function(event){event.preventDefault();if(this.displayDateTime){var displayDateTime=moment([this.displayDateTime.year(),this.displayDateTime.month(),1]);displayDateTime.add(1,"months");this.displayDateTime=normalizeDate(displayDateTime);this._renderCalendar("left")}},_mouseDownPrevHandler:function(event){event.preventDefault();if(this.displayDateTime){var displayDateTime=
moment([this.displayDateTime.year(),this.displayDateTime.month(),1]);displayDateTime.subtract(1,"months");this.displayDateTime=normalizeDate(displayDateTime);this._renderCalendar("right")}},_dropdownChangedHandler:function(){var hours=this._getHoursFromDropdown();var minutes=this._getMinutesFromDropdown();if(!this.options.selectedDateTime)this.options.selectedDateTime=moment();var date=this.options.selectedDateTime.hours(hours).minutes(minutes);this.setDateTimeCallback(date)},_tableMouseDownHandler:function(event){event.preventDefault();
var date=moment($(event.target).data("date"),OFFICIAL_DATETIME_FORMAT);if(this.options.isTimeEnabled){var h=this._getHoursFromDropdown();var m=this._getMinutesFromDropdown();date.hours(h).minutes(m)}this.setDateTimeCallback(date);this._renderCalendar()},_renderCalendar:function(slide){var displayDateTime=this.displayDateTime;if(!displayDateTime||!displayDateTime.isValid())this.displayDateTime=displayDateTime=moment();var displayYear=displayDateTime.year();var displayMonth=displayDateTime.month()+
1;var table=this._renderOneCalendar(displayMonth,displayYear);var $calendar=this.$element.find(".coral-DatePicker-calendar");table.on("mousedown","a",this._tableMouseDownHandler.bind(this));if($calendar.find("table").length>0&&slide)this._slideCalendar(table,slide==="left");else{$calendar.find("table").remove();$calendar.find(".coral-DatePicker-calendarSlidingContainer").remove();$calendar.find(".coral-DatePicker-calendarBody").append(table)}},_renderOneCalendar:function(month,year){var heading=moment([year,
month-1,1]).locale(this.options.language).format(this.options.headFormat);var title=$('\x3cdiv class\x3d"coral-DatePicker-calendarHeader"\x3e\x3ch2 class\x3d"coral-Heading coral-Heading--2"\x3e'+heading+"\x3c/h2\x3e\x3c/div\x3e").append($('\x3cbutton class\x3d"coral-MinimalButton coral-DatePicker-nextMonth"\x3e\x26#x203A;\x3c/button\x3e')).append($('\x3cbutton class\x3d"coral-MinimalButton coral-DatePicker-prevMonth"\x3e\x26#x2039;\x3c/button\x3e'));var $calendar=this.$element.find(".coral-DatePicker-calendar");
var header=$calendar.find(".coral-DatePicker-calendarHeader");if(header.length>0)header.replaceWith(title);else $calendar.prepend(title);var table=$("\x3ctable\x3e");table.data("date",year+"/"+month);var html="\x3ctr\x3e";var day=null;for(var i=0;i<7;i++){day=(i+this.options.startDay)%7;var dayName=this.options.dayNames[day];html+="\x3cth\x3e\x3cspan\x3e"+dayName+"\x3c/span\x3e\x3c/th\x3e"}html+="\x3c/tr\x3e";table.append("\x3cthead\x3e"+html+"\x3c/thead\x3e");var firstDate=moment([year,month-1,1]);
var monthStartsAt=(firstDate.day()-this.options.startDay)%7;if(monthStartsAt<0)monthStartsAt+=7;html="";var today=moment();for(var w=0;w<6;w++){html+="\x3ctr\x3e";for(var d=0;d<7;d++){day=w*7+d-monthStartsAt;var displayDateTime=moment([year,month-1]);displayDateTime.add(day,"days");var isCurrentMonth=displayDateTime.month()+1===parseFloat(month);var cssClass="";if(isSameDay(displayDateTime,today))cssClass+=" today";if(isSameDay(displayDateTime,this.options.selectedDateTime))cssClass+=" selected";
if(isCurrentMonth&&isDateInRange(displayDateTime,this.options.minDate,this.options.maxDate))html+='\x3ctd class\x3d"'+cssClass+'"\x3e\x3ca href\x3d"#" data-date\x3d"'+displayDateTime.locale(this.options.language).format(OFFICIAL_DATETIME_FORMAT)+'"\x3e'+displayDateTime.date()+"\x3c/a\x3e\x3c/td\x3e";else html+='\x3ctd class\x3d"'+cssClass+'"\x3e\x3cspan\x3e'+displayDateTime.date()+"\x3c/span\x3e\x3c/td\x3e"}html+="\x3c/tr\x3e"}table.append("\x3ctbody\x3e"+html+"\x3c/tbody\x3e");return table},_slideCalendar:function(newtable,
isLeft){var containerClass="coral-DatePicker-calendarSlidingContainer";this.$element.find(".coral-DatePicker-calendarSlidingContainer table").stop(true,true);this.$element.find(".coral-DatePicker-calendarSlidingContainer").remove();var oldtable=this.$element.find("table");var width=oldtable.width();var height=oldtable.height();var container=$('\x3cdiv class\x3d"coral-DatePicker-calendarSlidingContainer"\x3e');container.css({"display":"block","position":"relative","width":width+"px","height":height+
"px","overflow":"hidden"});this.$element.find(".coral-DatePicker-calendarBody").append(container);container.append(oldtable).append(newtable);oldtable.css({"position":"absolute","left":0,"top":0});oldtable.after(newtable);newtable.css({"position":"absolute","left":isLeft?width:-width,"top":0});oldtable.animate({"left":isLeft?-width:width},TABLE_ANIMATION_SPEED,function(){oldtable.remove()});newtable.animate({"left":0},TABLE_ANIMATION_SPEED,function(){if(container.parents().length===0)return;newtable.css({"position":"relative",
"left":0,"top":0});newtable.detach();this.$element.find(".coral-DatePicker-calendarBody").append(newtable);container.remove()}.bind(this))},_renderTime:function(){var selectedTime=this.options.selectedDateTime||moment();var html=$(HTML_CLOCK_ICON);var hourSelect=$('\x3cselect class\x3d"coral-Select-select"\x3e\x3c/select\x3e');for(var h=0;h<24;h++){var hourOption=$("\x3coption\x3e"+padSingleDigit(h)+"\x3c/option\x3e");if(selectedTime&&h===selectedTime.hours())hourOption.attr("selected","selected");
hourSelect.append(hourOption)}var hourDropdown=$(HTML_HOUR_DROPDOWN).append(hourSelect);var minuteSelect=$('\x3cselect class\x3d"coral-Select-select"\x3e\x3c/select\x3e');for(var m=0;m<60;m++){var minuteOption=$("\x3coption\x3e"+padSingleDigit(m)+"\x3c/option\x3e");if(selectedTime&&m===selectedTime.minutes())minuteOption.attr("selected","selected");minuteSelect.append(minuteOption)}var minuteDropdown=$(HTML_MINUTE_DROPDOWN).append(minuteSelect);$(hourDropdown).css(STYLE_POSITION_RELATIVE);$(hourDropdown).find("coral-Select").css(STYLE_DROPDOWN_SELECT);
$(minuteDropdown).css(STYLE_POSITION_RELATIVE);$(minuteDropdown).find("coral-Select").css(STYLE_DROPDOWN_SELECT);html.append(hourDropdown,$("\x3cspan\x3e:\x3c/span\x3e"),minuteDropdown);if(this.$element.find(".coral-DatePicker-timeControls").length===0)this.$element.find(".coral-Popover-content").append(html);else this.$element.find(".coral-DatePicker-timeControls").empty().append(html.children());$(hourDropdown).select();$(minuteDropdown).select()},_getHoursFromDropdown:function(){return parseInt(this.$element.find(".coral-DatePicker-timeControls .coral-DatePicker-hour .coral-Select-select").val(),
10)},_getMinutesFromDropdown:function(){return parseInt(this.$element.find(".coral-DatePicker-timeControls .coral-DatePicker-minute .coral-Select-select").val(),10)}});function padSingleDigit(s){if(s<10)return"0"+s;return s}function ifDefined(value,field,options){if(value!==undefined)options[field]=value}function asBoolean(value,field,options){options[field]=value?true:false}function ifTruthy(value,field,options){options[field]=value||options[field]}function asNumber(value,field,options){if(value!==
undefined)options[field]=value*1}function normalizeDate(date){if(!date)return null;return moment([date.year(),date.month(),date.date()])}function isDateInRange(date,startDate,endDate){if(startDate===null&&endDate===null)return true;if(startDate===null)return date<=endDate;else if(endDate===null)return date>=startDate;else return startDate<=date&&date<=endDate}function isSameDay(d1,d2){if(d1&&d2)return d1.year()===d2.year()&&d1.month()===d2.month()&&d1.date()===d2.date()}var IS_MOBILE_DEVICE=navigator.userAgent.match(/Android/i)||
navigator.userAgent.match(/iPhone|iPad|iPod/i),OFFICIAL_DATE_FORMAT="YYYY-MM-DD",OFFICIAL_TIME_FORMAT="HH:mm",OFFICIAL_DATETIME_FORMAT="YYYY-MM-DD[T]HH:mmZ",DISPLAY_FORMAT="YYYY-MM-DD HH:mm",LANGUAGE_NAME_PREFIX="coralui_",HTML_CALENDAR=['\x3cdiv class\x3d"coral-DatePicker-calendar"\x3e','\x3cdiv class\x3d"coral-DatePicker-calendarHeader"\x3e\x3c/div\x3e','\x3cdiv class\x3d"coral-DatePicker-calendarBody"\x3e\x3c/div\x3e',"\x3c/div\x3e"].join(""),HTML_POPOVER=['\x3cdiv class\x3d"coral-Popover coral-Popover--datepicker" style\x3d"display:none" id\x3d"%ID%"\x3e',
'\x3cdiv class\x3d"coral-Popover-content"\x3e\x3c/div\x3e',"\x3c/div\x3e"].join(""),HTML_CLOCK_ICON='\x3cdiv class\x3d"coral-DatePicker-timeControls"\x3e\x3ci class\x3d"coral-Icon coral-Icon--clock coral-Icon--small"\x3e\x3c/i\x3e\x3c/div\x3e',HTML_HOUR_DROPDOWN='\x3cdiv class\x3d"coral-Select coral-DatePicker-hour"\x3e\x3cbutton class\x3d"coral-Select-button coral-MinimalButton"\x3e\x3cspan class\x3d"coral-Select-button-text"\x3e\x3c/span\x3e\x3c/button\x3e\x3c/div\x3e',HTML_MINUTE_DROPDOWN='\x3cdiv class\x3d"coral-Select coral-DatePicker-minute"\x3e\x3cbutton class\x3d"coral-Select-button coral-MinimalButton"\x3e\x3cspan class\x3d"coral-Select-button-text"\x3e\x3c/span\x3e\x3c/button\x3e\x3c/div\x3e',
STYLE_POSITION_RELATIVE={"position":"relative"},STYLE_DROPDOWN_SELECT={"position":"absolute","left":"1.5rem","top":"1rem"},TABLE_ANIMATION_SPEED=400})(window.jQuery);
(function($){CUI.Switch=new Class({toString:"Switch",extend:CUI.Widget,construct:function(options){this._initMarkup();this._setListeners()},_initMarkup:function(){this._correctElementTagName();this.$input=this.$element.find(".coral-Switch-input");this.$onLabel=this.$element.find(".coral-Switch-onLabel");this.$offLabel=this.$element.find(".coral-Switch-offLabel");this._makeAccessible()},_correctElementTagName:function(){var $newElement,attributes;if(!this.$element.is("label"))return;$newElement=$("\x3cspan/\x3e");
attributes=this.$element.prop("attributes");$.each(attributes,function(){$newElement.attr(this.name,this.value)});$newElement.insertBefore(this.$element).append(this.$element.children());this.$element.remove();this.$element=$newElement},_makeAccessible:function(){var self=this,labelIDs,checked=self.$input.is(":checked"),isMacLike=/(mac|iphone|ipod|ipad)/i.test(window.navigator.platform),isFirefox=/firefox/i.test(window.navigator.userAgent);if(!this.$input.attr("id"))this.$input.attr("id",CUI.util.getNextId());
if(!this.$offLabel.attr("id"))this.$offLabel.attr("id",CUI.util.getNextId());if(!this.$onLabel.attr("id"))this.$onLabel.attr("id",CUI.util.getNextId());if(!isMacLike)this.$input.attr({"role":"button","aria-pressed":checked});this.$offLabel.attr({"role":"presentation","aria-hidden":checked});this.$onLabel.attr({"role":"presentation","aria-hidden":!checked});if(this.$input.attr("aria-label")||this.$input.attr("aria-labelledby")&&$("#"+this.$input.attr("aria-labelledby").split(" ")[0]).length)return;
this.$labels=this.$element.closest("label");if(this.$labels.length===1){if(this.$labels.attr("for")!==this.$input.attr("id"))this.$labels.attr("for",this.$input.attr("id"));var beforeOrAfter=this.$labels.contents().filter(function(){return this.nodeType===3&&$.trim(this.nodeValue).length||this.nodeType===1}).index(this.$element)===0?"Before":"After";this.$element["insert"+beforeOrAfter](this.$labels)}else{this.$labels=$('label[for\x3d"'+this.$input.attr("id")+'"]').not(this.$offLabel).not(this.$onLabel);
if(this.$labels.length===0)this.$labels=this.$labels.add(this.$offLabel).add(this.$onLabel);if(this.$labels.length>0){labelIDs=[];this.$labels.each(function(i,label){var $label=$(label),isOnLabel=$label.is(self.$onLabel),isOffLabel=$label.is(self.$offLabel);if(!$label.attr("id"))$label.attr("id",CUI.util.getNextId());if(!isOnLabel&&!isOffLabel||isOnLabel&&checked||isOffLabel&&!checked)labelIDs.push($label.attr("id"))});if(labelIDs.length>0)this.$input.attr("aria-labelledby",labelIDs.join(" "))}}if(isMacLike&&
isFirefox)return;this.$input.attr("aria-describedby",checked?this.$onLabel.attr("id"):this.$offLabel.attr("id"))},_setListeners:function(){this.$input.on("change",function(event){var checked=this.$input.is(":checked"),onLabelId=this.$onLabel.attr("id"),offLabelId=this.$offLabel.attr("id"),ariaLabelledBy=this.$input.attr("aria-labelledby");if(ariaLabelledBy){ariaLabelledBy=ariaLabelledBy.replace(checked?offLabelId:onLabelId,checked?onLabelId:offLabelId);this.$input.attr("aria-labelledby",ariaLabelledBy)}this.$input.filter("[aria-describedby]").attr("aria-describedby",
checked?this.$onLabel.attr("id"):this.$offLabel.attr("id")).filter("[aria-pressed]").attr("aria-pressed",checked);this.$onLabel.attr("aria-hidden",!checked);this.$offLabel.attr("aria-hidden",checked)}.bind(this));this.$input.trigger("change")}});CUI.Widget.registry.register("Switch",CUI.Switch);$(document).on("cui-contentloaded.data-api",function(e){CUI.Switch.init($("[data-init~\x3dswitch], .coral-Switch",e.target))})})(window.jQuery);
(function($){function cloneLeft(buttons){return buttons.filter("[data-action\x3dprev], [data-action\x3dcancel]").first().addClass("u-coral-hidden").clone(true).addClass("coral-Wizard-backButton").each(processButton)}function cloneRight(buttons){return buttons.filter("[data-action\x3dnext]").first().addClass("u-coral-hidden").clone(true).addClass("coral-Button--primary coral-Wizard-nextButton").each(processButton)}function cloneCancel(buttons){return buttons.filter("[data-action\x3dcancel]").first().clone(true).addClass("coral-Button--quiet coral-Wizard-nextButton").each(processButton)}
function processButton(i,el){$(el).removeClass("u-coral-hidden").addClass("coral-Button")}function buildNav(wizard,sections){var nav=wizard.children(".js-coral-Wizard-nav");if(nav.length===0)wizard.prepend(function(){nav=$('\x3cnav class\x3d"js-coral-Wizard-nav coral-Wizard-nav coral--dark coral-Background coral-Text"\x3e'+'\x3col class\x3d"coral-Wizard-steplist"\x3e\x3c/ol\x3e'+"\x3c/nav\x3e");var ol=nav.children("ol");sections.map(function(){return $('\x3cli class\x3d"js-coral-Wizard-steplist-item coral-Wizard-steplist-item"\x3e\x3c/li\x3e').text($(this).data("stepTitle")||
this.title).get(0)}).appendTo(ol);return nav});if(!nav.hasClass("coral--light"))nav.addClass("coral--dark");nav.find(".js-coral-Wizard-steplist-item:first").addClass("is-active");var buttons=sections.first().find(".js-coral-Wizard-step-control");nav.prepend(function(){return cloneLeft(buttons)}).append(function(){return cloneRight(buttons).add(cloneCancel(buttons).toggleClass("u-coral-hidden",true))})}function insertAfter(wizard,step,refStep){var index=wizard.children(".js-coral-Wizard-step").index(refStep),
refNavStep=wizard.children(".js-coral-Wizard-nav").find(".js-coral-Wizard-steplist-item").eq(index),navStep=refNavStep.clone().text(step.data("stepTitle")||step.attr("title")).removeClass("is-active is-stepped");hideStep(step);refNavStep.after(navStep);refStep.after(step)}function showNav(to){if(to.length===0)return;to.addClass("is-active").removeClass("is-stepped");to.prevAll(".js-coral-Wizard-steplist-item").addClass("is-stepped").removeClass("is-active");to.nextAll(".js-coral-Wizard-steplist-item").removeClass("is-active is-stepped")}
function hideStep(step){if(step&&step.length)step.addClass("u-coral-hidden")}function showStep(step){if(step&&step.length)step.removeClass("u-coral-hidden")}function changeStep(wizard,to,from){if(to.length===0)return;hideStep(from);showStep(to);wizard.trigger("flexwizard-stepchange",[to,from])}function controlWizard(wizard,action){var nav=wizard.children(".js-coral-Wizard-nav");var from=wizard.children(".js-coral-Wizard-step:not(.u-coral-hidden)");var fromNav=nav.find(".js-coral-Wizard-steplist-item.is-active");
var to,toNav;switch(action){case "prev":to=from.prev(".js-coral-Wizard-step");toNav=fromNav.prev(".js-coral-Wizard-steplist-item");break;case "next":to=from.next(".js-coral-Wizard-step");toNav=fromNav.next(".js-coral-Wizard-steplist-item");break;case "cancel":return}if(to.length===0)return;var buttons=to.find(".js-coral-Wizard-step-control");cloneLeft(buttons).replaceAll(nav.children(".coral-Wizard-backButton"));cloneRight(buttons).replaceAll(nav.children(".coral-Wizard-nextButton:not([data-action\x3dcancel])"));
nav.children(".coral-Wizard-nextButton[data-action\x3dcancel]").toggleClass("u-coral-hidden",to.prev(".js-coral-Wizard-step").length===0);showNav(toNav);changeStep(wizard,to,from)}CUI.FlexWizard=new Class({toString:"FlexWizard",extend:CUI.Widget,construct:function(options){var wizard=this.$element,steps=wizard.find(".js-coral-Wizard-step");buildNav(wizard,steps);wizard.on("click",".js-coral-Wizard-step-control",function(e){controlWizard(wizard,$(this).data("action"))});hideStep(steps);changeStep(wizard,
steps.first())},prevStep:function(){controlWizard(this.$element,"prev")},nextStep:function(){controlWizard(this.$element,"next")},add:function(step,index){var wizard=this.$element;if(index===undefined){this.addAfter(step,wizard.children(".js-coral-Wizard-step").last());return}if(!step.jquery)step=$(step);step.addClass("js-coral-Wizard-step");insertAfter(wizard,step,wizard.children(".js-coral-Wizard-step").eq(index))},addAfter:function(step,refStep){var wizard=this.$element;if(!step.jquery)step=$(step);
if(!refStep.jquery)refStep=$(refStep);step.addClass("js-coral-Wizard-step");insertAfter(wizard,step,refStep)},remove:function(step){var wizard=this.$element;var $step=step.jquery?step:$(step);var index=wizard.children(".js-coral-Wizard-step").index($step);wizard.find(".js-coral-Wizard-steplist-item").eq(index).remove();$step.detach();return step}});CUI.Widget.registry.register("flexwizard",CUI.FlexWizard);if(CUI.options.dataAPI)$(document).on("cui-contentloaded.data-api",function(e){CUI.FlexWizard.init($("[data-init~\x3dflexwizard]",
e.target))})})(window.jQuery);
(function($,window,undefined){CUI.util.color={hex:function(x){return("0"+parseInt(x,10).toString(16)).slice(-2)},HexToRGB:function(hex){hex=parseInt(hex.indexOf("#")>-1?hex.substring(1):hex,16);return{r:hex>>16,g:(hex&65280)>>8,b:hex&255}},RGBAToHex:function(rgbaVal){var rgba=rgbaVal.substring(rgbaVal.indexOf("(")+1,rgbaVal.lastIndexOf(")")).split(/,\s*/);return"#"+this.hex(rgba[0])+this.hex(rgba[1])+this.hex(rgba[2])},RGBToHex:function(rgb){return"#"+this.hex(rgb.r)+this.hex(rgb.g)+this.hex(rgb.b)},
CMYKtoRGB:function(cmyk){var result={r:0,g:0,b:0};var c=parseInt(cmyk.c,10)/100;var m=parseInt(cmyk.m,10)/100;var y=parseInt(cmyk.y,10)/100;var k=parseInt(cmyk.k,10)/100;result.r=1-Math.min(1,c*(1-k)+k);result.g=1-Math.min(1,m*(1-k)+k);result.b=1-Math.min(1,y*(1-k)+k);result.r=Math.round(result.r*255);result.g=Math.round(result.g*255);result.b=Math.round(result.b*255);return result},RGBtoCMYK:function(rgb){var result={c:0,m:0,y:0,k:0};if(parseInt(rgb.r,10)===0&&parseInt(rgb.g,10)===0&&parseInt(rgb.b,
10)===0){result.k=100;return result}var r=parseInt(rgb.r,10)/255;var g=parseInt(rgb.g,10)/255;var b=parseInt(rgb.b,10)/255;result.k=Math.min(1-r,1-g,1-b);result.c=(1-r-result.k)/(1-result.k);result.m=(1-g-result.k)/(1-result.k);result.y=(1-b-result.k)/(1-result.k);result.c=Math.round(result.c*100);result.m=Math.round(result.m*100);result.y=Math.round(result.y*100);result.k=Math.round(result.k*100);return result},fixHex:function(hex){if(hex.length===3)hex=hex.charAt(0)+hex.charAt(0)+hex.charAt(1)+
hex.charAt(1)+hex.charAt(2)+hex.charAt(2);if(hex.indexOf("#")===-1)hex="#"+hex;var isOk=/(^#[0-9A-F]{6})|(^#[0-9A-F]{3})$/i.test(hex);if(!isOk){this.$element.find("[name\x3d':hex']").val("");return""}return hex},isSameColor:function(c1,c2){return c1&&c2&&c1===c2},isValid:function(colorFormat,colorAsStr){if(colorAsStr.indexOf(colorFormat)!=-1)return this.fixHex(this.RGBAToHex(colorAsStr))!=="";return false}}})(jQuery,this);
(function($){var COLORPICKER_FOOTER_TEMPLATE='\x3cdiv class\x3d"coral-ButtonGroup navigation-bar"\x3e\x3c/div\x3e';var CLASSIC_PALETTE_BUTTON="\x3cbutton class\x3d'coral-ButtonGroup-item coral-Button coral-Button--secondary' id\x3d'classicButton'\x3e\x3ci class\x3d\"coral-Icon coral-Icon--viewGrid\"\x3e\x3c/i\x3e\x3c/button\x3e";var EDIT_BUTTON="\x3cbutton class\x3d'coral-ButtonGroup-item coral-Button coral-Button--secondary' id\x3d'editButton'\x3e\x3ci class\x3d\"coral-Icon coral-Icon--edit\"\x3e\x3c/i\x3e\x3c/button\x3e";
var COLOR_SLIDER_BUTTON="\x3cbutton class\x3d'coral-ButtonGroup-item coral-Button coral-Button--secondary'\x3e\x3ci class\x3d\"coral-Icon coral-Icon--properties\"\x3e\x3c/i\x3e\x3c/button\x3e";var EDIT_MODE="editMode";var CLASSIC_MODE="classicMode";CUI.Colorpicker=new Class({toString:"Colorpicker",extend:CUI.Widget,defaults:{config:{colors:{},displayModes:{}},disabled:false,name:null,title:""},palettePageSize:3,colorShadeNo:6,lowerLimit:0,upperLimit:0,colorNames:[],currentPage:0,pages:1,construct:function(options){this._readDataFromMarkup();
this._adjustMarkup();if(this.options.config===null||this.options.config.colors.length===0)this.options.disabled=true;if(!this.options.disabled&&(this.options.config.displayModes.classicPalette&&this.options.config.displayModes.freestylePalette))this.options.disabled=true;if(!this.options.disabled&&(this.options.config.displayModes.length===0||!this.options.config.displayModes.classicPalette&&!this.options.config.displayModes.freestylePalette))this.options.config.displayModes.classicPalette=true;this.$openButton=
this.$element.find(".coral-ColorPicker-button");this.$hiddenInput=this.$element.find("input[name\x3d'"+this.options.name+"']");if(this.$element.attr("value")){var initialVal=this.$element.attr("value");if(CUI.util.color.isValid("rgba",initialVal)||CUI.util.color.isValid("rgb",initialVal))this._setColor(initialVal);else this.$element.removeAttr("value")}if(this.options.disabled)this.$element.find("\x3e.coral-ColorPicker-button").attr("disabled","disabled");else{this.colorNames=[];$.each(this.options.config.colors,
function(key,value){this.colorNames.push(key)}.bind(this));$(document).off("tap."+this.options.name+" click."+this.options.name).on("tap."+this.options.name+" click."+this.options.name,function(event){if(!this.keepShown)if(this.$popover.has(event.target).length===0)this._hidePicker()}.bind(this));this.$openButton.on("touchstart click",function(event){try{if(!this.pickerShown)this._openPicker();else this._hidePicker();this.keepShown=true;setTimeout(function(){this.keepShown=false}.bind(this),200)}catch(e){}}.bind(this))}},
_readDataFromMarkup:function(){if(this.$element.data("disabled"))this.options.disabled=true;if(this.$element.data("name"))this.options.name=this.$element.data("name");if(this.$element.attr("title"))this.options.title=this.$element.attr("title");var el=this.$element;if(el.data("config")!==undefined){this.options.config={};this.options.config.colors={};this.options.config.displayModes={};if(el.data("config").colors)this.options.config.colors=el.data("config").colors;else this.options.disabled=true;
if(el.data("config").pickerModes)this.options.config.displayModes=el.data("config").pickerModes}},_adjustMarkup:function(){this.$popover=this.$element.find(".coral-Popover");if(this.$popover.length===0){this.$popover=$('\x3cdiv class\x3d"coral-Popover"\x3e\x3cdiv class\x3d"coral-ColorPicker-popover-inner coral-Popover-content"\x3e\x3c/div\x3e\x3cdiv class\x3d"coral-ColorPicker-popover-arrow coral-Popover-arrow coral-Popover-arrow--up"\x3e\x3c/div\x3e\x3c/div\x3e');this.$element.append(this.$popover);
this.$element.find(".coral-ColorPicker-popover-inner").append('\x3cdiv class\x3d"colorpicker-holder"\x3e\x3cdiv class\x3d"palette-header"\x3e\x3c/div\x3e\x3cdiv class\x3d"colorpicker-body"\x3e\x3c/div\x3e\x3cdiv class\x3d"colorpicker-footer"\x3e\x3c/div\x3e\x3c/div\x3e')}if(this.$element.find("input[type\x3dhidden]").length===0)this.$element.append('\x3cinput type\x3d"hidden" name\x3d"'+this.options.name+'"\x3e');var $button=this.$element.find(".coral-ColorPicker-button");if($button.attr("type")===
undefined)$button.attr("type","button");$button.attr("data-toggle","popover");$button.attr("data-point-from","bottom")},_openPicker:function(){this._renderPicker(CLASSIC_MODE);this._renderPickerFooter();this.$popover.show();this.pickerShown=true},_hidePicker:function(){this.lowerLimit=0;this.upperLimit=0;this.currentPage=0;this.$element.removeClass("focus");this.$popover.hide();this.pickerShown=false},_renderPicker:function(mode,slide,pageNo){if(mode===CLASSIC_MODE&&!this._calculatePaletteBoundaries(slide,
pageNo))return;var table=null;if(mode===CLASSIC_MODE)table=this._renderPalette();else table=this._renderEditPalette();var $picker=this.$element.find(".colorpicker-holder");var $palette_nav=$picker.find(".palette-navigator");var $picker_body=$picker.find(".colorpicker-body");if(slide&&$picker.find("table").length>0)this._slidePicker(table,slide==="left");else{$picker.find("table").remove();$picker.find(".sliding-container").remove();if(mode===EDIT_MODE){$picker_body.append(table);$palette_nav.remove();
if(this.$hiddenInput.val()!==undefined&&this.$hiddenInput.val().length>0){table.find("div.color").css("background",this.$hiddenInput.val());var hex=CUI.util.color.RGBAToHex(this.$hiddenInput.val());table.find("input[name\x3d':hex']").val(hex);var rgb=CUI.util.color.HexToRGB(hex);this._fillRGBFields(rgb);var cmyk=CUI.util.color.RGBtoCMYK(rgb);this._fillCMYKFields(cmyk)}}else if($palette_nav.length>0)$palette_nav.before(table);else{$picker_body.append(table);this._renderPaletteNavigation()}}},_renderPickerFooter:function(){this.$element.find(".colorpicker-footer").html(COLORPICKER_FOOTER_TEMPLATE);
if(this.options.config.displayModes!==undefined){if(this.options.config.displayModes.classicPalette||this.options.config.displayModes.freestylePalette){var paletteButton=$(CLASSIC_PALETTE_BUTTON);paletteButton.addClass("is-selected");this.$element.find(".navigation-bar").append(paletteButton)}if(this.options.config.displayModes.edit)this.$element.find(".navigation-bar").append(EDIT_BUTTON);else{this.$element.find(".colorpicker-footer").remove();return}}this.$element.find(".colorpicker-footer button").off("click.button").on("click.button",
function(event){event.stopPropagation();event.preventDefault();var $target=$(event.target);var $button=null;this.$element.find(".navigation-bar \x3e .is-selected").removeClass("is-selected");if(event.target.nodeName==="BUTTON"){$target.addClass("is-selected");$button=$(event.target)}else{$target.parent().addClass("is-selected");$button=$target.parent()}if($button.attr("id")==="editButton")this._renderPicker(EDIT_MODE);else this._renderPicker(CLASSIC_MODE,false,this.currentPage)}.bind(this))},_calculatePaletteBoundaries:function(slide,
pageNo){var colorsPerPage=0;if(this.options.config.displayModes.freestylePalette)colorsPerPage=this.palettePageSize*this.colorShadeNo;else colorsPerPage=this.palettePageSize;if(!slide)if(pageNo!==undefined){this.lowerLimit=colorsPerPage*pageNo;this.upperLimit=this.lowerLimit+colorsPerPage-1;this.currentPage=pageNo}else{this.upperLimit+=colorsPerPage-1;this.lowerLimit=0;this.currentPage=0}else if(slide==="left"){pageNo=this.currentPage+1;if(pageNo+1>this.pages)return false;this.lowerLimit=colorsPerPage*
pageNo;this.upperLimit=this.lowerLimit+colorsPerPage-1;this.currentPage=pageNo}else{pageNo=this.currentPage-1;if(pageNo<0)return false;this.lowerLimit=colorsPerPage*pageNo;this.upperLimit=this.lowerLimit+colorsPerPage-1;this.currentPage=pageNo}return true},_renderPaletteNavigation:function(){this.$element.find(".palette-navigator").remove();var navigator=$("\x3cdiv\x3e");navigator.addClass("palette-navigator");if(this.options.config.displayModes.classicPalette)this.pages=Math.ceil(this.colorNames.length/
this.palettePageSize);else this.pages=Math.ceil(this.colorNames.length/(this.palettePageSize*this.colorShadeNo));if(this.pages>1)for(var i=0;i<this.pages;i++)navigator.append("\x3ci class\x3d'dot coral-Icon coral-Icon--circle' page\x3d'"+i+"'\x3e\x3c/i\x3e");this.$element.find(".colorpicker-body").append(navigator);this.$element.find("i[page\x3d'"+this.currentPage+"']").addClass("is-active");this.$element.find(".colorpicker-body").on("swipe",function(event){this._renderPicker(CLASSIC_MODE,event.direction===
"left"?"left":"right")}.bind(this));this.$element.find(".dot").off("click.dot").on("click.dot",function(event){event.stopPropagation();if(this.currentPage===parseInt($(event.target).attr("page"),10))return;this._renderPicker(CLASSIC_MODE,false,parseInt($(event.target).attr("page"),10))}.bind(this))},_slidePicker:function(newtable,isLeft){this.$element.find(".sliding-container table").stop(true,true);this.$element.find(".sliding-container").remove();var oldtable=this.$element.find("table");var width=
oldtable.width();var height=oldtable.height();var container=$('\x3cdiv class\x3d"sliding-container"\x3e');container.css({"display":"block","position":"relative","width":width+"px","height":height+"px","overflow":"hidden"});this.$element.find(".palette-navigator").before(container);container.append(oldtable).append(newtable);oldtable.css({"position":"absolute","left":0,"top":0});oldtable.after(newtable);newtable.css({"position":"absolute","left":isLeft?width:-width,"top":0});var speed=400;oldtable.animate({"left":isLeft?
-width:width},speed,function(){oldtable.remove()});newtable.animate({"left":0},speed,function(){if(container.parents().length===0)return;newtable.css({"position":"relative","left":0,"top":0});newtable.detach();this.$element.find(".palette-navigator").before(newtable);container.remove()}.bind(this))},_renderPaletteHeader:function(){var title=$('\x3cdiv class\x3d"palette-header"\x3e\x3cdiv class\x3d"title"\x3e\x3c/div\x3e\x3cdiv class\x3d"selection"\x3e\x3c/div\x3e\x3c/div\x3e');var $picker=this.$element.find(".colorpicker-holder");
if($picker.find(".palette-header").length>0)$picker.find(".palette-header").replaceWith(title);else $picker.prepend(title);$picker.find(".title").html("\x3cspan\x3e"+this.options.title+"\x3c/span\x3e")},_renderPalette:function(){this._renderPaletteHeader();var table=$("\x3ctable\x3e");var html="";for(var i=0;i<this.palettePageSize;i++){html+="\x3ctr\x3e";var opacity=0;var rgb="";var cssClass="";var shade="";for(var sh=0;sh<this.colorShadeNo;sh++)if(this.options.config.displayModes.classicPalette)if(this.colorNames.length-
1<i+this.lowerLimit)html+="\x3ctd\x3e\x3ca\x3e\x3c/a\x3e\x3c/td\x3e";else{rgb=CUI.util.color.HexToRGB(this.options.config.colors[this.colorNames[i+this.lowerLimit]]);shade="rgba("+rgb.r+","+rgb.g+","+rgb.b+","+(1-opacity).toFixed(2)+")";opacity+=.16;if(CUI.util.color.isSameColor(shade,this.$hiddenInput.val())){cssClass="is-selected";this._fillSelectedColor(this.colorNames[i+this.lowerLimit],CUI.util.color.RGBAToHex(shade))}else cssClass="";html+="\x3ctd class\x3d'filled'\x3e\x3ca style\x3d'background-color:"+
shade+"' color\x3d'"+shade+"' colorName\x3d'"+this.colorNames[i+this.lowerLimit]+"' class\x3d'"+cssClass+"'\x3e"+"\x3c/a\x3e\x3c/td\x3e"}else if(this.colorNames.length-1<i*this.colorShadeNo+sh)html+="\x3ctd\x3e\x3ca\x3e\x3c/a\x3e\x3c/td\x3e";else{rgb=CUI.util.color.HexToRGB(this.options.config.colors[this.colorNames[i*this.colorShadeNo+sh]]);shade="rgba("+rgb.r+","+rgb.g+","+rgb.b+","+1+")";if(CUI.util.color.isSameColor(shade,this.$hiddenInput.val()))cssClass="is-selected";else cssClass="";html+=
"\x3ctd class\x3d'filled'\x3e\x3ca style\x3d'background-color:"+shade+"' color\x3d'"+shade+"' colorName\x3d'"+this.colorNames[i*this.colorShadeNo+sh]+"' class\x3d'"+cssClass+"'\x3e"+"\x3c/a\x3e\x3c/td\x3e"}html+="\x3c/tr\x3e"}table.append("\x3ctbody\x3e"+html+"\x3c/tbody\x3e");table.find("a").off("click.a").on("click.a",function(event){event.stopPropagation();event.preventDefault();if(CUI.util.color.isSameColor(this.$hiddenInput.val(),$(event.target).attr("color")))return;var previousSelected=this.$element.find("table").find(".is-selected");
previousSelected.removeClass("is-selected");previousSelected.find("i").remove();var selected=$(event.target);selected.addClass("is-selected");selected.html('\x3ci class\x3d"coral-Icon coral-Icon--check"\x3e\x3c/i\x3e');$(event.target).addClass("is-selected");var colorName=$(event.target).attr("colorName")!==undefined?$(event.target).attr("colorName"):"";this._fillSelectedColor(colorName,CUI.util.color.RGBAToHex($(event.target).attr("color")));this._setColor($(event.target).attr("color"))}.bind(this));
var $navigator=this.$element.find(".palette-navigator");$navigator.find(".is-active").removeClass("is-active");$navigator.find("i[page\x3d'"+this.currentPage+"']").addClass("is-active");return table},_fillSelectedColor:function(colorName,hexVal){this.$element.find(".colorpicker-holder").find(".selection").html("\x3cdiv\x3e\x3cspan\x3e"+colorName+"\x3c/span\x3e\x3cspan\x3e"+hexVal+"\x3c/span\x3e\x3c/div\x3e")},_renderEditPalette:function(){var table=$("\x3ctable\x3e");var html="\x3ctr\x3e"+"\x3ctd colspan\x3d'2' rowspan\x3d'2' class\x3d'color-field'\x3e"+
"\x3cdiv class\x3d'color'\x3e\x3c/div\x3e"+"\x3c/td\x3e"+"\x3ctd class\x3d'label'\x3eHEX\x3c/td\x3e"+"\x3ctd colspan\x3d'2'\x3e"+"\x3cinput class\x3d'coral-Textfield' type\x3d'text' name\x3d':hex'/\x3e"+"\x3c/td\x3e"+"\x3ctd colspan\x3d'2'\x3e\x26nbsp;\x3c/td\x3e"+"\x3c/tr\x3e"+"\x3ctr\x3e"+"\x3ctd class\x3d'label'\x3eRGB\x3c/td\x3e"+"\x3ctd\x3e"+"\x3cinput class\x3d'coral-Textfield' type\x3d'text' name\x3d':rgb_r'/\x3e"+"\x3c/td\x3e"+"\x3ctd\x3e"+"\x3cinput class\x3d'coral-Textfield' type\x3d'text' name\x3d':rgb_g'/\x3e"+
"\x3c/td\x3e"+"\x3ctd\x3e"+"\x3cinput class\x3d'coral-Textfield' type\x3d'text' name\x3d':rgb_b'/\x3e"+"\x3c/td\x3e"+"\x3ctd\x3e\x26nbsp;\x3c/td\x3e"+"\x3c/tr\x3e"+"\x3ctr\x3e"+"\x3ctd colspan\x3d'2'\x3e\x26nbsp;\x3c/td\x3e"+"\x3ctd class\x3d'label'\x3eCMYK\x3c/td\x3e"+"\x3ctd\x3e"+"\x3cinput class\x3d'coral-Textfield' type\x3d'text' name\x3d':cmyk_c'/\x3e"+"\x3c/td\x3e"+"\x3ctd\x3e"+"\x3cinput class\x3d'coral-Textfield' type\x3d'text' name\x3d':cmyk_m'/\x3e"+"\x3c/td\x3e"+"\x3ctd\x3e"+"\x3cinput class\x3d'coral-Textfield' type\x3d'text' name\x3d':cmyk_y'/"+
"\x3c/td\x3e"+"\x3ctd\x3e"+"\x3cinput class\x3d'coral-Textfield' type\x3d'text' name\x3d':cmyk_k'/\x3e"+"\x3c/td\x3e"+"\x3c/tr\x3e"+"\x3ctr\x3e"+"\x3ctd colspan\x3d'3'\x3e\x26nbsp;\x3c/td\x3e"+"\x3ctd colspan\x3d'4'\x3e"+"\x3cbutton class\x3d'coral-Button coral-Button--primary'\x3eSave Color\x3c/button\x3e"+"\x3c/td\x3e"+"\x3c/tr\x3e";table.append("\x3ctbody\x3e"+html+"\x3c/tbody\x3e");this.$element.find(".palette-header").remove();table.find("input[name^\x3d':rgb_']").each(function(index,element){$(element).attr("maxlength",
"3");$(element).on("blur",function(event){var rgbRegex=/^([0]|[1-9]\d?|[1]\d{2}|2([0-4]\d|5[0-5]))$/;if(!rgbRegex.test($(event.target).val().trim())||$("input:text[value\x3d''][name^\x3d'rgb_']").length>0){$(event.target).val("");this._clearCMYKFields();this.$element.find("input[name\x3d':hex']").val("");this.$element.find("div.color").removeAttr("style");return}var rgb={r:this.$element.find("input[name\x3d':rgb_r']").val(),g:this.$element.find("input[name\x3d':rgb_g']").val(),b:this.$element.find("input[name\x3d':rgb_b']").val()};
var cmyk=CUI.util.color.RGBtoCMYK(rgb);var hex=CUI.util.color.RGBToHex(rgb);this._fillCMYKFields(cmyk);this.$element.find("input[name\x3d':hex']").val(hex);this.$element.find("div.color").css("background",hex)}.bind(this))}.bind(this));table.find("input[name^\x3d':cmyk_']").each(function(index,element){$(element).attr("maxlength","3");$(element).on("blur",function(event){var cmykRegex=/^[1-9]?[0-9]{1}$|^100$/;if(!cmykRegex.test($(event.target).val().trim())||$("input:text[value\x3d''][name^\x3d'cmyk_']").length>
0){$(event.target).val("");this._clearRGBFields();this.$element.find("input[name\x3d':hex']").val("");this.$element.find("div.color").removeAttr("style");return}var cmyk={c:this.$element.find("input[name\x3d':cmyk_c']").val(),m:this.$element.find("input[name\x3d':cmyk_m']").val(),y:this.$element.find("input[name\x3d':cmyk_y']").val(),k:this.$element.find("input[name\x3d':cmyk_k']").val()};var rgb=CUI.util.color.CMYKtoRGB(cmyk);var hex=CUI.util.color.RGBToHex(rgb);this.$element.find("input[name\x3d':hex']").val(hex);
this._fillRGBFields(rgb);this.$element.find("div.color").css("background",hex)}.bind(this))}.bind(this));table.find("input[name\x3d':hex']").each(function(index,element){$(element).attr("maxlength","7");$(element).on("blur",function(event){var hex=CUI.util.color.fixHex($(event.target).val().trim());if(hex.length===0){this._clearRGBFields();this._clearCMYKFields();this.$element.find("div.color").removeAttr("style");return}var rgb=CUI.util.color.HexToRGB(hex);var cmyk=CUI.util.color.RGBtoCMYK(rgb);
this._fillRGBFields(rgb);this._fillCMYKFields(cmyk);table.find("div.color").css("background",hex)}.bind(this))}.bind(this));table.on("click","input, div",function(event){event.stopPropagation();event.preventDefault()});table.on("click","button",function(event){event.stopPropagation();event.preventDefault();if(this.$element.find("input[name\x3d':hex']").val()!==undefined&&this.$element.find("input[name\x3d':hex']").val().length>0)this._setColor(this.$element.find("input[name\x3d':hex']").val())}.bind(this));
return table},_setColor:function(color){this.$hiddenInput.val(color);this.$openButton.css("background-color",this.$hiddenInput.val())},_fillRGBFields:function(rgb){this.$element.find("input[name\x3d':rgb_r']").val(rgb.r);this.$element.find("input[name\x3d':rgb_g']").val(rgb.g);this.$element.find("input[name\x3d':rgb_b']").val(rgb.b)},_clearRGBFields:function(){this.$element.find("input[name^\x3d':rgb']").val("")},_fillCMYKFields:function(cmyk){this.$element.find("input[name\x3d':cmyk_c']").val(cmyk.c);
this.$element.find("input[name\x3d':cmyk_m']").val(cmyk.m);this.$element.find("input[name\x3d':cmyk_y']").val(cmyk.y);this.$element.find("input[name\x3d':cmyk_k']").val(cmyk.k)},_clearCMYKFields:function(){this.$element.find("input[name^\x3d':cmyk']").val("")}});CUI.Widget.registry.register("colorpicker",CUI.Colorpicker);if(CUI.options.dataAPI)$(document).on("cui-contentloaded.data-api",function(e){CUI.Colorpicker.init($("[data-init~\x3dcolorpicker]",e.target))})})(window.jQuery);
(function($){var ns=".coral-DragAction";function getViewContainer(element){while(true){var p=element.parent();if(p.length===0)return p;if(p.is("body"))return p;var flow=p.css("overflow");if(flow==="hidden"||flow==="auto"||flow==="scroll")return p;element=p}}function pagePosition(event){var touch={};if(event.originalEvent){var o=event.originalEvent;if(o.changedTouches&&o.changedTouches.length>0)touch=o.changedTouches[0];if(o.touches&&o.touches.length>0)touch=o.touches[0]}return{x:touch.pageX||event.pageX,
y:touch.pageY||event.pageY}}function within(x,y,element){var offset=element.offset();return x>=offset.left&&x<offset.left+element.outerWidth()&&y>=offset.top&&y<offset.top+element.outerHeight()}CUI.DragAction=new Class({construct:function(event,source,dragElement,dropZones,restrictAxis){this.sourceElement=source;this.dragElement=dragElement;this.container=getViewContainer(dragElement);this.containerHeight=this.container.get(0).scrollHeight;this.dropZones=dropZones;this.axis=restrictAxis;this.scrollZone=
20;this.dragStart(event)},currentDragOver:null,dragStart:function(event){event.preventDefault();var p=this.dragElement.position();var pp=pagePosition(event);this.dragElement.css({"left":p.left,"top":p.top,"width":this.dragElement.width()+"px"}).addClass("is-dragging");this.dragStart={x:pp.x-p.left,y:pp.y-p.top};$(document).on("touchmove"+ns+" mousemove"+ns,this.drag.bind(this));$(document).on("touchend"+ns+" mouseup"+ns,this.dragEnd.bind(this));this.sourceElement.trigger(this._createEvent("dragstart",
event));this.drag(event)},drag:function(event){event.preventDefault();var pos=pagePosition(event);if(this.container.is("body")){if(pos.y-this.container.scrollTop()<this.scrollZone)this.container.scrollTop(pos.y-this.scrollZone);if(pos.y-this.container.scrollTop()>this.container.height()-this.scrollZone)this.container.scrollTop(pos.y-this.container.height()-this.scrollZone)}else{var oldTop=this.container.scrollTop();var t=this.container.offset().top+this.scrollZone;if(pos.y<t)this.container.scrollTop(this.container.scrollTop()-
(t-pos.y));var h=this.container.offset().top+this.container.height()-this.scrollZone;if(pos.y>h){var s=Math.min(this.container.scrollTop()+(pos.y-h),Math.max(this.containerHeight-this.container.height(),0));this.container.scrollTop(s)}var newTop=this.container.scrollTop();this.dragStart.y+=oldTop-newTop}var newCss={};if(this.axis!=="horizontal")newCss.top=pos.y-this.dragStart.y;if(this.axis!=="vertical")newCss.left=pos.x-this.dragStart.x;this.dragElement.css(newCss);this.triggerDrag(event)},dragEnd:function(event){event.preventDefault();
this.dragElement.removeClass("is-dragging");this.dragElement.css({top:"",left:"",width:""});$(document).off(ns);this.triggerDrop(event);if(this.currentDragOver)$(this.currentDragOver).trigger(this._createEvent("dragleave",event));this.sourceElement.trigger(this._createEvent("dragend",event))},triggerDrag:function(event){var dropElement=this._getCurrentDropZone(event);if(dropElement===this.currentDragOver){if(this.currentDragOver)$(this.currentDragOver).trigger(this._createEvent("dragover",event));
return}if(this.currentDragOver)$(this.currentDragOver).trigger(this._createEvent("dragleave",event));this.currentDragOver=dropElement;if(this.currentDragOver)$(this.currentDragOver).trigger(this._createEvent("dragenter",event))},triggerDrop:function(event){var dropElement=this._getCurrentDropZone(event);if(!dropElement)return;dropElement.trigger(this._createEvent("drop",event))},_getCurrentDropZone:function(event){var pos=pagePosition(event);var dropElement=null;$.each(this.dropZones,function(index,
value){if(within(pos.x,pos.y,value)){dropElement=value;return false}});return dropElement},_createEvent:function(name,fromEvent){var pos=pagePosition(fromEvent);var event=jQuery.Event(name);event.pageX=pos.x;event.pageY=pos.y;event.sourceElement=this.sourceElement;event.item=this.dragElement;return event}})})(jQuery);
(function($,console){var addButton='\x3cbutton type\x3d"button" class\x3d"js-coral-Multifield-add coral-Multifield-add coral-Button"\x3e'+"Add field"+"\x3c/button\x3e";var removeButton='\x3cbutton type\x3d"button" class\x3d"js-coral-Multifield-remove coral-Multifield-remove coral-Button coral-Button--square coral-Button--quiet"\x3e'+'\x3ci class\x3d"coral-Icon coral-Icon--sizeS coral-Icon--delete coral-Button-icon"\x3e\x3c/i\x3e'+"\x3c/button\x3e";var moveButton='\x3cbutton type\x3d"button" class\x3d"js-coral-Multifield-move coral-Multifield-move coral-Button coral-Button--square coral-Button--quiet"\x3e'+
'\x3ci class\x3d"coral-Icon coral-Icon--sizeS coral-Icon--moveUpDown coral-Button-icon"\x3e\x3c/i\x3e'+"\x3c/button\x3e";var listTemplate='\x3col class\x3d"js-coral-Multifield-list coral-Multifield-list"\x3e\x3c/ol\x3e';var fieldTemplate='\x3cli class\x3d"js-coral-Multifield-input coral-Multifield-input"\x3e'+'\x3cdiv class\x3d"js-coral-Multifield-placeholder"\x3e\x3c/div\x3e'+removeButton+moveButton+"\x3c/li\x3e";CUI.Multifield=new Class({toString:"Multifield",extend:CUI.Widget,construct:function(options){this.script=
this.$element.find(".js-coral-Multifield-input-template");this.ol=this.$element.children(".js-coral-Multifield-list");if(this.ol.length===0)this.ol=$(listTemplate).prependTo(this.$element);this._adjustMarkup();this._addListeners()},_adjustMarkup:function(){this.$element.addClass("coral-Multifield");this.ol.children(".js-coral-Multifield-input").append(removeButton,moveButton);this.ol.after(addButton)},_addListeners:function(){var self=this;this.$element.on("click",".js-coral-Multifield-add",function(e){var item=
$(fieldTemplate);item.find(".js-coral-Multifield-placeholder").replaceWith(self.script.html().trim());item.appendTo(self.ol);$(self.ol).trigger("cui-contentloaded")});this.$element.on("click",".js-coral-Multifield-remove",function(e){$(this).closest(".js-coral-Multifield-input").remove()});this.$element.on("taphold mousedown",".js-coral-Multifield-move",function(e){e.preventDefault();var item=$(this).closest(".js-coral-Multifield-input");item.prevAll().addClass("coral-Multifield-input--dragBefore");
item.nextAll().addClass("coral-Multifield-input--dragAfter");self.ol.css({height:self.ol.height()+$(e.item).height()+"px"});new CUI.DragAction(e,self.$element,item,[self.ol],"vertical")}).on("dragenter",function(e){self.ol.addClass("drag-over");self._reorderPreview(e)}).on("dragover",function(e){self._reorderPreview(e)}).on("dragleave",function(e){self.ol.removeClass("drag-over").children().removeClass("coral-Multifield-input--dragBefore coral-Multifield-input--dragAfter")}).on("drop",function(e){self._reorder($(e.item));
self.ol.children().removeClass("coral-Multifield-input--dragBefore coral-Multifield-input--dragAfter")}).on("dragend",function(e){self.ol.css({height:""})})},_reorder:function(item){var before=this.ol.children(".coral-Multifield-input--dragAfter").first();var after=this.ol.children(".coral-Multifield-input--dragBefore").last();if(before.length>0)item.insertBefore(before);if(after.length>0)item.insertAfter(after)},_reorderPreview:function(e){this.ol.children(":not(.is-dragging)").each(function(){var el=
$(this);var isAfter=e.pageY<el.offset().top+el.outerHeight()/2;el.toggleClass("coral-Multifield-input--dragAfter",isAfter);el.toggleClass("coral-Multifield-input--dragBefore",!isAfter)})}});CUI.Widget.registry.register("multifield",CUI.Multifield);if(CUI.options.dataAPI)$(document).on("cui-contentloaded.data-api",function(e){CUI.Multifield.init($("[data-init~\x3dmultifield]",e.target))})})(jQuery,window.console);
(function(window,$,undefined){var $event=$.event,resizeTimeout;$event.special.smartresize={setup:function(){$(this).bind("resize",$event.special.smartresize.handler)},teardown:function(){$(this).unbind("resize",$event.special.smartresize.handler)},handler:function(event,execAsap){var context=this,args=arguments;event.type="smartresize";if(resizeTimeout)clearTimeout(resizeTimeout);resizeTimeout=setTimeout(function(){$event.dispatch.apply(context,args)},execAsap==="execAsap"?0:10)}};$.fn.smartresize=
function(fn){return fn?this.bind("smartresize",fn):this.trigger("smartresize",["execAsap"])};$.CUIGridLayout=function(options,element,callback){this.element=$(element);this._create(options);this._init(callback)};var $window=$(window);$.CUIGridLayout.settings={colWidth:240,gutterX:15,gutterY:15,marginLeft:0,marginRight:0,selector:"article"};$.CUIGridLayout.prototype={option:function(options){this.options=$.extend({},$.CUIGridLayout.settings,options)},_create:function(options){this.options=$.extend({},
$.CUIGridLayout.settings,options);this.items=[];this.itemsByPath={};this.numCols=-1;this.pendingImages=0;this.update();var self=this;$window.bind("smartresize.cui.gridlayout",function(){self.updateDimensions();self.layout()})},_init:function(callback){this.updateDimensions();this.layout(callback);setTimeout(function(){this.numCols=-1;this.updateDimensions();this.layout(callback);this.element.trigger($.Event("cui-gridlayout-initialized",{"widget":this}))}.bind(this),1)},update:function(){var items=
[],itemsByPath={};this.element.find(this.options.selector).each(function(i){var $card=$(this);var $img=$("img",$card);if($img.length===0)$img=null;var item={path:$card.data().path,i:i,$el:$card,$img:$img};items.push(item);itemsByPath[item.path]=item});this.items=items.sort(function(i1,i2){var i1key=i1.$el.data("gridlayout-sortkey")||0,i2key=i2.$el.data("gridlayout-sortkey")||0;return i2key-i1key||i1.i-i2.i});this.itemsByPath=itemsByPath},_imageLoaded:function(){if(--this.pendingImages===0){this.numCols=
-1;this.layout()}},updateDimensions:function(){var self=this;this.items.every(function(i){var $el=i.$el;i.w=$el.width();i.h=$el.height();if(i.$img){if(i.$img.width()>i.w)i.h=i.h-i.$img.height()+i.$img.height()/i.$img.width()*i.w;if(i.$img.height()===0){i.h+=i.w;self.pendingImages++;i.$img.on("load.cui.gridlayout",function(){i.$img=null;i.w=$el.width();i.h=$el.height();self._imageLoaded()})}else i.$img=null}return true})},layout:function(){var self=this;var $this=this.element;var colWidth=this.options.colWidth;
var marginLeft=this.options.marginLeft;var marginRight=this.options.marginRight;var gx=this.options.gutterX;if($this.width()===0)return;var n=Math.floor(($this.width()-marginLeft-marginRight+gx)/(colWidth+gx));if(n<1)n=1;if(n==this.numCols)return;this.numCols=n;var cw=($this.width()-marginLeft-marginRight+gx)/n-gx;var cols=[];var colHeights=[];while(cols.length<n){cols.push([]);colHeights.push(0)}this.items.every(function(i){var height=i.h/i.w*cw;var min=colHeights[0];var best=0;for(var c=0;c<colHeights.length;c++){var h=
colHeights[c];if(h<min){min=h;best=c}}cols[best].push(i);colHeights[best]+=height+self.options.gutterY;return true});$this.detach(this.options.selector);var $cols=$this.contents();for(var c=0;c<cols.length;c++){var $col=$('\x3cdiv class\x3d"grid-'+n+'"\x3e\x3c/div\x3e').appendTo($this);for(var j=0;j<cols[c].length;j++)$col.append(cols[c][j].$el)}$cols.remove();$(document).trigger("cui-gridlayout-layout")},destroy:function(){$window.unbind("smartresize.cui.gridlayout");this.element.removeData("cuigridlayout")}};
var logError=function(message){if(window.console)window.console.error(message)};$.fn.cuigridlayout=function(options,callback){if(typeof options==="string"){var args=Array.prototype.slice.call(arguments,1);this.each(function(){var instance=$.data(this,"cuigridlayout");if(!instance){logError("cannot call methods on cuigridlayout prior to initialization; "+"attempted to call method '"+options+"'");return}if(!$.isFunction(instance[options])||options.charAt(0)==="_"){logError("no such method '"+options+
"' for cuigridlayout instance");return}instance[options].apply(instance,args)})}else this.each(function(){var instance=$.data(this,"cuigridlayout");if(instance){instance.option(options);instance._init(callback)}else $.data(this,"cuigridlayout",new $.CUIGridLayout(options,this,callback))});return this}})(window,jQuery);
(function($,window,undefined){var defaults={"threshold":200,"applyClassToElement":undefined};var size={"rem":function(){if(size._rem===undefined)size._rem=parseInt($("body").css("font-size"));return size._rem},"em":function(elem){return parseFloat(elem.css("font-size"))}};$.fn.reflow=function reflow(breakpoints,options){return this.each(function reflowEach(){var elem=$(this),didApplyClassNames=false,scheduledReflowCheck=false,settings;if(breakpoints){var applyClassNames=function(){didApplyClassNames=
true;for(var className in breakpoints)settings.applyClassToElement.toggleClass(className,breakpoints[className](elem,size))};var reflowEventHandler=function(){if(elem.is(":visible"))if(!scheduledReflowCheck){applyClassNames();scheduledReflowCheck=setTimeout(function reflowCheck(){scheduledReflowCheck=false;if(!didApplyClassNames&&elem.is(":visible"))applyClassNames()},settings.threshold)}else didApplyClassNames=false};settings=$.extend({},defaults,options);settings.applyClassToElement=settings.applyClassToElement||
elem;elem.on("reflow",reflowEventHandler);$(window).on("resize.reflow",reflowEventHandler)}elem.trigger("reflow")})}})(jQuery,this);
(function($,window,undefined){var storageKey="cui-state",storageLoadEvent="cui-state-restore",store={},loaded=false,$doc=$(document);CUI.util.state={config:{serverpersistence:true},save:function(selector,attribute,autorestore,customEvent){var elem=$(selector),saveLoop=function(i,attr){store.global[selector]=store.global[selector]||{};store.global[selector][attr]=store.global[selector][attr]||{};store.global[selector][attr].val=elem.attr(attr);store.global[selector][attr].autorestore=autorestore||
false;store.global[selector][attr].customEvent=customEvent||null};if(attribute)if($.isArray(attribute))$.each(attribute,saveLoop);else saveLoop(0,attribute);else;localStorage.setItem(storageKey,JSON.stringify(store));if(CUI.util.state.config.serverpersistence)$.cookie(storageKey,JSON.stringify(store),{expires:7,path:"/"})},restore:function(selector,filter){var check=filter||function(){return true},sel,elem,selectorLoop=function(item,noop){sel=item;elem=$(sel);if(store.global[sel])$.each(store.global[sel],
restoreLoop)},restoreLoop=function(attr,obj){if(check(sel,attr,obj)){elem.attr(attr,obj.val);if(obj.customEvent)$doc.trigger(obj.customEvent,[elem,obj]);$doc.trigger(storageLoadEvent,[elem,obj])}};if(!loaded)loaded=CUI.util.state.load();if(selector)selectorLoop(selector);else $.each(store.global,selectorLoop)},load:function(){var val=localStorage.getItem(storageKey);store=val?JSON.parse(val):{global:{}};return true},setSessionItem:function(name,value,ns){var key=name;if(ns)key=name+":"+ns;sessionStorage.setItem(key,
JSON.stringify(value))},getSessionItem:function(name,ns){var key=name;if(ns)key=name+":"+ns;var value=sessionStorage.getItem(key);if(value)value=JSON.parse(value);return value},removeSessionItem:function(name,ns){var key=name;if(ns)key=name+":"+ns;sessionStorage.removeItem(key)},clearSessionItems:function(ns){if(ns){ns=":"+ns;var keyCnt=sessionStorage.length;var toRemove=[];for(var k=0;k<keyCnt;k++){var keyToCheck=sessionStorage.key(k);var keyLen=keyToCheck.length;if(keyLen>ns.length)if(keyToCheck.substring(keyLen-
ns.length)===ns)toRemove.push(keyToCheck)}var removeCnt=toRemove.length;for(var r=0;r<removeCnt;r++)sessionStorage.removeItem(toRemove[r])}}};$doc.ready(function(){CUI.util.state.restore(null,function(selector,attr,val){if(val.autorestore)return true;return false})})})(jQuery,this);
(function($){var DISPLAY_GRID="grid";var DISPLAY_LIST="list";var SELECTION_MODE_COUNT_SINGLE="single";var SELECTION_MODE_COUNT_MULTI="multiple";var DEFAULT_SELECTOR_CONFIG={"itemSelector":"article","headerSelector":"header","dataContainer":"grid-0","enableImageMultiply":true,"view":{"selectedItem":{"list":{"cls":"selected","prv":"selected-prev"},"grid":{"cls":"selected","prv":"selected-prev"}},"selectedItems":{"list":{"selector":"article.selected"},"grid":{"selector":"article.selected"}}},"controller":{"selectElement":{"list":"article \x3e i.select",
"grid":"article"},"moveHandleElement":{"list":"article \x3e i.move"},"targetToItem":{"list":function($target){return $target.closest("article")},"grid":function($target){return $target.closest("article")},"header":function($target){return $target.closest("header")}},"gridSelect":{"cls":"selection-mode"},"selectAll":{"selector":"header \x3e i.select","cls":"selected"},"sort":{"columnSelector":".label \x3e *"}}};var ensureItem=function(item){if(item.jquery)return item.data("cardView-item");return item};
var Utils={equals:function($1,$2){return $1.length===$2.length&&$1.length===$1.filter($2).length},getWidget:function($el){var widget;if($el.length>0)widget=$($el[0]).data("cardView");return widget},mixObjects:function(object1,object2){if(object1===undefined)return object2;var result={};for(var i in object2){if(object1[i]===undefined){result[i]=object2[i];continue}var p=object1[i];if(typeof object1[i]=="object"&&!(object1[i]instanceof String))p=this.mixObjects(object1[i],object2[i]);result[i]=p}return result},
resolve:function($el,fn){var resolved=[];$el.each(function(){resolved.push.apply(resolved,fn($(this)).toArray())});return $(resolved)},multiplyImages:function($images,color){$images=$images.filter(function(){var $image=$(this);return!$image.is(".multiplied")&&!$image.prev().is(".multiplied")&&$image.is(":visible")});var imageMaxCounter=$images.length;var imageIteratorCounter=0;function multiplyNextImage(){if(imageIteratorCounter<imageMaxCounter){multiplyOneImage($images[imageIteratorCounter]);imageIteratorCounter++;
setTimeout(multiplyNextImage,0)}}function multiplyOneImage(image){var width=image.naturalWidth,height=image.naturalHeight;if(width===0&&height===0){window.setTimeout(function(){multiplyOneImage(image)},200);return}try{var canvas=$("\x3ccanvas width\x3d'"+width+"' height\x3d'"+height+"'\x3e\x3c/canvas\x3e")[0];var context=canvas.getContext("2d");context.drawImage(image,0,0,width,height);var imageData=context.getImageData(0,0,width,height);var data=imageData.data;for(var i=0,l=data.length;i<l;i+=4){data[i]*=
color[0];data[i+1]*=color[1];data[i+2]*=color[2]}context.putImageData(imageData,0,0);$("\x3cimg class\x3d'"+image.className+" multiplied' "+"width\x3d'"+image.width+"' "+"src\x3d'"+canvas.toDataURL("image/png")+"'/\x3e").insertBefore(image)}catch(err){}}multiplyNextImage()}};var ListItemAutoScroller=new Class({$el:null,$containerEl:null,stepSize:0,iid:undefined,autoMoveOffset:0,maxScrollTop:0,construct:function($el,stepSize,autoMoveFn){this.$el=$el;this.stepSize=stepSize;this.$containerEl=this._getScrollingContainer($el);
var cont=this.$containerEl[0];this.maxScrollTop=Math.max(cont.scrollHeight-cont.clientHeight,0);this.autoMoveFn=autoMoveFn},_getScrollingContainer:function($el){while($el.length>0&&!$el.is("body")){var ovflY=$el.css("overflowY");var pos=$el.css("position");if((ovflY==="auto"||ovflY==="visible")&&pos==="absolute")return $el;$el=$el.parent()}return $(window)},_execute:function(){var cont=this.$containerEl[0];var clientHeight=cont.clientHeight;var scrollTop=cont.scrollTop;var offsetTop=$.isWindow(cont)?
0:this.$containerEl.offset().top;var itemTop=this.$el.offset().top-offsetTop;var itemBottom=itemTop+this.$el.height();var isAutoScroll=false;if(itemTop<=0){if(scrollTop>0){scrollTop-=this.stepSize;this.autoMoveOffset=-this.stepSize;if(scrollTop<0)scrollTop=0;cont.scrollTop=scrollTop;isAutoScroll=true}}else if(itemBottom>=clientHeight)if(scrollTop<this.maxScrollTop){scrollTop+=this.stepSize;this.autoMoveOffset=this.stepSize;if(scrollTop>this.maxScrollTop)scrollTop=this.maxScrollTop;cont.scrollTop=
scrollTop;isAutoScroll=true}return isAutoScroll},_autoMove:function(){if(this.autoMoveOffset&&this.autoMoveFn){var itemOffs=this.$el.offset();var itemTop=itemOffs.top+this.autoMoveOffset;this.autoMoveFn(itemOffs.left,itemTop)}},check:function(){var self=this;this.stop();var isAutoScroll=this._execute();if(isAutoScroll)this.iid=window.setTimeout(function(){self.iid=undefined;self._autoMove()},50)},stop:function(){if(this.iid!==undefined){window.clearTimeout(this.iid);this.autoMoveOffset=0;this.iid=
undefined}}});var ListItemMoveHandler=new Class({$listEl:null,$itemEl:null,$items:null,$doc:null,$oldBefore:null,dragCls:null,fixHorizontalPosition:false,autoScroller:null,construct:function(config){var self=this;this.$listEl=config.$listEl;this.$itemEl=config.$itemEl;this.$items=config.$items;this.dragCls=config.dragCls;this.fixHorizontalPosition=config.fixHorizontalPosition!==false;this.autoScroller=config.autoScrolling?new ListItemAutoScroller(this.$itemEl,8,function(x,y){self._autoMove(x,y)}):
undefined},_getEventCoords:function(e){if(!e.originalEvent.touches)return{x:e.pageX,y:e.pageY};return e.originalEvent.touches.length>0?{x:e.originalEvent.touches[0].pageX,y:e.originalEvent.touches[0].pageY}:e.originalEvent.changedTouches.length>0?{x:e.originalEvent.changedTouches[0].pageX,y:e.originalEvent.changedTouches[0].pageY}:{x:e.pageX,y:e.pageY}},_limit:function(top,left){if(left<this.listOffset.left)left=this.listOffset.left;if(top<this.listOffset.top)top=this.listOffset.top;var right=left+
this.size.width;var bottom=top+this.size.height;var limitRight=this.listOffset.left+this.listSize.width;var limitBottom=this.listOffset-top+this.listSize.height;if(right>limitRight)left=limitRight-this.size.width;if(bottom>limitBottom)top=limitBottom-this.size.height;if(this.fixHorizontalPosition)left=this.listOffset.left;return{"top":top,"left":left}},_getEventPos:function(e){var evtPos=this._getEventCoords(e);return{x:evtPos.x-this.delta.left,y:evtPos.y-this.delta.top}},_adjustPosition:function(x,
y){this.$itemEl.offset(this._limit(y,x));if(this.autoScroller)this.autoScroller.check()},_changeOrderIfRequired:function(){var itemPos=this.$itemEl.offset();var hotX=itemPos.left+this.size.width/2;var hotY=itemPos.top+this.size.height/2;var $newTarget=null;var isInsertBefore=false;for(var i=0;i<this.$items.length;i++){var $item=$(this.$items[i]);if(!Utils.equals($item,this.$itemEl)){var offs=$item.offset();var width=$item.width();var height=$item.height();var bottom=offs.top+height;if(hotX>=offs.left&&
hotX<offs.left+width&&hotY>=offs.top&&hotY<bottom){isInsertBefore=hotY-offs.top>bottom-hotY;$newTarget=$item;break}}}if($newTarget){var _offs=this.$itemEl.offset();if(isInsertBefore)$newTarget.before(this.$itemEl);else $newTarget.after(this.$itemEl);this.$itemEl.offset(_offs)}},_autoMove:function(x,y){this._adjustPosition(x,y);this._changeOrderIfRequired()},start:function(e){this.$oldPrev=this.$itemEl.prev();this.$oldNext=this.$itemEl.next();var evtPos=this._getEventCoords(e);if(this.dragCls)this.$itemEl.addClass(this.dragCls);
var self=this;this.$doc=$(document);this.$doc.on("touchmove.listview.drag mousemove.listview.drag",function(e){self.move(e)});this.$doc.on("touchend.listview.drag mouseup.listview.drag",function(e){self.end(e)});this.offset=this.$itemEl.offset();this.delta={"left":evtPos.x-this.offset.left,"top":evtPos.y-this.offset.top};this.size={"width":this.$itemEl.width(),"height":this.$itemEl.height()};this.listOffset=this.$listEl.offset();this.listSize={"width":this.$listEl.width(),"height":this.$listEl.height()};
e.stopPropagation();e.preventDefault()},move:function(e){var pos=this._getEventPos(e);this._adjustPosition(pos.x,pos.y);this._changeOrderIfRequired();e.stopPropagation();e.preventDefault()},end:function(e){var pos=this._getEventPos(e);this._adjustPosition(pos.x,pos.y);if(this.dragCls)this.$itemEl.removeClass(this.dragCls);if(this.autoScroller)this.autoScroller.stop();this.$itemEl.css("position","");this.$itemEl.css("top","");this.$itemEl.css("left","");this.$doc.off("touchmove.listview.drag");this.$doc.off("mousemove.listview.drag");
this.$doc.off("touchend.listview.drag");this.$doc.off("mouseup.listview.drag");var $newPrev=this.$itemEl.prev();var $newNext=this.$itemEl.next();this.$itemEl.trigger($.Event("item-moved",{newPrev:$newPrev,newNext:$newNext,oldPrev:this.$oldPrev,oldNext:this.$oldNext,hasMoved:!Utils.equals($newPrev,this.$oldPrev)}));e.stopPropagation();e.preventDefault()}});var Item=new Class({$itemEl:null,construct:function($itemEl){this.$itemEl=$itemEl;this.reference()},getItemEl:function(){return this.$itemEl},reference:function(){this.$itemEl.data("cardView-item",
this)}});var Header=new Class({$headerEl:null,itemRef:null,construct:function($headerEl,itemRef){this.$headerEl=$headerEl;this.itemRef=itemRef},getHeaderEl:function(){return this.$headerEl},getItemRef:function(){return this.itemRef},setItemRef:function(itemRef){this.itemRef=itemRef}});var ColumnSortHandler=new Class({construct:function(options){this.model=options.model;this.comparators=options.comparators;this.selectors=options.selectors;this.columnElement=options.columnElement;this.headerElement=
options.columnElement.closest(this.selectors.headerSelector);var header=this.model.getHeaderForEl(this.headerElement);this.items=this.model.getItemsForHeader(header);this.isReverse=this.columnElement.hasClass("sort-asc");this.toNatural=this.columnElement.hasClass("sort-desc");this.fromNatural=!this.headerElement.hasClass("sort-mode");this.comparator=null;if(this.comparators)for(var selector in this.comparators){if(!this.columnElement.is(selector))continue;this.comparator=this.comparators[selector]}if(!this.comparator)this.comparator=
this._readComparatorFromMarkup()},_readComparatorFromMarkup:function(){var selector=this.columnElement.data("sort-selector");var attribute=this.columnElement.data("sort-attribute");var sortType=this.columnElement.data("sort-type");var ignoreCase=this.columnElement.data("ignorecase");if(!selector&&!attribute)return null;return new CUI.CardView.DefaultComparator(selector,attribute,sortType,ignoreCase)},_adjustMarkup:function(){if(this.fromNatural)this.headerElement.addClass("sort-mode");if(this.toNatural)this.headerElement.removeClass("sort-mode");
this.headerElement.find(this.selectors.controller.sort.columnSelector).removeClass("sort-asc sort-desc");this.columnElement.removeClass("sort-desc sort-asc");if(!this.toNatural)this.columnElement.addClass(this.isReverse?"sort-desc":"sort-asc");var showMoveHandle=this.toNatural;$.each(this.items,function(){this.getItemEl().find(".move").toggle(showMoveHandle)})},sort:function(){if(!this.comparator&&!this.toNatural)return;this._adjustMarkup();var items=this.items.slice();if(this.comparator){this.comparator.setReverse(this.isReverse);
var fn=this.comparator.getCompareFn();if(!this.toNatural)items.sort(fn)}var prevItem=this.headerElement;$.each(this.items,function(){this.getItemEl().detach()});for(var i=0;i<items.length;i++){var item=items[i].getItemEl();prevItem.after(item);prevItem=item}}});var DirectMarkupModel=new Class({$el:null,items:null,headers:null,selectors:null,construct:function($el,selectors){this.$el=$el;this.items=[];this.selectors=selectors;var $items=this.$el.find(selectors.itemSelector);var itemCnt=$items.length;
for(var i=0;i<itemCnt;i++)this.items.push(new Item($($items[i])));this.headers=[];var $headers=this.$el.find(selectors.headerSelector);var headerCnt=$headers.length;for(var h=0;h<headerCnt;h++){var $header=$($headers[h]);var $itemRef=$header.nextAll(selectors.itemSelector);var itemRef=$itemRef.length>0?this.getItemForEl($($itemRef[0])):undefined;this.headers.push(new Header($header,itemRef))}},initialize:function(){var self=this;this.$el.on("item-moved",this.selectors.itemSelector,function(e){if(e.hasMoved)self._reorder(e)})},
_reorder:function(e){var itemToMove=this.getItemForEl($(e.target));var newBefore=this.getItemForEl(e.newPrev);var isHeaderInsert=false;var header;if(!newBefore){header=this.getHeaderForEl(e.newPrev);if(header){isHeaderInsert=true;var refPos=this.getItemIndex(header.getItemRef());if(refPos>0)newBefore=this.getItemAt(refPos-1)}}var oldPos=this.getItemIndex(itemToMove);this.items.splice(oldPos,1);var headerRef=this._getHeaderByItemRef(itemToMove);if(headerRef)headerRef.setItemRef(this.getItemAt(oldPos));
var insertPos=newBefore?this.getItemIndex(newBefore)+1:0;this.items.splice(insertPos,0,itemToMove);if(isHeaderInsert)header.setItemRef(itemToMove)},getItemCount:function(){return this.items.length},getItemAt:function(pos){return this.items[pos]},getItemIndex:function(item){for(var i=0;i<this.items.length;i++)if(item===this.items[i])return i;return-1},getItemForEl:function($el){var itemCnt=this.items.length;for(var i=0;i<itemCnt;i++){var item=this.items[i];if(Utils.equals(item.getItemEl(),$el))return item}return undefined},
insertItemAt:function($items,pos,beforeHeader){if(!$.isArray($items))$items=$items.toArray();for(var i=$items.length-1;i>=0;i--){var $item=$items[i];if(!$item.jquery)$item=$($item);var followupItem;var item=new Item($item);if(pos===undefined||pos===null){this.items.push(item);pos=this.items.length-1}else{followupItem=this.items[pos];this.items.splice(pos,0,item)}var insert={"item":followupItem,"mode":"item"};var headerCnt=this.headers.length;for(var h=0;h<headerCnt;h++){var header=this.headers[h];
if(header.getItemRef()===followupItem)if(beforeHeader){insert={"item":header,"mode":"header"};break}else header.setItemRef(item)}this.$el.trigger($.Event("change:insertitem",{"insertPoint":insert,"followupItem":followupItem,"item":item,"pos":pos,"widget":Utils.getWidget(this.$el),"moreItems":i>0}))}},getHeaderCount:function(){return this.headers.length},getHeaderAt:function(pos){return this.headers[pos]},getHeaders:function(){var headers=[];headers.push.apply(headers,this.headers);return headers},
getHeaderForEl:function($el){var headerCnt=this.headers.length;for(var h=0;h<headerCnt;h++){var header=this.headers[h];if(Utils.equals(header.getHeaderEl(),$el))return header}return undefined},_getHeaderByItemRef:function(itemRef){for(var h=0;h<this.headers.length;h++)if(this.headers[h].getItemRef()===itemRef)return this.headers[h];return undefined},getItemsForHeader:function(header){var itemRef=header.getItemRef();var headerCnt=this.headers.length;var itemCnt=this.items.length;var itemsForHeader=
[];var isInRange=false;for(var i=0;i<itemCnt;i++){var item=this.items[i];if(isInRange){for(var h=0;h<headerCnt;h++)if(this.headers[h].getItemRef()===item){isInRange=false;break}if(isInRange)itemsForHeader.push(item);else break}else if(item===itemRef){isInRange=true;itemsForHeader.push(itemRef)}}return itemsForHeader},fromItemElements:function($elements){var items=[];$elements.each(function(){var item=$(this).data("cardView-item");if(item)items.push(item)});return items},reference:function(){var itemCnt=
this.items.length;for(var i=0;i<itemCnt;i++)this.items[i].reference()},removeAllItemsSilently:function(){this.items.length=0;for(var h=0;h<this.headers.length;h++)this.headers[h].setItemRef(undefined)}});var DirectMarkupView=new Class({$el:null,selectors:null,construct:function($el,selectors){this.$el=$el;this.selectors=selectors},initialize:function(){var self=this;this.$el.on("change:displayMode",function(e){var oldMode=e.oldValue;var newMode=e.value;self.cleanupAfterDisplayMode(oldMode);self.prepareDisplayMode(newMode)});
this.$el.on("change:insertitem",function(e){self._onItemInserted(e)});this.$el.reflow({"small":function($el,size){return $el.width()>40*size.rem()&&$el.width()<50*size.rem()},"xsmall":function($el,size){return $el.width()>30*size.rem()&&$el.width()<40*size.rem()},"xxsmall":function($el,size){return $el.width()<30*size.rem()}})},_onItemInserted:function(e){var $dataRoot=this.$el;if(this.selectors.dataContainer)$dataRoot=$dataRoot.find("."+this.selectors.dataContainer);var $item=e.item.getItemEl();
var followupItem=e.followupItem;switch(this.getDisplayMode()){case DISPLAY_LIST:if(!followupItem)$dataRoot.append($item);else{var insert=e.insertPoint;var item=insert.item;var $ref=insert.mode==="item"?item.getItemEl():item.getHeaderEl();$ref.before($item)}break;case DISPLAY_GRID:if(!e.moreItems){var widget=Utils.getWidget(this.$el);widget._restore();widget.layout()}break}},getDisplayMode:function(){return Utils.getWidget(this.$el).getDisplayMode()},setSelectionState:function(item,selectionState){var displayMode=
this.getDisplayMode();var selectorDef=this.selectors.view.selectedItem[displayMode];var $itemEl=item.getItemEl();if(selectorDef.selector)$itemEl=$itemEl.find(selectorDef.selector);if(selectionState==="selected"){$itemEl.addClass(selectorDef.cls).prev().addClass(selectorDef.prv);if(displayMode===DISPLAY_GRID)this._drawSelectedGrid(item)}else if(selectionState==="unselected")$itemEl.removeClass(selectorDef.cls).prev().removeClass(selectorDef.prv)},getSelectionState:function(item){var selectorDef=this.selectors.view.selectedItem[this.getDisplayMode()];
var $itemEl=item.getItemEl();if(selectorDef.selector)$itemEl=$itemEl.find(selectorDef.selector);var cls=selectorDef.cls.split(" ");for(var c=0;c<cls.length;c++)if(!$itemEl.hasClass(cls[c]))return"unselected";return"selected"},getSelectedItems:function(){var selectorDef=this.selectors.view.selectedItems[this.getDisplayMode()];var $selectedItems=this.$el.find(selectorDef.selector);if(selectorDef.resolver)$selectedItems=selectorDef.resolver($selectedItems);return $selectedItems},restore:function(model,
restoreHeaders){var $container=$("\x3cdiv class\x3d'"+this.selectors.dataContainer+"'\x3e");this.$el.empty();this.$el.append($container);var itemCnt=model.getItemCount();for(var i=0;i<itemCnt;i++)$container.append(model.getItemAt(i).getItemEl());if(restoreHeaders){var headerCnt=model.getHeaderCount();for(var h=0;h<headerCnt;h++){var header=model.getHeaderAt(h);var $headerEl=header.getHeaderEl();var itemRef=header.getItemRef();if(itemRef)itemRef.getItemEl().before($headerEl);else $container.append($headerEl)}}},
prepareDisplayMode:function(displayMode){if(displayMode===DISPLAY_GRID)this._drawAllSelectedGrid()},cleanupAfterDisplayMode:function(displayMode){},_drawImage:function($image,$item){if($image.length===0)return;if(this._colorFloat===undefined){var color256=$image.closest("a, .card",$item[0]).css("background-color");if(!color256||color256.indexOf("rgb(")<0)return;this._colorFloat=$.map(color256.match(/(\d+)/g),function(val){return val/255})}Utils.multiplyImages($image,this._colorFloat)},_drawAllSelectedGrid:function(){if(!this.selectors.enableImageMultiply)return;
var self=this;$(this.selectors.view.selectedItems.grid.selector).each(function(){var $item=$(this);var $img=$item.find("img");self._drawImage($img,$item);$img.load(function(){self._drawImage($(this),$item)})})},_drawSelectedGrid:function(item){if(!this.selectors.enableImageMultiply)return;var self=this;var $item=item.getItemEl();var $img=$item.find("img");this._drawImage($img,$item);$img.load(function(){self._drawImage($(this),$item)})},removeAllItemsSilently:function(){this.$el.find(this.selectors.itemSelector).remove()}});
var DirectMarkupController=new Class({$el:null,selectors:null,comparators:null,selectionModeCount:null,construct:function($el,selectors,comparators){this.$el=$el;this.selectors=selectors;this.comparators=comparators;this.selectionModeCount=SELECTION_MODE_COUNT_MULTI},initialize:function(){this.setDisplayMode(this.$el.hasClass("list")?DISPLAY_LIST:DISPLAY_GRID);var self=this;this.$el.on("click.cardview.select",this.selectors.controller.selectElement.list,function(e){var widget=Utils.getWidget(self.$el);
if(widget.getDisplayMode()===DISPLAY_LIST){var item=ensureItem(self.getItemElFromEvent(e));if(widget.toggleSelection(item)){e.stopPropagation();e.preventDefault()}}});this.$el.on("click.cardview.select",this.selectors.controller.selectElement.grid,function(e){var widget=Utils.getWidget(self.$el);if(widget.getDisplayMode()===DISPLAY_GRID&&widget.isGridSelectionMode()){var item=ensureItem(self.getItemElFromEvent(e));if(widget.toggleSelection(item)){e.stopPropagation();e.preventDefault()}}});this.$el.on("click.cardview.selectall",
this.selectors.controller.selectAll.selector,function(e){var widget=Utils.getWidget(self.$el);if(widget.getDisplayMode()===DISPLAY_LIST){var cls=self.selectors.controller.selectAll.cls;var $header=self.selectors.controller.targetToItem.header($(e.target));var header=widget.getModel().getHeaderForEl($header);if($header.hasClass(cls))widget.deselectAll(header);else widget.selectAll(header)}});this.$el.on("click.cardview.sort",this.selectors.headerSelector+" "+this.selectors.controller.sort.columnSelector,
function(e){var widget=Utils.getWidget(self.$el);var model=widget.getModel();var event=$.Event("sortstart");$(e.target).trigger(event);if(event.isDefaultPrevented())return;var sorter=new ColumnSortHandler({model:model,columnElement:$(e.target),comparators:self.comparators,selectors:self.selectors});sorter.sort();event=$.Event("sortend");$(e.target).trigger(event)});this.$el.on("selectstart.cardview",this.selectors.headerSelector+" "+this.selectors.controller.sort.columnSelector,function(e){e.preventDefault()});
this.$el.on("touchstart.cardview.reorder mousedown.cardview.reorder",this.selectors.controller.moveHandleElement.list,function(e){var $itemEl=self.getItemElFromEvent(e);var handler=new ListItemMoveHandler({$listEl:self.$el,$itemEl:$itemEl,$items:$(self.selectors.itemSelector),dragCls:"dragging",autoScrolling:true});handler.start(e)});this.$el.on("change:selection",function(e){if(e.moreSelectionChanges)return;self._adjustSelectAllState(e.widget)});this.$el.on("change:insertitem",function(e){if(e.moreItems)return;
self._adjustSelectAllState(e.widget)})},_adjustSelectAllState:function(widget){var cls=this.selectors.controller.selectAll.cls;var selectionState=widget.getHeaderSelectionState();var headers=selectionState.headers;var headerCnt=headers.length;for(var h=0;h<headerCnt;h++){var header=headers[h];var $header=header.header.getHeaderEl();if(header.hasUnselected)$header.removeClass(cls);else $header.addClass(cls)}},getItemElFromEvent:function(e){var $target=$(e.target);var resolver=this.selectors.controller.targetToItem[this.getDisplayMode()];
if($.isFunction(resolver))return resolver($target);return $target.find(resolver)},isGridSelect:function(){var selectorDef=this.selectors.controller.gridSelect;var $el=this.$el;if(selectorDef.selector)$el=$el.find(selectorDef.selector);return $el.hasClass(selectorDef.cls)},setGridSelect:function(isGridSelect){if(this.isGridSelect()!==isGridSelect){var selectorDef=this.selectors.controller.gridSelect;var $el=this.$el;if(selectorDef.selector)$el=$el.find(selectorDef.selector);if(isGridSelect)$el.addClass(selectorDef.cls);
else{$el.removeClass(selectorDef.cls);Utils.getWidget($el).clearSelection()}this.$el.trigger($.Event("change:gridSelect",{"widget":this.$el.data("cardView"),"oldValue":!isGridSelect,"value":isGridSelect}))}},getDisplayMode:function(){if(this.$el.hasClass("list"))return DISPLAY_LIST;if(this.$el.hasClass("grid"))return DISPLAY_GRID;return null},isColumnSorted:function(){return this.getDisplayMode()=="list"&&this.$el.find(this.selectors.headerSelector).filter(".sort-mode").length>0},setDisplayMode:function(displayMode){var oldValue=
this.getDisplayMode();if(oldValue!==displayMode){var widget=Utils.getWidget(this.$el);widget._restore(displayMode===DISPLAY_LIST);switch(displayMode){case DISPLAY_GRID:this.$el.removeClass("list");this.$el.addClass("grid");if(oldValue!==null){var selection=widget.getSelection();this.setGridSelect(selection.length>0);widget.layout()}break;case DISPLAY_LIST:this.$el.cuigridlayout("destroy");this.$el.removeClass("grid");this.$el.addClass("list");break}this.$el.trigger($.Event("change:displayMode",{"widget":this.$el.data("cardView"),
"oldValue":oldValue,"value":displayMode}))}},getSelectionModeCount:function(){return this.selectionModeCount},setSelectionModeCount:function(modeCount){this.selectionModeCount=modeCount}});var DirectMarkupAdapter=new Class({$el:null,selectors:null,comparators:null,model:null,view:null,controller:null,construct:function(selectors,comparators){this.selectors=selectors;this.comparators=comparators},initialize:function($el){this.$el=$el;this.setModel(new DirectMarkupModel($el,this.selectors));this.setView(new DirectMarkupView($el,
this.selectors));this.setController(new DirectMarkupController($el,this.selectors,this.comparators));this.model.initialize();this.view.initialize();this.controller.initialize()},setModel:function(model){this.model=model},getModel:function(){return this.model},setView:function(view){this.view=view},getView:function(){return this.view},setController:function(controller){this.controller=controller},getController:function(){return this.controller},isSelected:function(item){var selectionState=this.view.getSelectionState(item);
return selectionState==="selected"},setSelected:function(item,isSelected){var selectionState=isSelected?"selected":"unselected";this.view.setSelectionState(item,selectionState)},getSelection:function(useModel){var selection=this.view.getSelectedItems();if(useModel===true)selection=this.model.fromItemElements(selection);return selection},getDisplayMode:function(){return this.controller.getDisplayMode()},isColumnSorted:function(){return this.controller.isColumnSorted()},setDisplayMode:function(selectionMode){this.controller.setDisplayMode(selectionMode)},
isGridSelectionMode:function(){return this.controller.isGridSelect()},setGridSelectionMode:function(isSelectionMode){this.controller.setGridSelect(isSelectionMode)},getSelectionModeCount:function(){return this.controller.getSelectionModeCount()},setSelectionModeCount:function(modeCount){this.controller.setSelectionModeCount(modeCount)},_restore:function(restoreHeaders){this.view.restore(this.model,restoreHeaders);this.model.reference()},removeAllItems:function(){var widget=Utils.getWidget(this.$el);
widget.clearSelection();this.model.removeAllItemsSilently();this.view.removeAllItemsSilently()}});CUI.CardView=new Class({toString:"CardView",extend:CUI.Widget,adapter:null,construct:function(options){var selectorConfig=Utils.mixObjects(options.selectorConfig,DEFAULT_SELECTOR_CONFIG);var comparators=options.comparators||null;this.adapter=new DirectMarkupAdapter(selectorConfig,comparators);this.adapter.initialize(this.$element);this.layout(options.gridSettings)},destroy:function(){this.$element.off();
this.$element.removeData("cardView");if(this.$element.data("cuigridlayout"))this.$element.data("cuigridlayout").destroy();this.adapter=null;delete this.$element},getModel:function(){return this.adapter.getModel()},setModel:function(model){this.adapter.setModel(model)},isSelected:function(item){return this.adapter.isSelected(item)},getDisplayMode:function(){return this.adapter.getDisplayMode()},isColumnSorted:function(){return this.adapter.isColumnSorted()},setColumnSortable:function(sortable){},isColumnSortable:function(){},
setDisplayMode:function(displayMode){this.adapter.setDisplayMode(displayMode)},isGridSelectionMode:function(){return this.adapter.isGridSelectionMode()},setGridSelectionMode:function(isSelection){this.adapter.setGridSelectionMode(isSelection)},toggleGridSelectionMode:function(){this.setGridSelectionMode(!this.isGridSelectionMode())},getSelectionModeCount:function(){return this.adapter.getSelectionModeCount()},setSelectionModeCount:function(modeCount){this.adapter.setSelectionModeCount(modeCount)},
select:function(item,moreSelectionChanges){item=ensureItem(item);var isSelected=this.adapter.isSelected(item);if(!isSelected){if(this.getSelectionModeCount()===SELECTION_MODE_COUNT_SINGLE&&this.getSelection().length>0)this.clearSelection();this.adapter.setSelected(item,true);this.$element.trigger($.Event("change:selection",{"widget":this,"item":item,"isSelected":true,"moreSelectionChanges":moreSelectionChanges===true}))}},deselect:function(item,moreSelectionChanges){item=ensureItem(item);var isSelected=
this.adapter.isSelected(item);if(isSelected){this.adapter.setSelected(item,false);this.$element.trigger($.Event("change:selection",{"widget":this,"item":item,"isSelected":false,"moreSelectionChanges":moreSelectionChanges}))}},toggleSelection:function(item,moreSelectionChanges){item=ensureItem(item);var beforeEvent=$.Event("beforeselect",{selectionCancelled:false,stopEvent:false,item:item,cancelSelection:function(stopEvent){this.selectionCancelled=true;this.stopEvent=stopEvent===true}});this.$element.trigger(beforeEvent);
if(beforeEvent.selectionCancelled)return beforeEvent.stopEvent;var isSelected=this.isSelected(item);if(!isSelected&&this.getSelectionModeCount()===SELECTION_MODE_COUNT_SINGLE&&this.getSelection().length>0)this.clearSelection();this.adapter.setSelected(item,!isSelected);this.$element.trigger($.Event("change:selection",{"widget":this,"item":item,"isSelected":!isSelected,"moreSelectionChanges":moreSelectionChanges}));return true},getSelection:function(useModel){return this.adapter.getSelection(useModel===
true)},clearSelection:function(){var selection=this.getSelection(true);var itemCnt=selection.length;var finalItem=itemCnt-1;for(var i=0;i<itemCnt;i++)this.deselect(selection[i],i<finalItem)},_headerSel:function(headers,selectFn,lastValidItemFn){var model=this.adapter.getModel();if(headers==null)headers=model.getHeaders();if(!$.isArray(headers))headers=[headers];var headerCnt=headers.length;for(var h=0;h<headerCnt;h++){var header=headers[h];if(header.jquery)header=model.getHeaderForEl(header);var itemsToSelect=
model.getItemsForHeader(header);var itemCnt=itemsToSelect.length;for(var i=0;i<itemCnt;i++)selectFn.call(this,itemsToSelect[i],!lastValidItemFn(i,itemsToSelect))}},selectAll:function(headers){if(this.getSelectionModeCount()!==SELECTION_MODE_COUNT_MULTI)return;var self=this;this._headerSel(headers,this.select,function(i,items){for(++i;i<items.length;i++)if(!self.isSelected(items[i]))return false;return true})},deselectAll:function(headers){var self=this;this._headerSel(headers,this.deselect,function(i,
items){for(++i;i<items.length;i++)if(self.isSelected(items[i]))return false;return true})},getHeaderSelectionState:function(){var model=this.getModel();var curHeader=null;var state={"selected":[],"hasUnselected":false,"headers":[]};var headerCnt=model.getHeaderCount();var itemCnt=model.getItemCount();for(var i=0;i<itemCnt;i++){var item=model.getItemAt(i);for(var h=0;h<headerCnt;h++){var header=model.getHeaderAt(h);if(header.getItemRef()===item){curHeader={"header":header,"selected":[],"hasUnselected":false};
state.headers.push(curHeader);break}}if(this.isSelected(item))if(curHeader!==null)curHeader.selected.push(item);else state.selected.push(item);else if(curHeader!==null)curHeader.hasUnselected=true;else state.hasUnselected=true}return state},layout:function(settings){if(this.getDisplayMode()!==DISPLAY_GRID)return;if(this.$element.data("cuigridlayout"))this.$element.cuigridlayout("destroy");this.$element.cuigridlayout(settings)},relayout:function(){if(this.getDisplayMode()!==DISPLAY_GRID)return;this.$element.cuigridlayout("layout")},
_restore:function(restoreHeaders){this.adapter._restore(restoreHeaders)},append:function($items){this.adapter.getModel().insertItemAt($items,null,false)},prepend:function($items){this.adapter.getModel().insertItemAt($items,0,false)},removeAllItems:function(){this.adapter.removeAllItems();if(this.getDisplayMode()===DISPLAY_GRID)this.relayout();this.$element.trigger($.Event("change:removeAll",{widget:this}))}});CUI.CardView.DefaultComparator=new Class({construct:function(selector,attribute,type,ignoreCase){this.selector=
selector;this.attribute=attribute;this.ignoreCase=ignoreCase;this.isNumeric=type=="numeric";this.reverseMultiplier=1},setReverse:function(isReverse){this.reverseMultiplier=isReverse?-1:1},compare:function(item1,item2){var $item1=item1.getItemEl();var $item2=item2.getItemEl();var $e1=this.selector?$item1.find(this.selector):$item1;var $e2=this.selector?$item2.find(this.selector):$item2;var t1="";var t2="";if(!this.attribute){t1=this.ignoreCase?$e1.text().toLowerCase():$e1.text();t2=this.ignoreCase?
$e2.text().toLowerCase():$e2.text()}else if(this.attribute.substr(0,5)=="data-"){t1=$e1.data(this.attribute.substr(5));t2=$e2.data(this.attribute.substr(5))}else{t1=$e1.attr(this.attribute);t2=$e2.attr(this.attribute)}if(this.isNumeric){t1=t1*1;t2=t2*1;if(isNaN(t1))t1=0;if(isNaN(t2))t2=0}if(t1>t2)return 1*this.reverseMultiplier;if(t1<t2)return-1*this.reverseMultiplier;return 0},getCompareFn:function(){return this.compare.bind(this)}});CUI.CardView.DISPLAY_GRID=DISPLAY_GRID;CUI.CardView.DISPLAY_LIST=
DISPLAY_LIST;CUI.CardView.SELECTION_MODE_COUNT_SINGLE="single";CUI.CardView.SELECTION_MODE_COUNT_MULTI="multiple";CUI.CardView.get=function($el){var cardView=Utils.getWidget($el);if(!cardView)cardView=Utils.getWidget($el.cardView());return cardView};CUI.Widget.registry.register("cardview",CUI.CardView);if(CUI.options.dataAPI)$(function(){var cardViews=$("body").find('[data-toggle\x3d"cardview"]');for(var gl=0;gl<cardViews.length;gl++){var $cardView=$(cardViews[gl]);if(!$cardView.data("cardview"))CUI.CardView.init($cardView)}})})(window.jQuery);
(function($,CUI){if(document.documentElement.classList.contains("skipCoral2Validation")||document.head.querySelector(".skipCoral2Validation"))return;var DEBOUNCE_TIMEOUT=500;var debounce=function(func,wait,immediate){var timeout;return function(){var context=this;var args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args)}};$.message.register({selector:"*",
message:function(el,key,params){if(key==="validation.required")return Granite.I18n.get("Please fill out this field.")}});function handleValidation(el){el.checkValidity();el.updateErrorUI()}$(document).on("cui-contentloaded",function(e){$(":submittable",e.target).on("invalid",function(e){if(e.isJqueryValidator)return;e.preventDefault();handleValidation($(this))})});var SIMPLE_ERROR_KEY="coral-validations.internal.simple.error";var showErrorTooltip=function(el,message){var error=el.data(SIMPLE_ERROR_KEY);
if(error){var tooltip=error.data("tooltip");tooltip.set("content",message);if(!error.parent().length){el.after(error);tooltip.show()}return}error=$(document.createElement("span"));el.data(SIMPLE_ERROR_KEY,error);el.after(error);var tooltip=new CUI.Tooltip({element:error,target:el,content:message,type:"error",arrow:"bottom"})};var hideErrorTooltip=function(el){var error=el.data(SIMPLE_ERROR_KEY);if(!error)return;var tooltip=error.data("tooltip");tooltip.hide();error.detach()};$.validator.register({selector:"*",
show:function(el,message){el.attr("aria-invalid","true").addClass("is-invalid");showErrorTooltip(el,message)},clear:function(el){el.removeAttr("aria-invalid").removeClass("is-invalid");hideErrorTooltip(el)}});var compositeFieldSelector=[".coral-InputGroup-input",".coral-DecoratedTextfield-input",".js-coral-Autocomplete-textfield",".js-coral-pathbrowser-input",".coral-Checkbox-input",".coral-Switch-input",".coral-Select-select",".coral-FileUpload-input"].join(", ");var compositeFieldRootMap=[[".js-coral-Autocomplete-textfield",
".coral-Autocomplete"],[".js-coral-pathbrowser-input",".coral-PathBrowser"],[".coral-InputGroup-input",".coral-InputGroup"],[".coral-DecoratedTextfield-input",".coral-DecoratedTextfield"],[".coral-Checkbox-input",".coral-Checkbox"],[".coral-Switch-input",".coral-Switch"],[".coral-Select-select",".coral-Select"],[".coral-FileUpload-input",".coral-FileUpload"]];var getCompositeRoot=function(el){var mapper;compositeFieldRootMap.some(function(v){if(el.is(v[0])){mapper=v;return true}return false});if(mapper)return el.closest(mapper[1])};
$.validator.register({selector:compositeFieldSelector,show:function(el,message){el.attr("aria-invalid","true").addClass("is-invalid");showErrorTooltip(getCompositeRoot(el),message)},clear:function(el){el.removeAttr("aria-invalid").removeClass("is-invalid");hideErrorTooltip(getCompositeRoot(el))}});var fieldErrorEl=$(document.createElement("span")).addClass("coral-Form-fielderror coral-Icon coral-Icon--alert coral-Icon--sizeS").attr({"data-init":"quicktip","data-quicktip-type":"error"});var FIELD_ERROR_KEY=
"coral-validations.internal.field.error";var formFieldSelector=[".coral-Form-fieldwrapper .coral-Form-field",".coral-Form-fieldwrapper .coral-Form-field.coral-InputGroup .coral-InputGroup-input",".coral-Form-fieldwrapper .coral-Form-field.coral-DecoratedTextfield .coral-DecoratedTextfield-input",".coral-Form-fieldwrapper .coral-Form-field.coral-Autocomplete .js-coral-Autocomplete-textfield",".coral-Form-fieldwrapper .coral-Form-field.coral-PathBrowser .js-coral-pathbrowser-input",".coral-Form-fieldwrapper .coral-Form-field.coral-Checkbox .coral-Checkbox-input",
".coral-Form-fieldwrapper .coral-Form-field.coral-Switch .coral-Switch-input",".coral-Form-fieldwrapper .coral-Form-field.coral-Select .coral-Select-select",".coral-Form-fieldwrapper .coral-Form-field.coral-FileUpload .coral-FileUpload-input"].join(", ");$.validator.register({selector:formFieldSelector,show:function(el,message){el.attr("aria-invalid","true").addClass("is-invalid");var field=el.closest(".coral-Form-field");var info=field.nextAll(".coral-Form-fieldinfo");info.addClass("u-coral-screenReaderOnly");
var error=el.data(FIELD_ERROR_KEY);if(error){error.data("quicktipContent",message);if(!error.parent().length)field.after(error);return}var arrow=info.data("quicktipArrow");if(!arrow){var wrapper=field.closest(".coral-Form-fieldwrapper");if(wrapper.hasClass("coral-Form-fieldwrapper--singleline"))arrow="left";else arrow=wrapper.closest("form").hasClass("coral-Form--vertical")?"right":"top"}error=fieldErrorEl.clone().attr("data-quicktip-arrow",arrow).attr("data-quicktip-content",message).insertAfter(field);
el.data(FIELD_ERROR_KEY,error)},clear:function(el){el.removeAttr("aria-invalid").removeClass("is-invalid");var field=el.closest(".coral-Form-field");var error=el.data(FIELD_ERROR_KEY);if(error){var tooltip=error.next(".coral-Tooltip").data("tooltip");if(tooltip)tooltip.hide();error.detach()}field.nextAll(".coral-Form-fieldinfo").removeClass("u-coral-screenReaderOnly")}});$.validator.register({selector:"input, textarea, select",validate:function(el){var isRequired=el.prop("required")===true||el.prop("required")===
undefined&&el.attr("required")!==undefined||el.attr("aria-required")==="true";if(!isRequired)return;var valid=false;if(el.is("[type\x3dcheckbox], [type\x3dradio]"))valid=el.prop("checked");else valid=el.val().length>0;if(!valid)return el.message("validation.required")}});var validateHandler=function(e){handleValidation($(this))};$(document).on("change","input, textarea, select",validateHandler);$(document).on("input","input, textarea",debounce(validateHandler,500));$.validator.register({selector:"[role\x3dlistbox]",
validate:function(el){if(el.attr("aria-required")!=="true")return;var selected=false;el.find("[role\x3doption]").each(function(){if($(this).attr("aria-selected")==="true"){selected=true;return false}});if(!selected)return el.message("validation.required")}});$.validator.register({selector:".coral-Select-select",show:function(el,message){el.prev(".coral-Select-button").addClass("is-invalid");return $.validator.CONTINUE},clear:function(el,result){el.prev(".coral-Select-button").removeClass("is-invalid");
return $.validator.CONTINUE}});$(document).on("selected",".coral-Select",function(e){handleValidation($(this).find(".coral-Select-select"))});var original=CUI.Multifield.prototype._addListeners;CUI.Multifield.prototype._addListeners=function(){original.apply(this,arguments);this.$element.on("click",".js-coral-Multifield-remove",function(e){handleValidation($(e.delegateTarget))});this.$element.on("click",".js-coral-Multifield-add",function(e){var el=$(e.delegateTarget);el.find(".js-coral-Multifield-input").attr({role:"option",
"aria-selected":"true"});handleValidation(el)})};$.validator.register({selector:".js-coral-NumberInput-input",show:function(el,message){el.closest(".coral-NumberInput").data("numberInput").set("hasError",true);return $.validator.CONTINUE},clear:function(el,result){el.closest(".coral-NumberInput").data("numberInput").set("hasError",false);return $.validator.CONTINUE}});$.validator.register({selector:".js-coral-DatePicker-input",show:function(el,message){el.closest(".coral-DatePicker").data("datepicker").set("hasError",
true);return $.validator.CONTINUE},clear:function(el,result){el.closest(".coral-DatePicker").data("datepicker").set("hasError",false);return $.validator.CONTINUE}});$(document).on("change",".coral-Selector-input",function(e){var el=$(this);var selector=el.closest(".coral-Selector");if(el.is("[type\x3dradio]"))selector.find(".coral-Selector-input").attr("aria-selected","false");el.attr("aria-selected",""+this.checked);handleValidation(selector)});$(document).on("change",".coral-RadioGroup",function(e){var group=
$(this);var input=$(e.target);if(input.is("[type\x3dradio]"))group.find("input[type\x3dradio]").attr("aria-selected","false");input.attr("aria-selected",""+input.prop("checked"));handleValidation(group)});$(document).on("cui-contentloaded",function(e){$(".coral-RadioGroup input[type\x3dradio]",e.target).each(function(){$(this).attr("aria-selected",""+this.checked)})});$.validator.register({selector:".coral-FileUpload-input",validate:function(el){if(el.attr("aria-required")!=="true")return;var upload=
el.closest(".coral-FileUpload").data("fileUpload");if(upload.uploadQueue.length===0)return el.message("validation.required")}});$(document).on("queuechanged",".coral-FileUpload",function(e){handleValidation($(this))});$.validator.register({selector:".coral-ColorPicker",validate:function(el){if(el.attr("aria-required")!=="true")return;if(!el.children("input[type\x3dhidden]").val())return el.message("validation.required")}});var originalConstruct=CUI.Colorpicker.prototype.construct;CUI.Colorpicker.prototype.construct=
function(){originalConstruct.apply(this,arguments);this.$element.attr("role","listbox");$(document.createElement("meta")).attr({role:"option","aria-selected":"true"}).appendTo(this.$element)};var originalSetColor=CUI.Colorpicker.prototype._setColor;CUI.Colorpicker.prototype._setColor=function(){originalSetColor.apply(this,arguments);handleValidation(this.$element)};$.validator.register({selector:".coral-Autocomplete",validate:function(el){if(el.attr("aria-required")!=="true")return;var autocomplete=
el.data("autocomplete");if(autocomplete.getValue().length===0)return el.message("validation.required")},show:function(el,message){el.find(".js-coral-Autocomplete-textfield").first().addClass("is-invalid");return $.validator.CONTINUE},clear:function(el,result){el.find(".js-coral-Autocomplete-textfield").first().removeClass("is-invalid");return $.validator.CONTINUE}});$(document).on("change:value",".coral-Autocomplete",function(e){var el=$(this);if(!el.data("autocomplete").options.multiple){var textfield=
el.find(".js-coral-Autocomplete-textfield");handleValidation(textfield)}handleValidation(el)});var acValidateHandler=function(e){var el=$(this);var ac=el.closest(".coral-Autocomplete");if(ac.data("autocomplete").options.multiple)return;handleValidation(ac)};$(document).on("change",".js-coral-Autocomplete-textfield",acValidateHandler);$(document).on("input",".js-coral-Autocomplete-textfield",debounce(acValidateHandler,DEBOUNCE_TIMEOUT));function getRelatedTabAndPane(el){var panel=el.closest(".coral-TabPanel-pane");
var panelIndex=panel.index();var tabPanel=panel.closest(".coral-TabPanel");var tab=tabPanel.find("\x3e .coral-TabPanel-navigation \x3e .coral-TabPanel-tab").eq(panelIndex);return{tab:tab,pane:panel}}function pushInvalid(container,invalid){var key="coral-TabPanel.internal.invalids";var invalids=container.data(key);if(invalids===undefined){invalids=[];container.data(key,invalids)}if(invalids.indexOf(invalid)<0)invalids.push(invalid)}$(document).on("invalid",".coral-TabPanel",function(e){var result=
getRelatedTabAndPane($(e.target));result.tab.addClass("is-invalid");pushInvalid(result.pane,e.target)});$(document).on("valid",".coral-TabPanel",function(e){var result=getRelatedTabAndPane($(e.target));var currentTab=result.tab;var currentPanel=result.pane;var enable=function(){if($.validator.isValid(currentPanel,true))currentTab.removeClass("is-invalid")};var invalids=currentPanel.data("coral-TabPanel.internal.invalids");if(!invalids){enable();return}var i=invalids.indexOf(e.target);if(i>=0)invalids.splice(i,
1);if(invalids.length===0){enable();return}var invalid=false;var j=invalids.length;while(j--){if(currentPanel.has(invalids[j]).length){invalid=true;break}invalids.splice(j,1)}if(!invalid)enable()})})(jQuery,CUI);
(function($){CUI.FileChunkedUpload=new Class({toString:"FileChunkedUpload",extend:CUI.FileUpload,defaults:$.extend(CUI.FileUpload.prototype.defaults,{"chunkSize":null,"chunkUploadMinFileSize":null,"chunkUploadSupported":false}),_readDataFromMarkup:function(){var self=this;if(this.inputElement.data("chunkUploadSupported"))this.options.chunkUploadSupported=this.inputElement.data("chunkUploadSupported")===true;if(this.inputElement.data("chunkSize"))this.options.chunkSize=this.inputElement.data("chunkSize");
if(this.inputElement.data("chunkUploadMinFileSize"))this.options.chunkUploadMinFileSize=this.inputElement.data("chunkUploadMinFileSize");this.inherited(arguments)},startChunkedUpload:function(item){this.resumeChunkedUpload(item,0)},resumeChunkedUpload:function(item,offset){var self=this;if(this.canChunkedUpload(item)===false)throw"cannot start chunk upload on ["+item.file.name+"]";item.xhr=new XMLHttpRequest;var upload=item.xhr.upload;var file=item.file;var fileName=item.fileName;var f=new FormData;
if(self.options.fileNameParameter){var sliceMethod=this._getFileSliceMethod(file);var chunk=file[sliceMethod](offset,offset+this.options.chunkSize);f.append(self.inputElement.attr("name"),chunk);f.append(self.options.fileNameParameter||"fileName",fileName);f.append(self.inputElement.attr("name")+"@Offset",offset);f.append(self.inputElement.attr("name")+"@Length",file.size);if(item["parameters"]!==null&&item["parameters"]!==undefined)item.parameters.forEach(function(additionalParam){f.append(additionalParam.name,
additionalParam.value)});item.xhr.addEventListener("load",function(e){self._onChunkUploadLoad(e,item,offset,chunk)},false);upload.addEventListener("progress",function(e){self._onChunkUploadProgress(e,item,offset,chunk)},false);item.xhr.addEventListener("loadstart",function(e){self._onChunkUploadStart(e,item,offset,chunk)},false);item.xhr.addEventListener("error",function(e){self._onChunkUploadError(e,item,offset,chunk)},false);item.xhr.addEventListener("timeout",function(e){self._onChunkUploadError(e,
item,offset,chunk)},false);item.xhr.addEventListener("abort",function(e){self._onChunkUploadCanceled(e,item,offset,chunk)},false);f.append("_charset_","utf-8");item.xhr.open("POST",self.options.uploadUrl+"?:ck\x3d"+(new Date).getTime(),true);item.xhr.send(f)}},queryChunkedUpload:function(url,item){var self=this;var xhr=new XMLHttpRequest;xhr.addEventListener("load",function(e){self._onQueryChunkUploadLoad(e,item)},false);xhr.addEventListener("error",function(e){self._onQueryChunkUploadError(e,item)},
false);xhr.addEventListener("timeout",function(e){self._onQueryChunkUploadError(e,item)},false);xhr.addEventListener("abort",function(e){self._onQueryChunkUploadError(e,item)},false);xhr.open("GET",url+"?:ck\x3d"+(new Date).getTime()+"\x26_charset_\x3dutf-8",true);xhr.send()},deleteChunkedUpload:function(url,item){var self=this;var xhr=new XMLHttpRequest;var f=new FormData;f.append(":operation","delete");f.append(":applyToChunks","true");f.append("_charset_","utf-8");xhr.addEventListener("load",function(e){self._onDeleteChunkUploadLoad(e,
item)},false);xhr.addEventListener("error",function(e){self._onDeleteChunkUploadError(e,item)},false);xhr.addEventListener("timeout",function(e){self._onDeleteChunkUploadError(e,item)},false);xhr.addEventListener("abort",function(e){self._onDeleteChunkUploadError(e,item)},false);xhr.open("POST",url+"?:ck\x3d"+(new Date).getTime(),true);xhr.send(f)},canChunkedUpload:function(item){if(this.options.useHTML5===true&&this.options.chunkUploadSupported===true&&item.file.size>this.options.chunkUploadMinFileSize&&
window.FormData){try{this._getFileSliceMethod(item.file)}catch(err){return false}return true}return false},cancelChunkedUpload:function(item){item.xhr.abort()},_onChunkUploadStart:function(e,item,offset,chunk){if(offset===0)this._onUploadStart(e,item);this.$element.trigger({type:"filechunkeduploadstart",item:item,offset:offset,chunk:chunk,originalEvent:e,fileUpload:this})},_onChunkUploadLoad:function(e,item,offset,chunk){var request=e.target;if(request.readyState===4)this._internalOnChunkUploadLoad(e,
item,offset,chunk,request.status,request.responseText)},_onChunkUploadProgress:function(e,item,offset,chunk){this.$element.trigger({type:"filechunkeduploadprogress",item:item,offset:offset,chunk:chunk,originalEvent:e,fileUpload:this})},_onChunkUploadError:function(e,item,offset,chunk){this.$element.trigger({type:"filechunkeduploaderror",offset:offset,chunk:chunk,item:item,originalEvent:e,fileUpload:this})},_onChunkUploadCanceled:function(e,item,offset,chunk){this.$element.trigger({type:"filechunkeduploadcanceled",
offset:offset,chunk:chunk,item:item,originalEvent:e,fileUpload:this})},_onQueryChunkUploadLoad:function(e,item){var request=e.target;if(request.readyState===4)if(CUI.util.HTTP.isOkStatus(request.status))this.$element.trigger({type:"filechunkeduploadquerysuccess",item:item,originalEvent:e,fileUpload:this});else this._onQueryChunkUploadError(e,item)},_onQueryChunkUploadError:function(e,item){var request=e.target;this.$element.trigger({type:"filechunkeduploadqueryerror",item:item,originalEvent:e,message:request.responseText,
fileUpload:this})},_onDeleteChunkUploadLoad:function(e,item){var request=e.target;if(request.readyState===4)if(CUI.util.HTTP.isOkStatus(request.status))this.$element.trigger({type:"filechunkeduploaddeletesuccess",item:item,originalEvent:e,fileUpload:this});else this._onDeleteChunkUploadError(e,item)},_onDeleteChunkUploadError:function(e,item){var request=e.target;this.$element.trigger({type:"filechunkeduploaddeleteerror",item:item,originalEvent:e,message:request.responseText,fileUpload:this})},_internalOnChunkUploadLoad:function(e,
item,offset,chunk,requestStatus,responseText){if(CUI.util.HTTP.isOkStatus(requestStatus)){this.$element.trigger({type:"filechunkeduploadsuccess",offset:offset,chunk:chunk,item:item,originalEvent:e,fileUpload:this});if(offset+chunk.size===item.file.size){this.$element.trigger({type:"fileuploadsuccess",item:item,originalEvent:e,fileUpload:this});if(this.fileNameElement)this.fileNameElement.remove();this.uploadQueue.splice(this._getQueueIndex(item.fileName),1);this.$element.trigger({type:"queuechanged",
item:item,operation:"REMOVE",queueLength:this.uploadQueue.length,fileUpload:this})}else this.resumeChunkedUpload(item,offset+chunk.size)}else this.$element.trigger({type:"filechunkeduploaderror",offset:offset,chunk:chunk,item:item,originalEvent:e,message:responseText,fileUpload:this})},_getFileSliceMethod:function(file){if("mozSlice"in file)return"mozSlice";else if("webkitSlice"in file)return"webkitSlice";else if("slice"in file)return"slice";else throw new Error("'Slicing file' operation not supported");
}});CUI.Widget.registry.register("filechunkedupload",CUI.FileChunkedUpload);if(CUI.options.dataAPI)$(document).on("cui-contentloaded.data-api",function(e){CUI.FileChunkedUpload.init($("[data-init~\x3d'filechunkedupload']",e.target))})})(window.jQuery);